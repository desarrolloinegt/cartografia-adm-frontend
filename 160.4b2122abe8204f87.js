(self.webpackChunkcartografia_app=self.webpackChunkcartografia_app||[]).push([[160],{4160:(dt,st,u)=>{"use strict";u.r(st),u.d(st,{DialogBitacoraComponent:()=>Y,DialogSupervisorAssignUserComponent:()=>O,FieldTeamDialogComponent:()=>R,FieldTeamPageComponent:()=>B,HomeProjectPageComponent:()=>Q,NewFieldTeamPageComponent:()=>W,ProjecHometModule:()=>G,ProjectRoutingModule:()=>M,SupervisorComponent:()=>H});var v=u(7274),h=u(8739),g=u(6308),c=u(671),t=u(4650),q=u(8443);class C{constructor(o){this.apiService=o}getFieldTeam(o){return this.apiService.store("equipos",o)}createFieldTeam(o){return this.apiService.store("equipo",o)}editFieldTeam(o){return this.apiService.patch("equipo/edit",o)}desactiveFielTeam(o){return this.apiService.desactive("vehiculo",o)}getUsersTeam(o){return this.apiService.store("miembrosEquipo",o)}getVehicles(){return this.apiService.getAll("vehiculos")}addTeam(o){return this.apiService.store("addEquipo",o)}addVehicule(o){return this.apiService.patch("addVehiculo",o)}modifyVehicle(o){return this.apiService.patch("equipoVehicle/edit",o)}}C.\u0275fac=function(o){return new(o||C)(t.LFG(q.s))},C.\u0275prov=t.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"});var _=u(4006),p=u(9549),m=u(4144),d=u(7392);function A(i,o){1&i&&(t.TgZ(0,"th",22),t._uU(1,"Codigo de usuario"),t.qZA())}function f(i,o){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.codigo_usuario," ")}}function w(i,o){1&i&&(t.TgZ(0,"th",22),t._uU(1,"Nombres"),t.qZA())}function _t(i,o){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.nombres," ")}}function lt(i,o){1&i&&(t.TgZ(0,"th",22),t._uU(1,"Apellidos"),t.qZA())}function z(i,o){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.apellidos," ")}}function mt(i,o){1&i&&t._UZ(0,"th",22)}function $(i,o){1&i&&t._UZ(0,"td",23)}function k(i,o){1&i&&t._UZ(0,"tr",24)}function wt(i,o){1&i&&t._UZ(0,"tr",25)}function Ut(i,o){if(1&i&&(t.TgZ(0,"tr",26)(1,"td",27),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(13);t.xp6(2),t.hij(' No hay resultados de "',e.value,'" ')}}const At=function(){return[5,10,25,100]};class R{constructor(o,e,r,n){this.fieldTeamService=o,this.dialogRef=e,this.data=r,this.formBuilder=n,this.displayedColumns=["codigo_usuario","nombres","apellidos","options"],this.dataSource=new c.by,this.chargetUsers()}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}ngOnInit(){}chargetUsers(){this.fieldTeamService.getUsersTeam({proyecto_id:this.data.proyecto_id,supervisor:this.data.supervisor}).subscribe(o=>{this.dataSource=new c.by(o),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}}R.\u0275fac=function(o){return new(o||R)(t.Y36(C),t.Y36(v.so),t.Y36(v.WI),t.Y36(_.qu))},R.\u0275cmp=t.Xpm({type:R,selectors:[["app-field-team-dialog"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:35,vars:9,consts:[[1,"title"],["mat-dialog-title",""],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevatioin-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","codigo_usuario"],["mat-header-cell","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","nombres"],["matColumnDef","apellidos"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell","",1,"cell-pointer"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2,"Miembros"),t.qZA(),t._UZ(3,"br")(4,"br"),t.qZA(),t.TgZ(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t._uU(11,"Buscar"),t.qZA(),t.TgZ(12,"input",7,8),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(14,"mat-icon",9),t._uU(15,"search"),t.qZA()()()(),t.TgZ(16,"div",10)(17,"table",11),t.ynx(18,12),t.YNc(19,A,2,0,"th",13),t.YNc(20,f,2,1,"td",14),t.BQk(),t.ynx(21,15),t.YNc(22,w,2,0,"th",13),t.YNc(23,_t,2,1,"td",14),t.BQk(),t.ynx(24,16),t.YNc(25,lt,2,0,"th",13),t.YNc(26,z,2,1,"td",14),t.BQk(),t.ynx(27,17),t.YNc(28,mt,1,0,"th",13),t.YNc(29,$,1,0,"td",14),t.BQk(),t.YNc(30,k,1,0,"tr",18),t.YNc(31,wt,1,0,"tr",19),t.YNc(32,Ut,3,1,"tr",20),t.qZA(),t._UZ(33,"br")(34,"mat-paginator",21),t.qZA()()()),2&o&&(t.xp6(9),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",e.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(8,At)))},dependencies:[p.KE,p.hX,p.R9,m.Nt,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,g.YE],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}"]});var T=u(5861),Pt=u(5226),l=u.n(Pt),P=u(574),L=u(9155),S=u(7570),St=u(4327);class j{constructor(){}exportAsExcelFile(o,e){const n={Sheets:{data:P.P6.json_to_sheet(o)},SheetNames:["data"]},a=P.cW(n,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(a,e)}saveAsExcelFile(o,e){const r=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});St.saveAs(r,e+"_export_"+(new Date).getTime()+".xlsx")}}j.\u0275fac=function(o){return new(o||j)},j.\u0275prov=t.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"});var Z=u(6895),x=u(4859),pt=u(4385),gt=u(3238),D=u(266),U=u(4954);function Nt(i,o){if(1&i&&(t.TgZ(0,"mat-option",32),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e.id+","+e.nombre),t.xp6(1),t.Oqu(e.nombre)}}function jt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),a=t.MAs(13);return t.KtG(n.getUsers(a.value))}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_downward"),t.qZA(),t._uU(3," Descargar Plantilla "),t.qZA()}if(2&i){t.oxw();const e=t.MAs(13);t.Q6J("disabled",!e.value)}}function kt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo "),t.qZA()}}function Ft(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addTeam())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Crear Equipo de Campo "),t.qZA()}}function Yt(i,o){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Supervisor"),t.qZA())}function Et(i,o){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.lnq("",e.codigo_usuario," ",e.nombres," ",e.apellidos,"")}}function Ot(i,o){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Vehiculo"),t.qZA())}function Mt(i,o){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.AsE("",e.modelo," ",e.placa,"")}}function Rt(i,o){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Descripcion"),t.qZA())}function Bt(i,o){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.descripcion)}}function Qt(i,o){1&i&&t._UZ(0,"th",37)}function Jt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",41),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.editTeam(n.id,n.descripcion))}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function Ht(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.seeTeam(n.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"people_outline"),t.qZA()()}}function It(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.modifyVehicle(n.id,n.placa))}),t.TgZ(1,"mat-icon"),t._uU(2,"cached"),t.qZA()()}}function Gt(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,It,3,0,"button",43),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.placa)}}function zt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.addVehicle(n.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"directions_car"),t.qZA()()}}function $t(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,zt,3,0,"button",45),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.placa)}}const Lt=function(){return["editar-equipo-campo"]},Wt=function(){return["ver-usuarios-equipo-campo"]},ht=function(){return["agregar-vehiculo-equipo-campo"]};function Kt(i,o){1&i&&(t.TgZ(0,"td",36),t.YNc(1,Jt,3,0,"button",38),t.YNc(2,Ht,3,0,"button",39),t.YNc(3,Gt,2,1,"div",40),t.YNc(4,$t,2,1,"div",40),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(4,Lt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(5,Wt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(6,ht)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(7,ht)))}function Vt(i,o){1&i&&t._UZ(0,"tr",47)}function Xt(i,o){1&i&&t._UZ(0,"tr",48)}function te(i,o){if(1&i&&(t.TgZ(0,"tr",49)(1,"td",50),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(37);t.xp6(2),t.hij(' No hay resultados de "',e.value,'" ')}}const ee=function(){return["descargar-plantilla"]},bt=function(){return["crear-equipo-campo"]},oe=function(){return[5,10,25,100]};class B{constructor(o,e,r,n,a,s){this.formBuilder=o,this.dialogService=e,this.fieldService=r,this.rolService=n,this.projectHomeService=a,this.excelService=s,this.data=[[1,2],[3,4]],this.displayedColumns=["supervisor","vehiculo","descripcion","options"],this.roles=[],this.idProject=0,this.fieldTeamData={id:0,equipo:"",supervisor:"",vehiculo:"",placa:"",modelo:""},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:y=>{y.addEventListener("mouseenter",l().stopTimer),y.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new c.by,this.buildForm()}ngOnInit(){let o=localStorage.getItem("id");Number(o)&&this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.idProject=e,this.getGroupsMinor()}),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.idProject=e}),this.cargarEquipo()}buildForm(){this.formFieldTeams=this.formBuilder.group({file:[""]})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var o=this;return(0,T.Z)(function*(){o.rolService.getGroupsMinor({proyecto_id:o.idProject}).subscribe(e=>{o.roles=e})})()}addTeam(){var o=this;return(0,T.Z)(function*(){const{value:e}=yield l().fire({title:"A\xf1adir equipo",html:'<span>Ingrese el codigo de usuario</span><input type="text" style="width:80%;"  placeholder="1234" id="user" class="swal2-input"><br><span>Ingrese la placa del vehiculo (opcional)</span><input id="placa" style="width:80%;" value="" placeholder="M123ABC" class="swal2-input">',showCancelButton:!0,cancelButtonText:"Cancelar",preConfirm:()=>[document.getElementById("user"),document.getElementById("placa")]});if(e){let r=e[0].value;r&&o.fieldService.addTeam({codigo_usuario:r,placa:e[1].value,proyecto_id:o.idProject}).subscribe(s=>{s.status&&(o.Toast.fire({icon:"success",title:s.message}),o.cargarEquipo())})}})()}cargarEquipo(){let o=localStorage.getItem("project");this.fieldService.getFieldTeam({proyecto:o}).subscribe(e=>{this.dataSource=new c.by(e),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}seeTeam(o){this.dialogService.open(R,{height:"40rem",width:"50rem",data:{proyecto_id:this.idProject,supervisor:Number(o)}})}seeExample(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploEquipo.PNG",imageWidth:415,imageHeight:260,imageAlt:"Ejemplo del archivo de carga"})}addFile(){var o=this;return(0,T.Z)(function*(){const{value:e}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(e){const r=new FileReader;r.onload=n=>{const s=P.ij(n.target.result,{type:"binary"});o.data=P.P6.sheet_to_json(s.Sheets[s.SheetNames[0]],{header:1}),o.generateJson()},r.readAsBinaryString(e)}})()}generateJson(){var o=this;return(0,T.Z)(function*(){let e=[],r=[];o.data.forEach(n=>{n[2]&&e.push({placa:n[0],descripcion:n[1],codigo_supervisor:n[2],proyecto_id:o.idProject})}),e.shift(),e=e.filter(Boolean);for(let n=0;n<e.length;n++)for(let a=n+1;a<e.length;a++)null!=e[n]&&e[n].codigo_supervisor==e[a].codigo_supervisor&&e[n].placa==e[a].placa&&r.push(e[n].placa,e[n].codigo_supervisor);for(let n=0;n<e.length;n++)for(let a=n+1;a<e.length;a++)null!=e[n].placa&&e[n].placa==e[a].placa&&r.push(e[n].placa);for(let n=0;n<e.length;n++)e[n].placa||(e[n].placa=""),e[n].descripcion||(e[n].descripcion="");r.length>0?o.Toast.fire({icon:"error",title:"Hay filas repetidas: "+r}):o.fieldService.createFieldTeam(e).subscribe(n=>{1==n.status&&(o.Toast.fire({icon:"success",title:n.message}),o.cargarEquipo())})})()}getUsers(o){let e=Number(localStorage.getItem("id")),r=o.split(","),n=[],a=[];this.projectHomeService.getUsersAssigned({rol_id:Number(r[0]),proyecto_id:this.idProject,usuario_id:e}).subscribe(s=>{a=s,a.forEach(y=>{n.push({encargado:"",codigo_usuario:y.codigo_usuario,nombres:y.nombres,apellidos:y.apellidos})}),this.createFile(r[1],n)})}createFile(o,e){let r=[],n=[];this.fieldService.getVehicles().subscribe(a=>{n=a;for(let s=0;s<n.length;s++)r.push({placa:n[s].placa,descripcion:"",codigo_usuario:"",nombres:"",apellidos:""});for(let s=0;s<e.length;s++)r.push({placa:"",codigo_usuario:e[s].codigo_usuario,descripcion:"",nombres:e[s].nombres,apellidos:e[s].apellidos});this.excelService.exportAsExcelFile(r,"Equipo Campo "+o)})}modifyVehicle(o,e){var r=this;return(0,T.Z)(function*(){const{value:n}=yield l().fire({title:"Sustituir vehiculo",input:"text",inputPlaceholder:"M987ABC",confirmButtonText:"Reemplazar vehiculo",showCancelButton:!0,inputLabel:"Ingrese la placa del nuevo vehiculo"});if(n){let a={proyecto_id:r.idProject,usuario_id:Number(o),placa_nueva:n,placa_anterior:e};r.fieldService.modifyVehicle(a).subscribe(s=>{1==s.status&&(r.Toast.fire({icon:"success",title:s.message}),r.cargarEquipo())})}})()}addVehicle(o){var e=this;return(0,T.Z)(function*(){const{value:r}=yield l().fire({title:"Asignar vehiculo",input:"text",inputPlaceholder:"M987ABC",confirmButtonText:"Asignar vehiculo",showCancelButton:!0,inputLabel:"Ingrese la placa del  vehiculo"});if(r){let n={proyecto_id:e.idProject,usuario_id:Number(o),placa:r};e.fieldService.addVehicule(n).subscribe(a=>{1==a.status&&(e.Toast.fire({icon:"success",title:a.message}),e.cargarEquipo())})}})()}editTeam(o,e){var r=this;return(0,T.Z)(function*(){e||(e="");const{value:n}=yield l().fire({title:"Editar equipo",input:"text",inputValue:e,inputPlaceholder:"Equipo encargado de Zona 1",confirmButtonText:"Modificar descripcion",showCancelButton:!0,cancelButtonText:"Cancelar",inputLabel:"Ingrese la descripcion del equipo"});let a={proyecto_id:r.idProject,usuario_id:Number(o),descripcion:n};n&&r.fieldService.editFieldTeam(a).subscribe(s=>{1==s.status&&(r.Toast.fire({icon:"success",title:s.message}),r.cargarEquipo())})})()}}function ie(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Equipo de Campo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function re(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Supervisor de Equipo de Campo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function ne(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Nombre del vehiculo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function ae(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Placa del vehiculo es "),t.TgZ(2,"strong"),t._uU(3,"requerida"),t.qZA()())}function ce(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Placa debe tener la siguiente secuencia: "),t.TgZ(2,"strong"),t._uU(3,"A123ABC"),t.qZA()())}function se(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Modelo del vehiculo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function le(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createFieldTeam())}),t._uU(1," Guardar Vehiculo "),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("disabled",!e.fieldTeamForm.valid)}}function me(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.cancelAdd())}),t._uU(1," Cancelar "),t.qZA()}}B.\u0275fac=function(o){return new(o||B)(t.Y36(_.qu),t.Y36(v.uw),t.Y36(C),t.Y36(L.RolService),t.Y36(S.l),t.Y36(j))},B.\u0275cmp=t.Xpm({type:B,selectors:[["app-field-team-page"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:59,vars:18,consts:[[1,"mat_tab"],[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","accent",3,"disabled","click",4,"ngxPermissionsOnly"],[1,"container_options"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent","style","margin-right: 8px",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","supervisor"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","vehiculo"],["matColumnDef","descripcion"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Editar descripcion","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver miebros de equipo","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],[4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Editar descripcion","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Ver miebros de equipo","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Cambiar Vehiculo","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Cambiar Vehiculo","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Asignar Vehiculo","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Asignar Vehiculo","color","primary",1,"iconbutton",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0),t._UZ(1,"br"),t.TgZ(2,"div",1)(3,"h1"),t._uU(4,"Equipos de Campo"),t.qZA()(),t._UZ(5,"br")(6,"br"),t.TgZ(7,"div",2)(8,"div",3)(9,"mat-form-field",4)(10,"mat-label"),t._uU(11,"Seleccione un Rol"),t.qZA(),t.TgZ(12,"mat-select",null,5),t.YNc(14,Nt,2,2,"mat-option",6),t.qZA()(),t.TgZ(15,"div"),t.YNc(16,jt,4,1,"button",7),t.qZA()(),t.TgZ(17,"div",8)(18,"div"),t.YNc(19,kt,4,0,"button",9),t.qZA(),t.TgZ(20,"div"),t.YNc(21,Ft,4,0,"button",10),t.qZA(),t.TgZ(22,"div")(23,"button",11),t.NdJ("click",function(){return e.seeExample()}),t.TgZ(24,"mat-icon"),t._uU(25,"remove_red_eye"),t.qZA(),t._uU(26," Ver ejemplo de archivo de carga "),t.qZA()()()(),t._UZ(27,"br"),t.TgZ(28,"div",12)(29,"div")(30,"div",13),t._UZ(31,"div",14),t.qZA(),t._UZ(32,"br"),t.TgZ(33,"mat-form-field",15)(34,"mat-label"),t._uU(35,"Buscar"),t.qZA(),t.TgZ(36,"input",16,17),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(38,"mat-icon",18),t._uU(39,"search"),t.qZA()(),t.TgZ(40,"div",19)(41,"table",20),t.ynx(42,21),t.YNc(43,Yt,2,0,"th",22),t.YNc(44,Et,2,3,"td",23),t.BQk(),t.ynx(45,24),t.YNc(46,Ot,2,0,"th",22),t.YNc(47,Mt,2,2,"td",23),t.BQk(),t.ynx(48,25),t.YNc(49,Rt,2,0,"th",22),t.YNc(50,Bt,2,1,"td",23),t.BQk(),t.ynx(51,26),t.YNc(52,Qt,1,0,"th",27),t.YNc(53,Kt,5,8,"td",23),t.BQk(),t.YNc(54,Vt,1,0,"tr",28),t.YNc(55,Xt,1,0,"tr",29),t.YNc(56,te,3,1,"tr",30),t.qZA(),t._UZ(57,"br")(58,"mat-paginator",31),t.qZA()()()()),2&o&&(t.xp6(10),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngForOf",e.roles),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(14,ee)),t.xp6(3),t.Q6J("ngxPermissionsOnly",t.DdM(15,bt)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(16,bt)),t.xp6(12),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",e.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(17,oe)))},dependencies:[Z.sg,Z.O5,p.KE,p.hX,p.R9,m.Nt,x.lW,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,pt.gD,gt.ey,D.gM,g.YE,g.nU,U.gE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}"]});const Tt=function(){return["crear-equipo"]};class W{constructor(o,e,r){this.fieldTeamService=o,this.formBuilder=e,this.dialogRef=r,this.buildForm()}buildForm(){this.fieldTeamForm=this.formBuilder.group({equipo:["",_.kI.required],supervisor:["",_.kI.required],vehiculo:["",_.kI.required],placa:["",[_.kI.required,_.kI.pattern(/^[A-Z]{1}([0-9]){3}[A-Z]{3}$/)]],modelo:["",_.kI.required]})}get equipo(){return this.fieldTeamForm.get("equipo")}get supervisor(){return this.fieldTeamForm.get("supervisor")}get vehiculo(){return this.fieldTeamForm.get("vehiculo")}get placa(){return this.fieldTeamForm.get("placa")}get modelo(){return this.fieldTeamForm.get("modelo")}submit(){}createFieldTeam(){this.fieldTeamForm.valid&&this.fieldTeamService.createFieldTeam(this.fieldTeamForm.value).subscribe(o=>{1==o.status&&(l().fire("Ok!",o.message,"success"),this.dialogRef.close(1))},o=>{console.log(o)})}cancelAdd(){this.dialogRef.close()}}W.\u0275fac=function(o){return new(o||W)(t.Y36(C),t.Y36(_.qu),t.Y36(v.so))},W.\u0275cmp=t.Xpm({type:W,selectors:[["app-new-field-team-page"]],decls:38,vars:21,consts:[[1,"card"],[1,"card-body"],[3,"formGroup","submit"],[1,"form-group"],["appearance","outline",1,"full-width-input"],["type","text","formControlName","equipo","matInput","","placeholder","...","required","",1,"form-control"],[4,"ngIf"],["type","text","formControlName","supervisor","matInput","","placeholder","Juan P\xe9rez","required","",1,"form-control"],["type","text","formControlName","vehiculo","matInput","","placeholder","Carro, Cami\xf3n, Pickup","required","",1,"form-control"],["type","text","formControlName","placa","matInput","","placeholder","P216FMV","required","",1,"form-control"],["type","text","formControlName","modelo","placeholder","BMW X5","matInput","","required","",1,"form-control"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click",4,"ngxPermissionsOnly"],["type","submit","mat-stroked-button","","color","warn",3,"click",4,"ngxPermissionsOnly"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","submit","mat-stroked-button","","color","warn",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("submit",function(){return e.submit()}),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Ingrese Equipo de Campo"),t.qZA(),t._UZ(7,"input",5),t.YNc(8,ie,4,0,"mat-error",6),t.qZA()(),t.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),t._uU(12,"Ingrese Supervisor"),t.qZA(),t._UZ(13,"input",7),t.YNc(14,re,4,0,"mat-error",6),t.qZA()(),t.TgZ(15,"div",3)(16,"mat-form-field",4)(17,"mat-label"),t._uU(18,"Ingrese el Nombre del Vehiculo"),t.qZA(),t._UZ(19,"input",8),t.YNc(20,ne,4,0,"mat-error",6),t.qZA()(),t.TgZ(21,"div",3)(22,"mat-form-field",4)(23,"mat-label"),t._uU(24,"Ingrese la Placa del Vehiculo"),t.qZA(),t._UZ(25,"input",9),t.YNc(26,ae,4,0,"mat-error",6),t.YNc(27,ce,4,0,"mat-error",6),t.qZA()(),t.TgZ(28,"div",3)(29,"mat-form-field",4)(30,"mat-label"),t._uU(31,"Ingrese el Modelo del Vehiculo"),t.qZA(),t._UZ(32,"input",10),t.YNc(33,se,4,0,"mat-error",6),t.qZA()(),t.TgZ(34,"div",3),t.YNc(35,le,2,1,"button",11),t._UZ(36,"br"),t.YNc(37,me,2,0,"button",12),t.qZA()()()()),2&o&&(t.xp6(2),t.Q6J("formGroup",e.fieldTeamForm),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==e.equipo?null:e.equipo.touched)&&(null==e.equipo?null:e.equipo.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==e.supervisor?null:e.supervisor.touched)&&(null==e.supervisor?null:e.supervisor.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==e.vehiculo?null:e.vehiculo.touched)&&(null==e.vehiculo?null:e.vehiculo.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==e.placa?null:e.placa.touched)&&(null==e.placa?null:e.placa.hasError("required"))),t.xp6(1),t.Q6J("ngIf",(null==e.placa?null:e.placa.touched)&&(null==e.placa?null:e.placa.hasError("pattern"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==e.modelo?null:e.modelo.touched)&&(null==e.modelo?null:e.modelo.hasError("required"))),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(19,Tt)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(20,Tt)))},dependencies:[Z.O5,p.KE,p.hX,p.TO,m.Nt,x.lW,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.sg,_.u,U.gE]});var K=u(9132);class F{constructor(o){this.apiService=o}getData(o){return this.apiService.store("progresoUpms",o)}getDepartments(o){return this.apiService.store("departamentosProyecto",o)}getDataDepartment(o){return this.apiService.store("dataDepartamentosProyecto",o)}}F.\u0275fac=function(o){return new(o||F)(t.LFG(q.s))},F.\u0275prov=t.Yz7({token:F,factory:F.\u0275fac,providedIn:"root"});var vt=u(3546);const pe=function(i){return["reportDashboard",i]};function ue(i,o){if(1&i&&(t.TgZ(0,"mat-card",10)(1,"mat-card-content",11)(2,"a",12)(3,"mat-form-field"),t._UZ(4,"input",13)(5,"img",14),t.TgZ(6,"div",15)(7,"h3",16),t._uU(8),t.qZA()()()()()()),2&i){const e=o.$implicit;t.xp6(2),t.Q6J("routerLink",t.VKq(3,pe,e.id)),t.xp6(3),t.Q6J("src",e.image,t.LSH),t.xp6(3),t.Oqu(e.nombre)}}class V{constructor(o,e){this.projectHomeService=o,this.dashService=e,this.total=0,this.finished=0,this.progress=0,this.projectId=-1,this.percentajeFinished=0,this.percentajeProgress=0,this.totalProgres=0,this.totalProject=0,this.finshedTotalProject=0,this.percentajeTotal=0,this.project=localStorage.getItem("project")||"",this.departments=[]}ngOnInit(){let o=localStorage.getItem("project")||"";this.projectHomeService.getIdProject(o).subscribe(e=>{this.projectId=e,this.getData()})}getData(){let o={proyecto_id:this.projectId};this.dashService.getData(o).subscribe(e=>{this.finished=e.finalizados,this.total=e.total,this.progress=e.progreso,this.totalProgres=this.total-this.finished,this.percentajeFinished=100*e.finalizados/this.total,this.percentajeProgress=100*e.progreso/this.totalProgres,this.totalProject=e.total_proyecto,this.finshedTotalProject=e.total_finalizados,this.percentajeTotal=100*this.finshedTotalProject/this.totalProject}),this.dashService.getDepartments(o).subscribe(e=>{this.departments=e})}styleFinished(){return{"stroke-dasharray":`${this.percentajeFinished},100`}}styleProgress(){return{"stroke-dasharray":`${this.percentajeProgress},100`}}styleTotal(){return{"stroke-dasharray":`${this.percentajeTotal},100`}}}V.\u0275fac=function(o){return new(o||V)(t.Y36(S.l),t.Y36(F))},V.\u0275cmp=t.Xpm({type:V,selectors:[["app-control-dashboard"]],decls:51,vars:24,consts:[[1,"title"],[1,"flex-wrapper"],[1,"single-chart"],["viewBox","0 0 36 36",1,"circular-chart","blue"],["d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",1,"circle-bg"],["d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",1,"circle"],["x","18","y","20.35",1,"percentage"],[1,"header"],[1,"container"],["class","list_departments",4,"ngFor","ngForOf"],[1,"list_departments"],[1,"list_item"],[3,"routerLink"],["matInput","","placeholder","","readonly",""],["width","190","alt","Imagen de departamento ",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"]],template:function(o,e){1&o&&(t._UZ(0,"br")(1,"br")(2,"br"),t.TgZ(3,"div",0)(4,"div")(5,"h2"),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"h3")(9,"mat-label"),t._uU(10,"Progreso Total del Proyecto"),t.qZA()(),t.TgZ(11,"div",1)(12,"div",2),t.O4$(),t.TgZ(13,"svg",3),t._UZ(14,"path",4)(15,"path",5),t.TgZ(16,"text",6),t._uU(17),t.ALo(18,"number"),t.qZA()()()(),t.kcU(),t._UZ(19,"br"),t.qZA()(),t._UZ(20,"hr"),t.TgZ(21,"div")(22,"div",7)(23,"div")(24,"h3")(25,"mat-label"),t._uU(26),t.qZA()(),t.TgZ(27,"div",1)(28,"div",2),t.O4$(),t.TgZ(29,"svg",3),t._UZ(30,"path",4)(31,"path",5),t.TgZ(32,"text",6),t._uU(33),t.ALo(34,"number"),t.qZA()()()()(),t.kcU(),t.TgZ(35,"div")(36,"h3")(37,"mat-label"),t._uU(38),t.qZA()(),t.TgZ(39,"div",1)(40,"div",2),t.O4$(),t.TgZ(41,"svg",3),t._UZ(42,"path",4)(43,"path",5),t.TgZ(44,"text",6),t._uU(45),t.ALo(46,"number"),t.qZA()()()()()(),t.kcU(),t._UZ(47,"br"),t.TgZ(48,"div",8),t.YNc(49,ue,9,5,"mat-card",9),t.qZA(),t._UZ(50,"br"),t.qZA()),2&o&&(t.xp6(6),t.Oqu(e.project),t.xp6(9),t.Akn(e.styleTotal()),t.xp6(2),t.hij("",t.xi3(18,15,e.percentajeTotal,"2.2-2"),"%"),t.xp6(9),t.AsE("En Progreso ",e.progress,"/",e.totalProgres,""),t.xp6(5),t.Akn(e.styleProgress()),t.xp6(2),t.hij("",t.xi3(34,18,e.percentajeProgress,"2.2-2"),"%"),t.xp6(5),t.AsE("Finalizado ",e.finished,"/",e.total,""),t.xp6(5),t.Akn(e.styleFinished()),t.xp6(2),t.hij("",t.xi3(46,21,e.percentajeFinished,"2.2-2"),"%"),t.xp6(4),t.Q6J("ngForOf",e.departments))},dependencies:[Z.sg,K.rH,vt.a8,vt.dn,p.KE,p.hX,m.Nt,Z.JJ],styles:[".container[_ngcontent-%COMP%]{display:flex;margin-left:1.2rem;margin-right:1.2rem;flex-wrap:wrap;justify-content:space-around;align-items:center;gap:1rem}.title[_ngcontent-%COMP%]{display:flex;justify-content:space-around}"]});class Q{constructor(o,e){this.router=o,this.projectHomeService=e,this.projectId=-1,this.roles=[]}ngOnInit(){this.project=localStorage.getItem("project")||"",this.projectHomeService.getIdProject(this.project).subscribe(o=>{this.projectId=o,(-1==this.projectId||!this.project)&&this.router.navigateByUrl("home")})}}Q.\u0275fac=function(o){return new(o||Q)(t.Y36(K.F0),t.Y36(S.l))},Q.\u0275cmp=t.Xpm({type:Q,selectors:[["app-home-project-page"]],decls:2,vars:0,template:function(o,e){1&o&&(t.TgZ(0,"div"),t._UZ(1,"app-control-dashboard"),t.qZA())},dependencies:[V],styles:[".grid-example-square[_ngcontent-%COMP%]{justify-content:end}.mat_tab[_ngcontent-%COMP%]{margin:1.5rem;border:1px groove}"]});var b=u(3031);class J{constructor(o){this.apiService=o}getLog(o){return this.apiService.store("bitacoraUpm",o)}}function de(i,o){1&i&&(t.TgZ(0,"th",23),t._uU(1,"UPM"),t.qZA())}function _e(i,o){if(1&i&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.upm," ")}}function ge(i,o){1&i&&(t.TgZ(0,"th",23),t._uU(1,"Fecha y Hora"),t.qZA())}function fe(i,o){if(1&i&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.fecha," ")}}function he(i,o){1&i&&(t.TgZ(0,"th",23),t._uU(1,"Tipo"),t.qZA())}function be(i,o){if(1&i&&(t.TgZ(0,"td",24)(1,"button",25),t._uU(2),t.qZA()()),2&i){const e=o.$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngStyle",r.getColor(e.cod_estado)),t.xp6(1),t.hij(" ",e.tipo," ")}}function Te(i,o){1&i&&(t.TgZ(0,"th",23),t._uU(1,"Usuario"),t.qZA())}function ve(i,o){if(1&i&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.AsE(" ",e.nombres," ",e.apellidos," ")}}function Ce(i,o){1&i&&t._UZ(0,"th",26)}function Ze(i,o){1&i&&t._UZ(0,"td",24)}function xe(i,o){1&i&&t._UZ(0,"tr",27)}function ye(i,o){1&i&&t._UZ(0,"tr",28)}function we(i,o){if(1&i&&(t.TgZ(0,"tr",29)(1,"td",30),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(15);t.xp6(2),t.hij('No hay resultados de "',e.value,'"')}}J.\u0275fac=function(o){return new(o||J)(t.LFG(q.s))},J.\u0275prov=t.Yz7({token:J,factory:J.\u0275fac,providedIn:"root"});const Ue=function(){return[5,10,25,100]};class Y{constructor(o,e,r,n){this.dialogRef=o,this.bitService=e,this.projectService=r,this.data=n,this.displayedColumns=["upm","fecha","nombres","estado","options"],this.projectId=0,this.dataSource=new c.by}ngOnInit(){let o=localStorage.getItem("project")||"";this.projectService.getIdProject(o).subscribe(e=>{this.projectId=e,this.chargueUpms()})}getColor(o){for(let e=0;e<b.q.array.length;e++)if(b.q.array[e].id==Number(o))return{color:b.q.array[e].color,border:`1px solid ${b.q.array[e].color}`};return{}}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}chargueUpms(){this.bitService.getLog({proyecto_id:this.projectId,upm:this.data}).subscribe(e=>{this.dataSource=new c.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}}Y.\u0275fac=function(o){return new(o||Y)(t.Y36(v.so),t.Y36(J),t.Y36(S.l),t.Y36(v.WI))},Y.\u0275cmp=t.Xpm({type:Y,selectors:[["app-dialog-bitacora"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:40,vars:9,consts:[[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6","12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],[1,"mat-elevation-z8","table"],["appearance","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: Juan P\xe9rez",3,"keyup"],["input",""],["matSuffix",""],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","upm"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","fecha"],["matColumnDef","estado"],["matColumnDef","nombres"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t._UZ(0,"br"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h2"),t._uU(6,"Bitacora"),t.qZA()(),t._UZ(7,"div",4),t.qZA(),t._UZ(8,"br")(9,"br"),t.TgZ(10,"div",5)(11,"mat-form-field",6)(12,"mat-label"),t._uU(13,"Buscar"),t.qZA(),t.TgZ(14,"input",7,8),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(16,"mat-icon",9),t._uU(17,"search"),t.qZA()(),t._UZ(18,"br"),t.TgZ(19,"table",10),t.ynx(20,11),t.YNc(21,de,2,0,"th",12),t.YNc(22,_e,2,1,"td",13),t.BQk(),t.ynx(23,14),t.YNc(24,ge,2,0,"th",12),t.YNc(25,fe,2,1,"td",13),t.BQk(),t.ynx(26,15),t.YNc(27,he,2,0,"th",12),t.YNc(28,be,3,2,"td",13),t.BQk(),t.ynx(29,16),t.YNc(30,Te,2,0,"th",12),t.YNc(31,ve,2,2,"td",13),t.BQk(),t.ynx(32,17),t.YNc(33,Ce,1,0,"th",18),t.YNc(34,Ze,1,0,"td",13),t.BQk(),t.YNc(35,xe,1,0,"tr",19),t.YNc(36,ye,1,0,"tr",20),t.YNc(37,we,3,1,"tr",21),t.qZA(),t._UZ(38,"br")(39,"mat-paginator",22),t.qZA()()()),2&o&&(t.xp6(11),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",e.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(8,Ue)))},dependencies:[Z.PC,p.KE,p.hX,p.R9,m.Nt,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,g.YE,g.nU]});var Ae=u(6122);class E{constructor(o){this.apiService=o}getDataSupervisor(o){return this.apiService.store("obtenerUpmSupervisor",o)}getUsersAssigned(o){return this.apiService.store("obtenerCartografosSupervisor",o)}editUserSupervisor(o){return this.apiService.patch("asignarUsuarioSupervisor",o)}modifyCartographerUpm(o){return this.apiService.patch("upmCartografoSupervisor/edit",o)}}function Pe(i,o){1&i&&(t.TgZ(0,"mat-icon",6),t._uU(1,"beenhere"),t.qZA()),2&i&&t.Udp("font-size",25,"px")}function Se(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.editUser(a.codigo_usuario,a.nombres))}),t.YNc(1,Pe,2,2,"mat-icon",5),t._uU(2),t.qZA()}if(2&i){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",e.button),t.xp6(1),t.lnq(" ",e.codigo_usuario," - ",e.nombres," ",e.apellidos," ")}}E.\u0275fac=function(o){return new(o||E)(t.LFG(q.s))},E.\u0275prov=t.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"});class O{constructor(o,e,r,n,a){this.userService=o,this.supervisorService=e,this.dialogRef=r,this.data=n,this.formBuilder=a,this.button=!1,this.users=[],this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:s=>{s.addEventListener("mouseenter",l().stopTimer),s.addEventListener("mouseleave",l().resumeTimer)}}),this.getUsers()}submit(){}getUsers(){this.supervisorService.getUsersAssigned({proyecto_id:this.data.proyecto_id}).subscribe(e=>{this.users=e,this.users.forEach(r=>{r.button=!1}),this.defaultUsers()})}defaultUsers(){for(let o=0;o<this.users.length;o++)this.users[o].nombres==this.data.nombre&&this.users[o].codigo_usuario==this.data.codigo_usuario&&(this.users[o].button=!0)}editUser(o,e){o!=this.data.codigo_usuario&&e!=this.data.nombre?this.supervisorService.modifyCartographerUpm({usuario_nuevo:o,proyecto_id:this.data.proyecto_id,upm:this.data.upm}).subscribe(n=>{1==n.status&&(this.Toast.fire({icon:"success",title:n.message}),this.dialogRef.close(1))}):this.Toast.fire({icon:"error",title:"El usuario seleccionado ya es el encargado de el UPM"})}cancelEdit(){this.dialogRef.close()}}function De(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"UPM"),t.qZA())}function qe(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.upm," ")}}function Ne(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"COD Cartografo"),t.qZA())}function je(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.codigo_usuario," ")}}function ke(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Nombres"),t.qZA())}function Fe(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.nombres," ")}}function Ye(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Apellidos"),t.qZA())}function Ee(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.apellidos," ")}}function Oe(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Estado"),t.qZA())}function Me(i,o){if(1&i&&(t.TgZ(0,"td",25)(1,"button",26),t._uU(2),t.qZA()()),2&i){const e=o.$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngStyle",r.getColor(e.cod_estado)),t.xp6(1),t.hij(" ",e.estado," ")}}function Re(i,o){1&i&&t._UZ(0,"th",27)}function Be(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.asignar(n.codigo_usuario,n.nombres,n.upm))}),t.TgZ(1,"mat-icon"),t._uU(2,"person"),t.qZA()()}}function Qe(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.verMapa())}),t.TgZ(1,"mat-icon"),t._uU(2,"my_location"),t.qZA()()}}O.\u0275fac=function(o){return new(o||O)(t.Y36(Ae.UserService),t.Y36(E),t.Y36(v.so),t.Y36(v.WI),t.Y36(_.qu))},O.\u0275cmp=t.Xpm({type:O,selectors:[["app-dialog-supervisor-assign-user"]],decls:18,vars:1,consts:[[1,"title"],["mat-icon-button","",3,"click"],[1,"container"],["mat-flat-button","","class","menu_item button","color","primary",3,"click",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary",1,"menu_item","button",3,"click"],["class","routeIcon menu-icon","color","warn",3,"fontSize",4,"ngIf"],["color","warn",1,"routeIcon","menu-icon"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Asignar UPM a usuario"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return e.cancelEdit()}),t.TgZ(4,"mat-icon"),t._uU(5,"cancel"),t.qZA()()(),t._UZ(6,"br")(7,"br")(8,"br"),t.TgZ(9,"div")(10,"h3"),t._uU(11,"Usuarios"),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"p"),t._uU(14,"Haga click en el usuario al que le desea asignar el upm"),t.qZA(),t._UZ(15,"br"),t.TgZ(16,"div",2),t.YNc(17,Se,3,4,"button",3),t.qZA()()),2&o&&(t.xp6(17),t.Q6J("ngForOf",e.users))},dependencies:[Z.sg,Z.O5,x.lW,x.RK,d.Hw],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:2rem}h3[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{display:flex;justify-content:center}.container[_ngcontent-%COMP%]{display:flex;margin-left:.2rem;margin-right:.2rem;flex-direction:row;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:1rem}.button[_ngcontent-%COMP%]{display:flex;width:48%;align-items:center;height:50px}.menu-icon[_ngcontent-%COMP%]{height:32px;width:32px}@media (max-width: 768px){.button[_ngcontent-%COMP%]{display:flex;width:98%;height:60px}}"]});const Je=function(){return["editar-cartografo-upm"]},He=function(){return["ver-mapa"]};function Ie(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",25),t.YNc(1,Be,3,0,"button",28),t.YNc(2,Qe,3,0,"button",29),t.TgZ(3,"button",30),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.seeBitacor(a.upm))}),t.TgZ(4,"mat-icon"),t._uU(5,"remove_red_eye"),t.qZA()()()}2&i&&(t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(2,Je)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(3,He)))}function Ge(i,o){1&i&&t._UZ(0,"tr",33)}function ze(i,o){1&i&&t._UZ(0,"tr",34)}function $e(i,o){if(1&i&&(t.TgZ(0,"tr",35)(1,"td",36),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(17);t.xp6(2),t.hij('No hay resultados de "',e.value,'"')}}const Le=function(){return[5,10,25,100]};class H{constructor(o,e,r,n){this.formBuilder=o,this.supervisorService=e,this.dialogService=r,this.projectHomeService=n,this.displayedColumns=["upm","codigo_usuario","nombres","apellidos","estado","options"],this.data=[],this.idProject=0,this.supervisorData={id:0,upm:"",codigo_usuario:0,nombres:"",apellidos:"",estado:""},this.supervisorUserData={codigo_usuario:0,nombre:"",proyecto_id:0,upm:""},this.dataSource=new c.by,this.buildForm()}ngOnInit(){let o=localStorage.getItem("project")||"";this.projectHomeService.getIdProject(o).subscribe(e=>{this.idProject=e,this.supervisorUserData.proyecto_id=e,this.cargarTabla()})}buildForm(){this.formSupervisor=this.formBuilder.group({file:[""]})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}cargarTabla(){this.supervisorService.getDataSupervisor({proyecto_id:this.idProject}).subscribe(o=>{this.dataSource=new c.by(o),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}asignar(o,e,r){this.supervisorUserData.codigo_usuario=Number(o),this.supervisorUserData.nombre=e,this.supervisorUserData.upm=r,this.dialogService.open(O,{height:"50rem",width:"50rem",data:this.supervisorUserData}).afterClosed().subscribe(a=>{1===a&&this.cargarTabla()})}verMapa(){}getColor(o){for(let e=0;e<b.q.array.length;e++)if(b.q.array[e].id==Number(o))return{color:b.q.array[e].color,border:`1px solid ${b.q.array[e].color}`};return{}}seeBitacor(o){this.dialogService.open(Y,{height:"40rem",width:"48rem",data:o})}}H.\u0275fac=function(o){return new(o||H)(t.Y36(_.qu),t.Y36(E),t.Y36(v.uw),t.Y36(S.l))},H.\u0275cmp=t.Xpm({type:H,selectors:[["app-supervisor"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:45,vars:9,consts:[[1,"mat_tab"],[1,"grid-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6","12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],[1,"mat-elevation-z8","table"],["appareance","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: Juan P\xe9rez",3,"keyup"],["input",""],["matSuffix",""],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","upm"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","codigo_usuario"],["matColumnDef","nombres"],["matColumnDef","apellidos"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Click para modificar encargado","matTooltipPosition","above","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Click para Ver Mapa","matTooltipPosition","above","color","primary","clas","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver bitacora","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Click para modificar encargado","matTooltipPosition","above","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Click para Ver Mapa","matTooltipPosition","above","color","primary","clas","iconbutton",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t._UZ(0,"br"),t.TgZ(1,"div",0)(2,"div",1)(3,"div")(4,"div",2)(5,"div",3)(6,"h2"),t._uU(7,"Supervisor"),t.qZA()(),t._UZ(8,"div",4),t.qZA(),t._UZ(9,"br")(10,"br")(11,"br"),t.TgZ(12,"div",5)(13,"mat-form-field",6)(14,"mat-label"),t._uU(15,"Buscar"),t.qZA(),t.TgZ(16,"input",7,8),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(18,"mat-icon",9),t._uU(19,"search"),t.qZA()(),t._UZ(20,"br"),t.TgZ(21,"table",10),t.ynx(22,11),t.YNc(23,De,2,0,"th",12),t.YNc(24,qe,2,1,"td",13),t.BQk(),t.ynx(25,14),t.YNc(26,Ne,2,0,"th",12),t.YNc(27,je,2,1,"td",13),t.BQk(),t.ynx(28,15),t.YNc(29,ke,2,0,"th",12),t.YNc(30,Fe,2,1,"td",13),t.BQk(),t.ynx(31,16),t.YNc(32,Ye,2,0,"th",12),t.YNc(33,Ee,2,1,"td",13),t.BQk(),t.ynx(34,17),t.YNc(35,Oe,2,0,"th",12),t.YNc(36,Me,3,2,"td",13),t.BQk(),t.ynx(37,18),t.YNc(38,Re,1,0,"th",19),t.YNc(39,Ie,6,4,"td",13),t.BQk(),t.YNc(40,Ge,1,0,"tr",20),t.YNc(41,ze,1,0,"tr",21),t.YNc(42,$e,3,1,"tr",22),t.qZA(),t._UZ(43,"br")(44,"mat-paginator",23),t.qZA()()()()),2&o&&(t.xp6(13),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",e.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(8,Le)))},dependencies:[Z.PC,p.KE,p.hX,p.R9,m.Nt,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,D.gM,g.YE,g.nU,U.gE],styles:[".table[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-cell[_ngcontent-%COMP%]:nth-child(1), .mat-header-cell[_ngcontent-%COMP%]:nth-child(1){flex:0 0 6%}.mat-cell[_ngcontent-%COMP%]:nth-child(2), .mat-header-cell[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.mat-cell[_ngcontent-%COMP%]:nth-child(3), .mat-header-cell[_ngcontent-%COMP%]:nth-child(3){flex:0 0 6%}.mat-cell[_ngcontent-%COMP%]:nth-child(7), .mat-header-cell[_ngcontent-%COMP%]:nth-child(7){flex:0 0 7%}"]});var I=u(8049);function We(i,o){if(1&i&&(t.TgZ(0,"mat-option",20),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e.id+","+e.nombre),t.xp6(1),t.hij(" ",e.nombre," ")}}function Ke(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),a=t.MAs(12);return t.KtG(n.getUsers(a.value))}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_downward"),t.qZA(),t._uU(3," Descargar Plantilla "),t.qZA()}if(2&i){t.oxw();const e=t.MAs(12);t.Q6J("disabled",!e.value)}}function Ve(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo "),t.qZA()}}function Xe(i,o){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Encargado"),t.qZA())}function to(i,o){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.encargado)}}function eo(i,o){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Personal"),t.qZA())}function oo(i,o){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.empleado)}}function io(i,o){1&i&&(t.TgZ(0,"th",37),t._uU(1,"Opciones"),t.qZA())}function ro(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",36)(1,"button",38),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.deleteAsignation(a.encargado_id,a.empleado_id,a.encargado,a.empleado))}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()()}}function no(i,o){1&i&&t._UZ(0,"tr",39)}function ao(i,o){1&i&&t._UZ(0,"tr",40)}function co(i,o){if(1&i&&(t.TgZ(0,"tr",41)(1,"td",42),t._uU(2),t.qZA()()),2&i){t.oxw(2);const e=t.MAs(33);t.xp6(2),t.hij(' No hay resultados de "',e.value,'" ')}}const so=function(){return[5,10,25,100]};function lo(i,o){if(1&i&&(t.TgZ(0,"div",23)(1,"table",24),t.ynx(2,25),t.YNc(3,Xe,2,0,"th",26),t.YNc(4,to,2,1,"td",27),t.BQk(),t.ynx(5,28),t.YNc(6,eo,2,0,"th",26),t.YNc(7,oo,2,1,"td",27),t.BQk(),t.ynx(8,29),t.YNc(9,io,2,0,"th",30),t.YNc(10,ro,4,0,"td",27),t.BQk(),t.YNc(11,no,1,0,"tr",31),t.YNc(12,ao,1,0,"tr",32),t.YNc(13,co,3,1,"tr",33),t.qZA(),t._UZ(14,"br")(15,"mat-paginator",34),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(4,so))}}const mo=function(){return["descargar-plantilla"]},Ct=function(){return["asignar-personal"]};class X{constructor(o,e,r,n){this.rolService=o,this.projectHomeService=e,this.projectService=r,this.excelService=n,this.data=[[1,2],[3,4]],this.users=[],this.usernames=[],this.projectUserAssignment={usuario_id:0,proyecto_id:0},this.displayedColumns=["encargado","empleado","options"],this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new c.by}ngOnInit(){let o=localStorage.getItem("id");Number(o)&&(this.projectUserAssignment.usuario_id=Number(o),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.projectUserAssignment.proyecto_id=e,this.idProject=e,this.getGroupsMinor(),this.getChiefEmployee()})),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.idProject=e})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var o=this;return(0,T.Z)(function*(){o.rolService.getGroupsMinor(o.projectUserAssignment).subscribe(e=>{o.groups=e})})()}getUsers(o){let e=Number(localStorage.getItem("id")),r=o.split(",");this.users=[],this.usernames=[],this.projectHomeService.getUsersAssigned({rol_id:Number(r[0]),proyecto_id:this.idProject,usuario_id:e}).subscribe(n=>{this.usernames=n,this.usernames.forEach(a=>{this.users.push({encargado:"",codigo_usuario:a.codigo_usuario,nombres:a.nombres,apellidos:a.apellidos})}),this.excelService.exportAsExcelFile(this.users,r[1])})}addFile(){var o=this;return(0,T.Z)(function*(){const{value:e}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(e){const r=new FileReader;r.onload=n=>{const s=P.ij(n.target.result,{type:"binary"});o.data=P.P6.sheet_to_json(s.Sheets[s.SheetNames[0]],{header:1}),o.generateJson()},r.readAsBinaryString(e)}})()}generateJson(){var o=this;return(0,T.Z)(function*(){let e=Number(localStorage.getItem("id"));if(Number(e)){let r=[],n=[];o.data.forEach(a=>{a[0]&&a[1]&&r.push({codigo_superior:a[0],codigo_inferior:a[1],proyecto_id:o.idProject})}),r.shift(),r=r.filter(Boolean);for(let a=0;a<r.length;a++)for(let s=a+1;s<r.length;s++)null!=r[a]&&r[a].codigo_superior==r[s].codigo_superior&&r[a].codigo_inferior==r[s].codigo_inferior&&n.push(r[a].codigo_superior,r[a].codigo_inferior);for(let a=0;a<r.length;a++)for(let s=a+1;s<r.length;s++)r[a].codigo_inferior==r[s].codigo_inferior&&n.push(r[a].codigo_inferior);n.length>0?o.Toast.fire({icon:"error",title:"Hay filas repetidas: "+n}):o.projectHomeService.assignPersonal(r).subscribe(a=>{1==a.status&&(o.Toast.fire({icon:"success",title:a.message}),o.getChiefEmployee())})}})()}getChiefEmployee(){let o=Number(localStorage.getItem("id"));this.projectHomeService.getChiefEmployee({usuario_id:o,proyecto_id:this.idProject}).subscribe(e=>{this.dataSource=new c.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}verPlantilla(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaPersonal.png",imageWidth:375,imageHeight:250,imageAlt:"Ejemplo del archivo de carga"})}deleteAsignation(o,e,r,n){l().fire({title:"\xbfEst\xe1 seguro que desea desactivar la asignaci\xf3n: "+n+"?",text:"\xa1Esta acci\xf3n eliminar\xe1 todas las asignaciones de las tablas Personal y UPM!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Desactivar",cancelButtonText:"Cancelar"}).then(a=>{a.isConfirmed?this.projectHomeService.deleteAssingmentUsers({encargado_id:o,empleado_id:e,proyecto_id:this.idProject}).subscribe(s=>{1==s.status&&(l().fire("Ok",s.message,"success"),this.getChiefEmployee())}):a.isDenied&&l().fire("Cambios no guardados","","info")})}}function po(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Departamento"),t.qZA())}function uo(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.departamento)}}function _o(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Municipio"),t.qZA())}function go(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.municipio)}}function fo(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"UPM"),t.qZA())}function ho(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.upm)}}function bo(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Estado"),t.qZA())}function To(i,o){if(1&i&&(t.TgZ(0,"td",25)(1,"button",26),t._uU(2),t.qZA()()),2&i){const e=o.$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",r.getColor(e.cod_estado)),t.xp6(1),t.hij(" ",e.estado," ")}}function vo(i,o){1&i&&t._UZ(0,"th",27)}function Co(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.initActualization(n.upm))}),t.TgZ(1,"mat-icon"),t._uU(2,"power_settings_new"),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.Q6J("disabled",1!=e.cod_estado)}}function Zo(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.finishActualization(n.upm))}),t.TgZ(1,"mat-icon",32),t._uU(2,"done"),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.Q6J("disabled",1==e.cod_estado||3==e.cod_estado||4==e.cod_estado)}}X.\u0275fac=function(o){return new(o||X)(t.Y36(L.RolService),t.Y36(S.l),t.Y36(I.Y),t.Y36(j))},X.\u0275cmp=t.Xpm({type:X,selectors:[["app-asignar-personal"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:37,vars:13,consts:[[1,"mat_tab"],[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","accent",3,"disabled","click",4,"ngxPermissionsOnly"],[1,"container_options"],[1,"upms"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","encargado"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","empleado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-icon-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1"),t._uU(3,"Asignacion de Personal"),t.qZA()(),t._UZ(4,"br")(5,"br"),t.TgZ(6,"div",2)(7,"div",3)(8,"mat-form-field",4)(9,"mat-label"),t._uU(10,"Seleccione un Rol"),t.qZA(),t.TgZ(11,"mat-select",null,5),t.YNc(13,We,2,2,"mat-option",6),t.qZA()(),t.TgZ(14,"div"),t.YNc(15,Ke,4,1,"button",7),t.qZA()(),t.TgZ(16,"div",8)(17,"div",9),t.YNc(18,Ve,4,0,"button",10),t.qZA(),t.TgZ(19,"div")(20,"button",11),t.NdJ("click",function(){return e.verPlantilla()}),t.TgZ(21,"mat-icon"),t._uU(22,"remove_red_eye"),t.qZA(),t._uU(23," Ver ejemplo de archivo de carga "),t.qZA()()()(),t.TgZ(24,"div",12)(25,"div")(26,"div",13),t._UZ(27,"div",14),t.qZA(),t._UZ(28,"br"),t.TgZ(29,"mat-form-field",15)(30,"mat-label"),t._uU(31,"Buscar"),t.qZA(),t.TgZ(32,"input",16,17),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(34,"mat-icon",18),t._uU(35,"search"),t.qZA()(),t.YNc(36,lo,16,5,"div",19),t.qZA()()()),2&o&&(t.xp6(9),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngForOf",e.groups),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(10,mo)),t.xp6(3),t.Q6J("ngxPermissionsOnly",t.DdM(11,Ct)),t.xp6(11),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(6),t.Q6J("ngxPermissionsOnly",t.DdM(12,Ct)))},dependencies:[Z.sg,p.KE,p.hX,p.R9,m.Nt,x.lW,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,pt.gD,gt.ey,D.gM,g.YE,g.nU,U.gE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}"]});const xo=function(){return["inicializar-actualizacion"]},yo=function(){return["finalizar-actualizacion"]};function wo(i,o){1&i&&(t.TgZ(0,"td",25)(1,"div"),t.YNc(2,Co,3,1,"button",28),t.qZA(),t.TgZ(3,"div"),t.YNc(4,Zo,3,1,"button",29),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(2,xo)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(3,yo)))}function Uo(i,o){1&i&&t._UZ(0,"tr",33)}function Ao(i,o){1&i&&t._UZ(0,"tr",34)}function Po(i,o){if(1&i&&(t.TgZ(0,"tr",35)(1,"td",36),t._uU(2),t.qZA()()),2&i){t.oxw(2);const e=t.MAs(16);t.xp6(2),t.hij(' No hay resultados de "',e.value,'" ')}}const So=function(){return[10,25,100]};function Do(i,o){if(1&i&&(t.TgZ(0,"div",10)(1,"table",11),t.ynx(2,12),t.YNc(3,po,2,0,"th",13),t.YNc(4,uo,2,1,"td",14),t.BQk(),t.ynx(5,15),t.YNc(6,_o,2,0,"th",13),t.YNc(7,go,2,1,"td",14),t.BQk(),t.ynx(8,16),t.YNc(9,fo,2,0,"th",13),t.YNc(10,ho,2,1,"td",14),t.BQk(),t.ynx(11,17),t.YNc(12,bo,2,0,"th",13),t.YNc(13,To,3,2,"td",14),t.BQk(),t.ynx(14,18),t.YNc(15,vo,1,0,"th",19),t.YNc(16,wo,5,4,"td",14),t.BQk(),t.YNc(17,Uo,1,0,"tr",20),t.YNc(18,Ao,1,0,"tr",21),t.YNc(19,Po,3,1,"tr",22),t.qZA(),t._UZ(20,"mat-paginator",23),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,So))}}const qo=function(){return["ver-upms-cartografo"]};class tt{constructor(o,e,r,n){this.formBuilder=o,this.dialog=e,this.homeProjectService=r,this.projectService=n,this.displayedColumns=["departamento","municipio","upm","estado","options"],this.data=[],this.assignment={proyecto_id:0,upms:[]},this.upmDataSust={proyecto_id:0,upm_nuevo:"",upm_anterior:0,descripcion:"",usuario_id:0},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new c.by,this.buildForm()}buildForm(){this.formUpms=this.formBuilder.group({file:[""]})}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o,this.cargarUpmsAsignadas()})}cargarUpmsAsignadas(){0!=this.idProject&&this.projectService.getUpmCartographer({proyecto_id:this.idProject}).subscribe(o=>{this.dataSource=new c.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getColor(o){for(let e=0;e<b.q.array.length;e++)if(b.q.array[e].id==Number(o))return{color:b.q.array[e].color,border:`1px solid ${b.q.array[e].color}`};return{}}initActualization(o){this.homeProjectService.initActualization({upm:o,proyecto_id:this.idProject}).subscribe(r=>{1==r.status&&(this.Toast.fire({icon:"success",title:r.message}),this.cargarUpmsAsignadas())})}finishActualization(o){this.homeProjectService.finishActualization({upm:o,proyecto_id:this.idProject}).subscribe(r=>{1==r.status&&(this.Toast.fire({icon:"success",title:r.message}),this.cargarUpmsAsignadas())})}}function No(i,o){if(1&i&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e.id+","+e.nombre),t.xp6(1),t.hij(" ",e.nombre," ")}}function jo(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),a=t.MAs(12);return t.KtG(n.getUpmsAsignn(a.value))}),t.TgZ(2,"mat-icon"),t._uU(3,"arrow_downward"),t.qZA(),t._uU(4," Descargar Plantilla "),t.qZA()()}if(2&i){t.oxw();const e=t.MAs(12);t.xp6(1),t.Q6J("disabled",!e.value)}}function ko(i,o){1&i&&(t.TgZ(0,"button",23)(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Agregar "),t.qZA())}function Fo(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo "),t.qZA()}}function Yo(i,o){1&i&&(t.TgZ(0,"th",38),t._uU(1,"Rol"),t.qZA())}function Eo(i,o){if(1&i&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.rol)}}function Oo(i,o){1&i&&(t.TgZ(0,"th",38),t._uU(1,"Encargado"),t.qZA())}function Mo(i,o){if(1&i&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.encargado)}}function Ro(i,o){1&i&&(t.TgZ(0,"th",38),t._uU(1,"UPM"),t.qZA())}function Bo(i,o){if(1&i&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.upm)}}function Qo(i,o){1&i&&(t.TgZ(0,"th",40),t._uU(1,"Opciones"),t.qZA())}function Jo(i,o){1&i&&(t.TgZ(0,"td",39)(1,"button",41)(2,"mat-icon"),t._uU(3,"my_location"),t.qZA()()())}function Ho(i,o){1&i&&t._UZ(0,"tr",42)}function Io(i,o){1&i&&t._UZ(0,"tr",43)}function Go(i,o){if(1&i&&(t.TgZ(0,"tr",44)(1,"td",45),t._uU(2),t.qZA()()),2&i){t.oxw(2);const e=t.MAs(35);t.xp6(2),t.hij(' No hay resultados de "',e.value,'" ')}}tt.\u0275fac=function(o){return new(o||tt)(t.Y36(_.qu),t.Y36(v.uw),t.Y36(S.l),t.Y36(I.Y))},tt.\u0275cmp=t.Xpm({type:tt,selectors:[["app-cartographer"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:20,vars:6,consts:[[1,"mat_tab"],[1,"grid-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6-12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-flat-button","","color","primary","matTooltip","Iniciar Actualizacion","matTooltipPosition","right",3,"disabled","click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","warn","matTooltip","Finalizar UPM","matTooltipPosition","left",3,"disabled","click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","primary","matTooltip","Iniciar Actualizacion","matTooltipPosition","right",3,"disabled","click"],["mat-flat-button","","color","warn","matTooltip","Finalizar UPM","matTooltipPosition","left",3,"disabled","click"],["aria-label","Home"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t._UZ(0,"br"),t.TgZ(1,"div",0)(2,"div",1)(3,"div")(4,"div",2)(5,"div",3)(6,"h2"),t._uU(7,"\xc1rea de Cartografo"),t.qZA()(),t._UZ(8,"div",4),t.qZA(),t._UZ(9,"br")(10,"br")(11,"br"),t.TgZ(12,"mat-form-field",5)(13,"mat-label"),t._uU(14,"Buscar"),t.qZA(),t.TgZ(15,"input",6,7),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(17,"mat-icon",8),t._uU(18,"search"),t.qZA()(),t.YNc(19,Do,21,5,"div",9),t.qZA()()()),2&o&&(t.xp6(12),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(6),t.Q6J("ngxPermissionsOnly",t.DdM(5,qo)))},dependencies:[Z.PC,p.KE,p.hX,p.R9,m.Nt,x.lW,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,D.gM,g.YE,g.nU,U.gE]});const zo=function(){return[5,10,25,100]};function $o(i,o){if(1&i&&(t.TgZ(0,"div",25)(1,"table",26),t.ynx(2,27),t.YNc(3,Yo,2,0,"th",28),t.YNc(4,Eo,2,1,"td",29),t.BQk(),t.ynx(5,30),t.YNc(6,Oo,2,0,"th",28),t.YNc(7,Mo,2,1,"td",29),t.BQk(),t.ynx(8,31),t.YNc(9,Ro,2,0,"th",28),t.YNc(10,Bo,2,1,"td",29),t.BQk(),t.ynx(11,32),t.YNc(12,Qo,2,0,"th",33),t.YNc(13,Jo,4,0,"td",29),t.BQk(),t.YNc(14,Ho,1,0,"tr",34),t.YNc(15,Io,1,0,"tr",35),t.YNc(16,Go,3,1,"tr",36),t.qZA(),t._UZ(17,"br")(18,"mat-paginator",37),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(4,zo))}}const Lo=function(){return["descargar-plantilla"]},ft=function(){return["asignar-upms-personal"]};class et{constructor(o,e,r,n){this.rolService=o,this.projectHomeService=e,this.projectService=r,this.excelService=n,this.users=[],this.data=[[1,2],[3,4]],this.displayedColumns=["rol","encargado","upm","options"],this.datos=[],this.dataFile=[],this.nameUpms=[],this.projectUserAssignment={usuario_id:0,proyecto_id:0},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new c.by}ngOnInit(){let o=localStorage.getItem("id");Number(o)&&(this.projectUserAssignment.usuario_id=Number(o),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.projectUserAssignment.proyecto_id=e,this.idProject=e,this.getGroupsMinor(),this.cargarUpmChief()}))}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var o=this;return(0,T.Z)(function*(){o.rolService.getGroupsMinor(o.projectUserAssignment).subscribe(e=>{o.groups=e})})()}verPlantilla(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaUPMUsuario.png",imageWidth:460,imageHeight:200,imageAlt:"Ejemplo del archivo de carga"})}getUpmsAsignn(o){var e=this;return(0,T.Z)(function*(){let r=localStorage.getItem("id");e.nameUpms=[];let n=o.split(",");Number(e.idProject)&&e.projectHomeService.getUpmsAssgined({proyecto_id:e.idProject,usuario_id:r}).subscribe(a=>{a.forEach(s=>{e.nameUpms.push(s.upm)}),e.getUsersAssign(n[0],n[1])})})()}getUsersAssign(o,e){this.users=[];let r=localStorage.getItem("id");this.projectHomeService.getUsersAssigned({proyecto_id:this.idProject,rol_id:o,usuario_id:r}).subscribe(n=>{this.users=n,this.createFile(e)})}createFile(o){this.dataFile=[];for(let e=0;e<this.nameUpms.length;e++)this.dataFile.push({upm:this.nameUpms[e],codigo_usuario:"",nombres:"",apellidos:""});for(let e=0;e<this.users.length;e++)this.dataFile.push({upm:"",codigo_usuario:this.users[e].codigo_usuario,nombres:this.users[e].nombres,apellidos:this.users[e].apellidos});this.excelService.exportAsExcelFile(this.dataFile,"AsignacionUPMS"+o)}addFile(){var o=this;return(0,T.Z)(function*(){o.data=[];const{value:e}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(e){const r=new FileReader;r.onload=n=>{const s=P.ij(n.target.result,{type:"binary"});o.data=P.P6.sheet_to_json(s.Sheets[s.SheetNames[0]],{header:1}),o.generateJson()},r.readAsBinaryString(e)}})()}generateJson(){var o=this;return(0,T.Z)(function*(){let e=[],r=[];o.data=o.data.filter(Boolean),o.data.forEach(n=>{n[0]&&n[1]&&e.push({upm:n[0],codigo_usuario:n[1],proyecto_id:o.idProject})}),e.shift(),e=e.filter(Boolean);for(let n=0;n<e.length;n++)for(let a=n+1;a<e.length;a++)null!=e[n]&&e[n].upm==e[a].upm&&e[n].codigo_inferior==e[a].codigo_inferior&&r.push(e[n].codigo_usuario,e[n].codigo_usuario);for(let n=0;n<e.length;n++)for(let a=n+1;a<e.length;a++)e[n].upm==e[a].upm&&r.push(e[n].upm);r.length>0?o.Toast.fire({icon:"error",title:"Hay UPMs Repetidos: "+r}):o.projectHomeService.assignChiefUpms(e).subscribe(n=>{1==n.status&&(o.cargarUpmChief(),o.Toast.fire({icon:"success",title:n.message}))})})()}cargarUpmChief(){let o=localStorage.getItem("id");this.projectHomeService.chargeUpmsChief({proyecto_id:this.idProject,usuario_id:o}).subscribe(e=>{this.dataSource=new c.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}}function Wo(i,o){1&i&&(t.TgZ(0,"th",30),t._uU(1,"Municipio"),t.qZA())}function Ko(i,o){if(1&i&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.municipio," ")}}function Vo(i,o){1&i&&(t.TgZ(0,"th",30),t._uU(1,"UPM"),t.qZA())}function Xo(i,o){if(1&i&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.upm," ")}}function ti(i,o){1&i&&(t.TgZ(0,"th",30),t._uU(1,"Estado"),t.qZA())}function ei(i,o){if(1&i&&(t.TgZ(0,"td",31)(1,"button",32),t._uU(2),t.qZA()()),2&i){const e=o.$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngStyle",r.getColor(e.cod_estado)),t.xp6(1),t.hij(" ",e.estado," ")}}function oi(i,o){1&i&&(t.TgZ(0,"th",33),t._uU(1,"Acciones"),t.qZA())}function ii(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",31)(1,"button",34),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.seeBitacor(a.upm))}),t.TgZ(2,"mat-icon"),t._uU(3,"remove_red_eye"),t.qZA()()()}}function ri(i,o){1&i&&t._UZ(0,"tr",35)}function ni(i,o){1&i&&t._UZ(0,"tr",36)}function ai(i,o){if(1&i&&(t.TgZ(0,"tr",37)(1,"td",38),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(42);t.xp6(2),t.hij('No hay resultados de "',e.value,'"')}}et.\u0275fac=function(o){return new(o||et)(t.Y36(L.RolService),t.Y36(S.l),t.Y36(I.Y),t.Y36(j))},et.\u0275cmp=t.Xpm({type:et,selectors:[["app-encargado-upms"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:39,vars:15,consts:[[1,"mat_tab"],[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngxPermissionsOnly"],[1,"container_options"],["mat-flat-button","","color","accent","style","margin-right: 8px",4,"ngxPermissionsOnly"],[1,"upms"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",2,"margin-right","8px"],["mat-flat-button","","color","accent",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","rol"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","encargado"],["matColumnDef","upm"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Ver Mapa"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1"),t._uU(3,"Asignacion de UPM"),t.qZA()(),t._UZ(4,"br")(5,"br"),t.TgZ(6,"div",2)(7,"div",3)(8,"mat-form-field",4)(9,"mat-label"),t._uU(10,"Seleccione un Rol"),t.qZA(),t.TgZ(11,"mat-select",null,5),t.YNc(13,No,2,2,"mat-option",6),t.qZA()(),t.YNc(14,jo,5,1,"div",7),t.qZA(),t.TgZ(15,"div",8)(16,"div"),t.YNc(17,ko,4,0,"button",9),t.qZA(),t.TgZ(18,"div",10),t.YNc(19,Fo,4,0,"button",11),t.qZA(),t.TgZ(20,"div")(21,"button",12),t.NdJ("click",function(){return e.verPlantilla()}),t.TgZ(22,"mat-icon"),t._uU(23,"remove_red_eye"),t.qZA(),t._uU(24," Ver ejemplo de archivo de carga "),t.qZA()()()(),t._UZ(25,"br"),t.TgZ(26,"div",13)(27,"div")(28,"div",14),t._UZ(29,"div",15),t.qZA(),t._UZ(30,"br"),t.TgZ(31,"mat-form-field",16)(32,"mat-label"),t._uU(33,"Buscar"),t.qZA(),t.TgZ(34,"input",17,18),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(36,"mat-icon",19),t._uU(37,"search"),t.qZA()(),t.YNc(38,$o,19,5,"div",20),t.qZA()()()),2&o&&(t.xp6(9),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngForOf",e.groups),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(11,Lo)),t.xp6(3),t.Q6J("ngxPermissionsOnly",t.DdM(12,ft)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(13,ft)),t.xp6(12),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(6),t.Q6J("ngxPermissionsOnly",t.DdM(14,ft)))},dependencies:[Z.sg,p.KE,p.hX,p.R9,m.Nt,x.lW,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,pt.gD,gt.ey,D.gM,g.YE,g.nU,U.gE],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}"]});const ci=function(){return[5,10,25,100]};class ot{constructor(o,e,r,n,a){this.formBuilder=o,this.dashboardService=e,this.dialogService=r,this.projectHomeService=n,this.route=a,this.departmentId=0,this.departmentName="",this.displayedColumns=["municipio","upm","estado","options"],this.data=[],this.departamentoData={id:0,nombre:"",image:""},this.dataSource=new c.by,this.total=0,this.finished=0,this.progress=0,this.projectId=-1,this.percentajeFinished=0,this.percentajeProgress=0,this.totalProgres=0}ngOnInit(){this.route.params.subscribe(e=>{this.departmentId=Number(e.id)||0});let o=localStorage.getItem("project")||"";this.projectHomeService.getIdProject(o).subscribe(e=>{this.projectId=e,this.chargeData()})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}chargeData(){this.dashboardService.getDataDepartment({departamento_id:this.departmentId,proyecto_id:this.projectId}).subscribe(e=>{this.departmentName=e.nombre,this.total=e.total,this.progress=e.progreso,this.finished=e.finished,this.totalProgres=this.total-this.finished,this.percentajeFinished=100*this.finished/this.total,this.percentajeProgress=100*this.progress/this.totalProgres,this.dataSource=new c.by(e.data),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}getColor(o){for(let e=0;e<b.q.array.length;e++)if(b.q.array[e].id==Number(o))return{color:b.q.array[e].color,border:`1px solid ${b.q.array[e].color}`};return{}}styleFinished(){return{"stroke-dasharray":`${this.percentajeFinished},100`}}styleProgress(){return{"stroke-dasharray":`${this.percentajeProgress},100`}}seeBitacor(o){this.dialogService.open(Y,{height:"40rem",width:"48rem",data:o})}}ot.\u0275fac=function(o){return new(o||ot)(t.Y36(_.qu),t.Y36(F),t.Y36(v.uw),t.Y36(S.l),t.Y36(K.gz))},ot.\u0275cmp=t.Xpm({type:ot,selectors:[["app-control-dashboard-dialog"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:64,vars:26,consts:[[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6-12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],[1,"col-sm-1-1","col","sm-3-12","col-md-3-12"],[1,"header"],[1,"flex-wrapper"],[1,"single-chart"],["viewBox","0 0 36 36",1,"circular-chart","blue"],["d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",1,"circle-bg"],["d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",1,"circle"],["x","18","y","20.35",1,"percentage"],[1,"mat-elevation-z8"],["appareance","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE010100007A1",3,"keyup"],["input",""],["matSuffix",""],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","municipio"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Ver bitacora","color","primary",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t._UZ(0,"br"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h2"),t._uU(6),t.qZA()(),t._UZ(7,"div",4),t.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"h3")(12,"mat-label"),t._uU(13),t.qZA()(),t.TgZ(14,"div",7)(15,"div",8),t.O4$(),t.TgZ(16,"svg",9),t._UZ(17,"path",10)(18,"path",11),t.TgZ(19,"text",12),t._uU(20),t.ALo(21,"number"),t.qZA()()()()(),t.kcU(),t.TgZ(22,"div")(23,"h3")(24,"mat-label"),t._uU(25),t.qZA()(),t.TgZ(26,"div",7)(27,"div",8),t.O4$(),t.TgZ(28,"svg",9),t._UZ(29,"path",10)(30,"path",11),t.TgZ(31,"text",12),t._uU(32),t.ALo(33,"number"),t.qZA()()()()()()()(),t.kcU(),t._UZ(34,"br")(35,"br")(36,"br"),t.TgZ(37,"div",13)(38,"mat-form-field",14)(39,"mat-label"),t._uU(40,"Buscar"),t.qZA(),t.TgZ(41,"input",15,16),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(43,"mat-icon",17),t._uU(44,"search"),t.qZA()(),t._UZ(45,"br"),t.TgZ(46,"table",18),t.ynx(47,19),t.YNc(48,Wo,2,0,"th",20),t.YNc(49,Ko,2,1,"td",21),t.BQk(),t.ynx(50,22),t.YNc(51,Vo,2,0,"th",20),t.YNc(52,Xo,2,1,"td",21),t.BQk(),t.ynx(53,23),t.YNc(54,ti,2,0,"th",20),t.YNc(55,ei,3,2,"td",21),t.BQk(),t.ynx(56,24),t.YNc(57,oi,2,0,"th",25),t.YNc(58,ii,4,0,"td",21),t.BQk(),t.YNc(59,ri,1,0,"tr",26),t.YNc(60,ni,1,0,"tr",27),t.YNc(61,ai,3,1,"tr",28),t.qZA(),t._UZ(62,"br")(63,"mat-paginator",29),t.qZA()()()),2&o&&(t.xp6(6),t.hij("Departamento de ",e.departmentName," "),t.xp6(7),t.AsE("En Progreso ",e.progress,"/",e.totalProgres,""),t.xp6(5),t.Akn(e.styleProgress()),t.xp6(2),t.hij("",t.xi3(21,19,e.percentajeProgress,"2.2-2"),"%"),t.xp6(5),t.AsE("Finalizado ",e.finished,"/",e.total,""),t.xp6(5),t.Akn(e.styleFinished()),t.xp6(2),t.hij("",t.xi3(33,22,e.percentajeFinished,"2.2-2"),"%"),t.xp6(6),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",e.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(25,ci)))},dependencies:[Z.PC,p.KE,p.hX,p.R9,m.Nt,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,D.gM,g.YE,g.nU,Z.JJ],styles:[".mat-cell[_ngcontent-%COMP%]:nth-child(1), .mat-header-cell[_ngcontent-%COMP%]:nth-child(1){flex:0 0 6%}.mat-cell[_ngcontent-%COMP%]:nth-child(2), .mat-header-cell[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.mat-cell[_ngcontent-%COMP%]:nth-child(3), .mat-header-cell[_ngcontent-%COMP%]:nth-child(3){flex:0 0 6%}.mat-cell[_ngcontent-%COMP%]:nth-child(7), .mat-header-cell[_ngcontent-%COMP%]:nth-child(7){flex:0 0 7%}.header[_ngcontent-%COMP%]{display:flex;margin:.5rem;padding:0 .4rem;gap:3rem;text-align:center}.mat_tab[_ngcontent-%COMP%]{margin:1.5rem;border:1px groove}"]});var Zt=u(3848),ut=u(1206),si=u(3204),li=u(7293),mi=u(7941);function pi(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Nombre de rol es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function ui(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createGroup())}),t._uU(1," Guardar Rol "),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("disabled",!e.groupForm.valid)}}const di=function(){return["crear-grupo"]};class it{constructor(o,e,r,n,a){this.rolService=o,this.data=e,this.projectService=r,this.formBuilder=n,this.dialogRef=a,this.buildForm()}buildForm(){this.groupForm=this.formBuilder.group({nombre:["",_.kI.required],descripcion:[""],proyecto_id:[this.data,[_.kI.required]]})}get Nombre(){return this.groupForm.get("nombre")}get Descripcion(){return this.groupForm.get("descripcion")}get ProyectoId(){return this.groupForm.get("proyecto_id")}get Jerarquia(){return this.groupForm.get("jerarquia")}submit(){}createGroup(){this.groupForm.valid&&this.rolService.create(this.groupForm.value).subscribe(o=>{1==o.status&&(l().fire("Ok!",o.message,"success"),this.dialogRef.close(1))})}cancelAdd(){this.dialogRef.close()}}it.\u0275fac=function(o){return new(o||it)(t.Y36(L.RolService),t.Y36(v.WI),t.Y36(I.Y),t.Y36(_.qu),t.Y36(v.so))},it.\u0275cmp=t.Xpm({type:it,selectors:[["app-new-group-project"]],decls:19,vars:8,consts:[[1,"card"],[1,"card-body"],[3,"formGroup","submit"],[1,"form-group"],["appearance","outline",1,"full-width-input"],["type","text","formControlName","nombre","matInput","","placeholder","Supervisores ENEI","required","",1,"form-control"],[4,"ngIf"],["type","text","formControlName","descripcion","placeholder","Grupo 2026","matInput","",1,"form-control"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click",4,"ngxPermissionsOnly"],["type","submit","mat-stroked-button","","color","warn",3,"click"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("submit",function(){return e.submit()}),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Ingrese el Nombre del Rol"),t.qZA(),t._UZ(7,"input",5),t.YNc(8,pi,4,0,"mat-error",6),t.qZA()(),t.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),t._uU(12,"Descripcion(Opcional)"),t.qZA(),t._UZ(13,"input",7),t.qZA()(),t.TgZ(14,"div",3),t.YNc(15,ui,2,1,"button",8),t._UZ(16,"br"),t.TgZ(17,"button",9),t.NdJ("click",function(){return e.cancelAdd()}),t._uU(18," Cancelar "),t.qZA()()()()()),2&o&&(t.xp6(2),t.Q6J("formGroup",e.groupForm),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==e.Nombre?null:e.Nombre.touched)&&(null==e.Nombre?null:e.Nombre.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngxPermissionsOnly",t.DdM(7,di)))},dependencies:[Z.O5,p.KE,p.hX,p.TO,m.Nt,x.lW,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.sg,_.u,U.gE],styles:[".full-width-input[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%;max-width:98%;margin:0 auto;display:flex}.example-section[_ngcontent-%COMP%]{max-width:98%;margin:0 auto;display:flex}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.card[_ngcontent-%COMP%]{padding:3rem}"]});const _i=["table"];function gi(i,o){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"ID"),t.qZA())}function fi(i,o){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.id)}}function hi(i,o){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Nombre"),t.qZA())}function bi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"mat-cell")(1,"mat-icon",16),t.NdJ("mousedown",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.dragDisabled=!1)}),t._uU(2,"reorder"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&i){const e=o.$implicit;t.xp6(4),t.Oqu(e.nombre)}}function Ti(i,o){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Orden"),t.qZA())}function vi(i,o){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.jerarquia)}}function Ci(i,o){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Descripcion"),t.qZA())}function Zi(i,o){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.descripcion)}}function xi(i,o){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Acciones"),t.qZA())}function yi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.editar(n.id,n.nombre,n.descripcion,n.proyecto_id))}),t.TgZ(1,"mat-icon",24),t._uU(2,"edit"),t.qZA()()}}function wi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.desactivar(n.id,n.nombre))}),t.TgZ(1,"mat-icon",26),t._uU(2,"delete"),t.qZA()()}}function Ui(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.verUsuarios(n.id,n.nombre))}),t.TgZ(1,"mat-icon"),t._uU(2,"supervised_user_circle"),t.qZA()()}}function Ai(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addUser(n.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function Pi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addFile(n.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA()()}}function Si(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.verRoles(n.id,n.nombre))}),t.TgZ(1,"mat-icon"),t._uU(2,"list_alt"),t.qZA()()}}const Di=function(){return["editar-rol-proyecto"]},qi=function(){return["desactivar-rol-proyecto"]},Ni=function(){return["ver-usuario-rol-proyecto"]},xt=function(){return["asignar-usuario-rol-proyecto"]},ji=function(){return["asignar-rol-politica-proyecto"]};function ki(i,o){1&i&&(t.TgZ(0,"mat-cell"),t.YNc(1,yi,3,0,"button",17),t.YNc(2,wi,3,0,"button",18),t.YNc(3,Ui,3,0,"button",19),t.YNc(4,Ai,3,0,"button",20),t.YNc(5,Pi,3,0,"button",21),t.YNc(6,Si,3,0,"button",22),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(6,Di)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(7,qi)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(8,Ni)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(9,xt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(10,xt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(11,ji)))}function Fi(i,o){1&i&&t._UZ(0,"mat-header-row")}function Yi(i,o){1&i&&t._UZ(0,"mat-row",31),2&i&&t.Q6J("cdkDragData",o.$implicit)}function Ei(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createGroup())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Crear Rol "),t.qZA()}}const Oi=function(){return["crear-rol_proyecto"]};class rt{constructor(o,e,r){this.projectHomeService=o,this.rolService=e,this.dialogService=r,this.data=[],this.displayedColumns=["nombre","jerarquia","descripcion","options"],this.dragDisabled=!0,this.project="",this.group={id:0,jerarquia:0,nombre:"",descripcion:"",proyecto_id:0,proyecto:""},this.userData={nombres:"",rol_id:0,apellidos:"",codigo_usuario:0,proyecto:""},this.roleData={id:0,nombre:"",roles:[]},this.userDataFile={rol_id:0,usuarios:[],proyecto:""}}ngOnInit(){this.project=localStorage.getItem("project")||"",this.cargarGrupos()}drop(o){this.dragDisabled=!0,this.dataSource.find(a=>a==o.item.data);const n=this.dataSource.findIndex(a=>a==o.item.data);(0,ut.bA)(this.dataSource,n,o.currentIndex),this.table.renderRows(),this.ordenarJerarquias()}ordenarJerarquias(){for(let o=0;o<this.dataSource.length;o++)for(let e=0;e<this.dataSource.length;e++)(this.dataSource[o].jerarquia>this.dataSource[e].jerarquia||this.dataSource[o].jerarquia==this.dataSource[e].jerarquia)&&(this.dataSource[o].jerarquia=this.dataSource.length-o)}desactivar(o,e){l().fire({title:"\xbfEst\xe1 seguro que desea desactivar el rol: "+e+"?",text:"\xa1Esta acci\xf3n eliminar\xe1 todos los usuarios que se encuentran asignados a este rol y todas las asignaciones de las tablas Personal y UPM!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Desactivar",cancelButtonText:"Cancelar"}).then(r=>{r.isConfirmed?this.rolService.desactiveGroup(Number(o)).subscribe(n=>{1==n.status&&(this.cargarGrupos(),l().fire("Ok!","Rol desactivado","success"))}):r.isDenied&&l().fire("Cambios no guardados","","info")})}editar(o,e,r,n){this.group.id=Number(o),this.group.nombre=e,this.group.descripcion=r,this.group.proyecto_id=Number(n),this.dialogService.open(si.w,{height:"20rem",width:"50rem",data:this.group}).afterClosed().subscribe(s=>{1===s&&this.cargarGrupos()})}addUser(o){var e=this;return(0,T.Z)(function*(){const{value:r}=yield l().fire({title:"Usuario",input:"number",inputPlaceholder:"juan2022",confirmButtonText:"Agregar Usuario",showCancelButton:!0,cancelButtonText:"Cancelar",inputLabel:"Ingrese el codigo de usuario"});r&&(e.userData.rol_id=Number(o),e.userData.proyecto=e.project,e.userData.codigo_usuario=r,e.rolService.addUserToGroup(e.userData).subscribe(n=>{1==n.status&&l().fire("Ok!",n.message,"success")}))})()}addFile(o){var e=this;return(0,T.Z)(function*(){const{value:r}=yield l().fire({html:"<label>El archivo debe tener una lista con los codigo de usuario</label>",title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(r){e.userDataFile.rol_id=Number(o),e.userDataFile.proyecto=e.project;const n=new FileReader;n.onload=a=>{const y=P.ij(a.target.result,{type:"binary"});e.data=P.P6.sheet_to_json(y.Sheets[y.SheetNames[0]],{header:1}),e.generateJsonUsers()},n.readAsBinaryString(r)}})()}generateJsonUsers(){var o=this;return(0,T.Z)(function*(){o.userDataFile.usuarios=[],o.data.forEach(e=>{o.userDataFile.usuarios.push(e[0])}),o.userDataFile.usuarios=o.userDataFile.usuarios.filter(Boolean),o.rolService.assignGroupUsersFile(o.userDataFile).subscribe(e=>{1==e.status&&l().fire("Ok",e.message,"success")})})()}guardarJerarquias(){l().fire({title:"Guardar orden de los roles",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No"}).then(o=>{o.isConfirmed?this.projectHomeService.guardarJerarquias(this.dataSource).subscribe(e=>{1==e.status&&(this.cargarGrupos(),l().fire("Ok!","Organizacion Actualizada","success"))}):o.isDenied&&l().fire("Cambios no guardados","","info")})}cargarGrupos(){this.projectHomeService.getGroupsProject(this.project).subscribe(o=>{this.dataSource=o})}verUsuarios(o,e){this.userData.rol_id=Number(o),this.dialogService.open(mi.A,{height:"40rem",width:"50rem",data:this.userData})}verRoles(o,e){this.roleData.id=Number(o),this.roleData.nombre=e,this.rolService.getGroupsRoles(this.roleData.id).subscribe(r=>{this.roleData.roles=r,this.dialogService.open(li.a,{height:"30rem",width:"50rem",data:this.roleData})})}createGroup(){this.projectHomeService.getIdProject(this.project).subscribe(o=>{this.dialogService.open(it,{height:"22rem",width:"50rem",data:Number(o)}).afterClosed().subscribe(n=>{1===n&&this.cargarGrupos()})})}}function Mi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addUpm())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," A\xf1adir UPM "),t.qZA()}}function Ri(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo de UPM "),t.qZA()}}function Bi(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Departamento"),t.qZA())}function Qi(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.departamento)}}function Ji(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Municipio"),t.qZA())}function Hi(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.municipio)}}function Ii(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1,"UPM"),t.qZA())}function Gi(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.upm)}}function zi(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Estado"),t.qZA())}function $i(i,o){if(1&i&&(t.TgZ(0,"td",21)(1,"button",22),t._uU(2),t.qZA()()),2&i){const e=o.$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngStyle",r.getColor(e.cod_estado)),t.xp6(1),t.Oqu(e.estado)}}function Li(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Acciones"),t.qZA())}function Wi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.sustituirUpm(n.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"loop"),t.qZA()()}}function Ki(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Wi,3,0,"button",25),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","Cargado"==e.estado)}}function Vi(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.verDetalles(n.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"receipt"),t.qZA()()}}rt.\u0275fac=function(o){return new(o||rt)(t.Y36(S.l),t.Y36(L.RolService),t.Y36(v.uw))},rt.\u0275cmp=t.Xpm({type:rt,selectors:[["app-group-project"]],viewQuery:function(o,e){if(1&o&&t.Gf(_i,7),2&o){let r;t.iGM(r=t.CRH())&&(e.table=r.first)}},decls:31,vars:6,consts:[[1,"mat-elevation-z8","table_div"],[1,"orden_label"],["mat-table","","cdkDropList","","cdkDropListData","datasource",1,"table",3,"dataSource","cdkDropListDisabled","cdkDropListDropped"],["table",""],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","jerarquia","sticky",""],["matColumnDef","descripcion"],["matColumnDef","options"],[4,"matHeaderRowDef"],["cdkDrag","",3,"cdkDragData",4,"matRowDef","matRowDefColumns"],[1,"header"],["mat-flat-button","","color","accent","style","margin-right: 8px",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",3,"click"],[1,"dragCursor",3,"mousedown"],["mat-icon-button","","matTooltip","Editar","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Desactivar","color","warn","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver usuarios","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Agregar usuario","color","primary",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Cargar archivo de usuarios","color","primary",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver politicas","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Editar","color","primary",1,"iconbutton",3,"click"],["aria-label","Edit"],["mat-icon-button","","matTooltip","Desactivar","color","warn",1,"iconbutton",3,"click"],["aria-label","Delete"],["mat-icon-button","","matTooltip","Ver usuarios","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Agregar usuario","color","primary",3,"click"],["mat-icon-button","","matTooltip","Cargar archivo de usuarios","color","primary",3,"click"],["mat-icon-button","","matTooltip","Ver politicas","color","primary",1,"iconbutton",3,"click"],["cdkDrag","",3,"cdkDragData"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0),t._UZ(1,"br")(2,"br"),t.TgZ(3,"mat-label",1)(4,"strong"),t._uU(5,"Ordene los grupos de mayor a menor"),t.qZA()(),t.TgZ(6,"table",2,3),t.NdJ("cdkDropListDropped",function(n){return e.drop(n)}),t.ynx(8,4),t.YNc(9,gi,2,0,"mat-header-cell",5),t.YNc(10,fi,2,1,"mat-cell",6),t.BQk(),t.ynx(11,7),t.YNc(12,hi,2,0,"mat-header-cell",5),t.YNc(13,bi,5,1,"mat-cell",6),t.BQk(),t.ynx(14,8),t.YNc(15,Ti,2,0,"mat-header-cell",5),t.YNc(16,vi,2,1,"mat-cell",6),t.BQk(),t.ynx(17,9),t.YNc(18,Ci,2,0,"mat-header-cell",5),t.YNc(19,Zi,2,1,"mat-cell",6),t.BQk(),t.ynx(20,10),t.YNc(21,xi,2,0,"mat-header-cell",5),t.YNc(22,ki,7,12,"mat-cell",6),t.BQk(),t.YNc(23,Fi,1,0,"mat-header-row",11),t.YNc(24,Yi,1,1,"mat-row",12),t.qZA()(),t.TgZ(25,"div",13),t.YNc(26,Ei,4,0,"button",14),t.TgZ(27,"button",15),t.NdJ("click",function(){return e.guardarJerarquias()}),t.TgZ(28,"mat-icon"),t._uU(29,"save"),t.qZA(),t._uU(30," Guardar Orden de Roles "),t.qZA()()),2&o&&(t.xp6(6),t.Q6J("dataSource",e.dataSource)("cdkDropListDisabled",e.dragDisabled),t.xp6(17),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(5,Oi)))},dependencies:[p.hX,x.lW,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,d.Hw,D.gM,ut.Wj,ut.Zt,U.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:1.5rem;padding:0 .4rem;font-family:Roboto,Helvetica Neue,sans-serif}.orden_label[_ngcontent-%COMP%]{text-align:center;padding-left:2rem;color:red}.dragCursor[_ngcontent-%COMP%]{cursor:move}"]});const Xi=function(){return["reemplazar-upm"]};function tr(i,o){if(1&i&&(t.TgZ(0,"td",21),t.YNc(1,Ki,2,1,"div",23),t.TgZ(2,"div"),t.YNc(3,Vi,3,0,"button",24),t.qZA()()),2&i){const e=o.$implicit;t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(2,Xi)),t.xp6(2),t.Q6J("ngIf","Sustituido"==e.estado)}}function er(i,o){1&i&&t._UZ(0,"tr",28)}function or(i,o){1&i&&t._UZ(0,"tr",29)}function ir(i,o){if(1&i&&(t.TgZ(0,"tr",30)(1,"td",31),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(13);t.xp6(2),t.hij(' No hay resultados de "',e.value,'" ')}}const yt=function(){return["asignar-upm-proyecto"]},rr=function(){return[10,25,100]};class nt{constructor(o,e,r,n){this.formBuilder=o,this.dialog=e,this.homeProjectService=r,this.projectService=n,this.displayedColumns=["departamento","municipio","upm","estado","options"],this.data=[],this.assignment={proyecto_id:0,upms:[]},this.upmDataSust={proyecto_id:0,upm_nuevo:"",upm_anterior:0,descripcion:"",usuario_id:0},this.dataSource=new c.by,this.buildForm()}buildForm(){this.formUpms=this.formBuilder.group({file:[""]})}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o,this.cargarUpmsAsignadas()})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}cargarUpmsAsignadas(){0!=this.idProject&&this.projectService.getUpms(this.idProject).subscribe(o=>{this.dataSource=new c.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}getColor(o){for(let e=0;e<b.q.array.length;e++)if(b.q.array[e].id==Number(o))return{color:b.q.array[e].color,border:`1px solid ${b.q.array[e].color}`};return{}}addUpm(){var o=this;return(0,T.Z)(function*(){const{value:e}=yield l().fire({title:"UPM",input:"text",inputPlaceholder:"AEE001122337A2",confirmButtonText:"Agregar UPM",showCancelButton:!0,inputLabel:"Ingrese la UPM"});e&&(o.assignment.proyecto_id=o.idProject,o.assignment.upms=[e],o.projectService.assignUpmToProject(o.assignment).subscribe(r=>{1==r.status&&(o.cargarUpmsAsignadas(),l().fire("Ok!",r.message,"success"))}))})()}sustituirUpm(o){var e=this;return(0,T.Z)(function*(){e.upmDataSust.proyecto_id=e.idProject,e.upmDataSust.upm_anterior=Number(o);const{value:r}=yield l().fire({title:"Sustituir upms",html:'<span>Ingrese el upm</span><input type="text" style="width:80%;"  placeholder="AEE123456789A1" id="upm" class="swal2-input"><br><span>Ingrese el motivo de sustitucion</span><textarea id="descripcion" style="width:80%;" placeholder="No se puede acceder al lugar" class="swal2-input"></textarea>',showCancelButton:!0,cancelButtonText:"Cancelar",preConfirm:()=>[document.getElementById("upm"),document.getElementById("descripcion")]});if(r){let a=r[1].value;e.upmDataSust.upm_nuevo=r[0].value,e.upmDataSust.descripcion=a,e.upmDataSust.usuario_id=Number(localStorage.getItem("id")),e.projectService.sustituirUpm(e.upmDataSust).subscribe(s=>{1==s.status&&(e.cargarUpmsAsignadas(),l().fire("Ok!",s.message,"success"))})}})()}addFile(){var o=this;return(0,T.Z)(function*(){const{value:e}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(e){const r=new FileReader;r.onload=n=>{const s=P.ij(n.target.result,{type:"binary"});o.data=P.P6.sheet_to_json(s.Sheets[s.SheetNames[0]],{header:1}),o.generateJson()},r.readAsBinaryString(e)}})()}generateJson(){this.idProject&&(this.assignment.proyecto_id=this.idProject,this.data.forEach(o=>{this.assignment.upms.push(o.toString())})),this.assignment.upms=this.assignment.upms.filter(Boolean),console.log(this.assignment),this.projectService.assignUpmToProject(this.assignment).subscribe(o=>{1==o.status&&(this.cargarUpmsAsignadas(),l().fire("Ok!",o.message,"success"))})}verDetalles(o){Number(o)&&this.homeProjectService.verDetalleSustitucion(Number(o)).subscribe(e=>{l().fire({title:"Descripcion",html:`UPM nuevo: <b>${e.nombre}</b>, <br><span>Usuario modificador: ${e.codigo_usuario}</span> <br><span>Fecha: ${e.fecha}</span> <br><p>Motivo: ${e.descripcion}</p>`})})}}function nr(i,o){1&i&&(t.TgZ(0,"mat-tab",4),t._UZ(1,"app-group-project"),t.qZA())}function ar(i,o){1&i&&(t.TgZ(0,"mat-tab",5),t._UZ(1,"app-upms"),t.qZA())}nt.\u0275fac=function(o){return new(o||nt)(t.Y36(_.qu),t.Y36(v.uw),t.Y36(S.l),t.Y36(I.Y))},nt.\u0275cmp=t.Xpm({type:nt,selectors:[["app-upms"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:36,vars:9,consts:[[1,"container"],[1,"header"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["paginator",""],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-stroked-button","",2,"background","white",3,"ngStyle"],[4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver detalles","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Reemplazar","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Reemplazar","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Ver detalles","color","primary",1,"iconbutton",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t._UZ(0,"br")(1,"br"),t.TgZ(2,"div")(3,"div",0)(4,"div",1),t.YNc(5,Mi,4,0,"button",2),t.YNc(6,Ri,4,0,"button",2),t.qZA()()(),t._UZ(7,"br")(8,"br"),t.TgZ(9,"mat-form-field")(10,"mat-label"),t._uU(11,"Buscar"),t.qZA(),t.TgZ(12,"input",3,4),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA()(),t.TgZ(14,"div",5)(15,"table",6),t.ynx(16,7),t.YNc(17,Bi,2,0,"th",8),t.YNc(18,Qi,2,1,"td",9),t.BQk(),t.ynx(19,10),t.YNc(20,Ji,2,0,"th",8),t.YNc(21,Hi,2,1,"td",9),t.BQk(),t.ynx(22,11),t.YNc(23,Ii,2,0,"th",8),t.YNc(24,Gi,2,1,"td",9),t.BQk(),t.ynx(25,12),t.YNc(26,zi,2,0,"th",8),t.YNc(27,$i,3,2,"td",9),t.BQk(),t.ynx(28,13),t.YNc(29,Li,2,0,"th",8),t.YNc(30,tr,4,3,"td",9),t.BQk(),t.YNc(31,er,1,0,"tr",14),t.YNc(32,or,1,0,"tr",15),t.YNc(33,ir,3,1,"tr",16),t.qZA(),t._UZ(34,"mat-paginator",17,18),t.qZA()),2&o&&(t.xp6(5),t.Q6J("ngxPermissionsOnly",t.DdM(6,yt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(7,yt)),t.xp6(9),t.Q6J("dataSource",e.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(8,rr)))},dependencies:[Z.O5,Z.PC,p.KE,p.hX,m.Nt,x.lW,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,D.gM,g.YE,U.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;margin:.5rem;padding:0 .4rem;gap:1rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]});const cr=function(){return["crear-rol_proyecto"]},sr=function(){return["ver-upms"]};class at{}function lr(i,o){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Departamento"),t.qZA())}function mr(i,o){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.departamento)}}function pr(i,o){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Municipio"),t.qZA())}function ur(i,o){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.municipio)}}function dr(i,o){1&i&&(t.TgZ(0,"th",25),t._uU(1,"UPM"),t.qZA())}function _r(i,o){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.upm)}}function gr(i,o){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Supervisor"),t.qZA())}function fr(i,o){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.lnq("",e.codigo_usuario," - ",e.nombres," ",e.apellidos,"")}}function hr(i,o){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Fecha"),t.qZA())}function br(i,o){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.fecha)}}function Tr(i,o){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Estado"),t.qZA())}function vr(i,o){if(1&i&&(t.TgZ(0,"td",26)(1,"button",27),t._uU(2),t.qZA()()),2&i){const e=o.$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngStyle",r.getColor(e.cod_estado)),t.xp6(1),t.hij(" ",e.estado," ")}}function Cr(i,o){1&i&&t._UZ(0,"th",28)}function Zr(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",26)(1,"button",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.crearInforme())}),t.TgZ(2,"mat-icon",30),t._uU(3,"create_new_folder"),t.qZA()()()}}function xr(i,o){1&i&&t._UZ(0,"tr",31)}function yr(i,o){1&i&&t._UZ(0,"tr",32)}function wr(i,o){if(1&i&&(t.TgZ(0,"tr",33)(1,"td",34),t._uU(2),t.qZA()()),2&i){t.oxw();const e=t.MAs(16);t.xp6(2),t.hij('No hay resultados de "',e.value,'"')}}at.\u0275fac=function(o){return new(o||at)},at.\u0275cmp=t.Xpm({type:at,selectors:[["app-roles-upm-union"]],decls:4,vars:4,consts:[[1,"mat_tab"],["color","accent"],["label","Roles",4,"ngxPermissionsOnly"],["label","UPM",4,"ngxPermissionsOnly"],["label","Roles"],["label","UPM"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"mat-tab-group",1),t.YNc(2,nr,2,0,"mat-tab",2),t.YNc(3,ar,2,0,"mat-tab",3),t.qZA()()),2&o&&(t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(2,cr)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(3,sr)))},dependencies:[Zt.uX,Zt.SP,U.gE,rt,nt],styles:[".mat_tab[_ngcontent-%COMP%]{margin:1.5rem;border:1px groove}"]});const Ur=function(){return[10,25,100]};class ct{constructor(o,e,r,n){this.formBuilder=o,this.dialog=e,this.homeProjectService=r,this.projectService=n,this.displayedColumns=["departamento","municipio","upm","supervisor","estado","fecha","options"],this.data=[],this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new c.by}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o,this.chargueUpmFinished()})}chargueUpmFinished(){0!=this.idProject&&this.projectService.getUpmsFinished({proyecto_id:this.idProject}).subscribe(o=>{console.log(o),this.dataSource=new c.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getColor(o){for(let e=0;e<b.q.array.length;e++)if(b.q.array[e].id==Number(o))return{color:b.q.array[e].color,border:`1px solid ${b.q.array[e].color}`};return{}}crearInforme(){}}ct.\u0275fac=function(o){return new(o||ct)(t.Y36(_.qu),t.Y36(v.uw),t.Y36(S.l),t.Y36(I.Y))},ct.\u0275cmp=t.Xpm({type:ct,selectors:[["app-office-work"]],viewQuery:function(o,e){if(1&o&&(t.Gf(h.NW,5),t.Gf(g.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(e.paginator=r.first),t.iGM(r=t.CRH())&&(e.sort=r.first)}},decls:46,vars:9,consts:[[1,"mat_tab"],[1,"grid-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6-12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","supervisor"],["matColumnDef","fecha"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Click para Crear Informe","matTooltipPosition","right","color","primary",1,"iconbutton",3,"click"],["aria-label","Create"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,e){1&o&&(t._UZ(0,"br"),t.TgZ(1,"div",0)(2,"div",1)(3,"div")(4,"div",2)(5,"div",3)(6,"h2"),t._uU(7,"\xc1rea de Informes"),t.qZA()(),t._UZ(8,"div",4),t.qZA(),t._UZ(9,"br")(10,"br")(11,"br"),t.TgZ(12,"mat-form-field",5)(13,"mat-label"),t._uU(14,"Buscar"),t.qZA(),t.TgZ(15,"input",6,7),t.NdJ("keyup",function(n){return e.applyFilter(n)}),t.qZA(),t.TgZ(17,"mat-icon",8),t._uU(18,"search"),t.qZA()(),t.TgZ(19,"div",9)(20,"table",10),t.ynx(21,11),t.YNc(22,lr,2,0,"th",12),t.YNc(23,mr,2,1,"td",13),t.BQk(),t.ynx(24,14),t.YNc(25,pr,2,0,"th",12),t.YNc(26,ur,2,1,"td",13),t.BQk(),t.ynx(27,15),t.YNc(28,dr,2,0,"th",12),t.YNc(29,_r,2,1,"td",13),t.BQk(),t.ynx(30,16),t.YNc(31,gr,2,0,"th",12),t.YNc(32,fr,2,3,"td",13),t.BQk(),t.ynx(33,17),t.YNc(34,hr,2,0,"th",12),t.YNc(35,br,2,1,"td",13),t.BQk(),t.ynx(36,18),t.YNc(37,Tr,2,0,"th",12),t.YNc(38,vr,3,2,"td",13),t.BQk(),t.ynx(39,19),t.YNc(40,Cr,1,0,"th",20),t.YNc(41,Zr,4,0,"td",13),t.BQk(),t.YNc(42,xr,1,0,"tr",21),t.YNc(43,yr,1,0,"tr",22),t.YNc(44,wr,3,1,"tr",23),t.qZA(),t._UZ(45,"mat-paginator",24),t.qZA()()()()),2&o&&(t.xp6(12),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",e.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(8,Ur)))},dependencies:[Z.PC,p.KE,p.hX,p.R9,m.Nt,x.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,d.Hw,h.NW,D.gM,g.YE,g.nU]});const Ar=[{path:"",component:Q},{path:"assignPersonal",component:X,canActivate:[U.DD],data:{permissions:{only:["asignar-personal"],redirectTo:"projectHome"}}},{path:"assignUpmChief",component:et,canActivate:[U.DD],data:{permissions:{only:["asignar-upms-personal"],redirectTo:"projectHome"}}},{path:"cartografo",component:tt,canActivate:[U.DD],data:{permissions:{only:["ver-upms-cartografo"],redirectTo:"projectHome"}}},{path:"equipo-campo",component:B},{path:"supervisores",component:H},{path:"assignUserSupervisor",component:O,canActivate:[U.DD],data:{permissions:{only:["asignar-usuario-supervisor"],redirectTo:"projectHome"}}},{path:"reportDashboard/:id",component:ot},{path:"configuracion",component:at},{path:"informes",component:ct}];class M{}M.\u0275fac=function(o){return new(o||M)},M.\u0275mod=t.oAB({type:M}),M.\u0275inj=t.cJS({imports:[K.Bz.forChild(Ar),K.Bz]});var Pr=u(4320),Sr=u(6338);class G{}G.\u0275fac=function(o){return new(o||G)},G.\u0275mod=t.oAB({type:G}),G.\u0275inj=t.cJS({imports:[Z.ez,M,Pr.M,ut._t,d.Ps,D.AV,pt.LD,Sr.ie,_.UX,U.VI]})},4327:function(dt,st){var u,h;void 0!==(h="function"==typeof(u=function(){"use strict";function c(m,d,A){var f=new XMLHttpRequest;f.open("GET",m),f.responseType="blob",f.onload=function(){p(f.response,d,A)},f.onerror=function(){console.error("could not download file")},f.send()}function t(m){var d=new XMLHttpRequest;d.open("HEAD",m,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function q(m){try{m.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),m.dispatchEvent(d)}}var C="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,_=C.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=C.saveAs||("object"!=typeof window||window!==C?function(){}:"download"in HTMLAnchorElement.prototype&&!_?function(m,d,A){var f=C.URL||C.webkitURL,w=document.createElement("a");w.download=d=d||m.name||"download",w.rel="noopener","string"==typeof m?(w.href=m,w.origin===location.origin?q(w):t(w.href)?c(m,d,A):q(w,w.target="_blank")):(w.href=f.createObjectURL(m),setTimeout(function(){f.revokeObjectURL(w.href)},4e4),setTimeout(function(){q(w)},0))}:"msSaveOrOpenBlob"in navigator?function(m,d,A){if(d=d||m.name||"download","string"!=typeof m)navigator.msSaveOrOpenBlob(function g(m,d){return typeof d>"u"?d={autoBom:!1}:"object"!=typeof d&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(m.type)?new Blob(["\ufeff",m],{type:m.type}):m}(m,A),d);else if(t(m))c(m,d,A);else{var f=document.createElement("a");f.href=m,f.target="_blank",setTimeout(function(){q(f)})}}:function(m,d,A,f){if((f=f||open("","_blank"))&&(f.document.title=f.document.body.innerText="downloading..."),"string"==typeof m)return c(m,d,A);var w="application/octet-stream"===m.type,_t=/constructor/i.test(C.HTMLElement)||C.safari,lt=/CriOS\/[\d]+/.test(navigator.userAgent);if((lt||w&&_t||_)&&typeof FileReader<"u"){var z=new FileReader;z.onloadend=function(){var k=z.result;k=lt?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=k:location=k,f=null},z.readAsDataURL(m)}else{var mt=C.URL||C.webkitURL,$=mt.createObjectURL(m);f?f.location=$:location.href=$,f=null,setTimeout(function(){mt.revokeObjectURL($)},4e4)}});C.saveAs=p.saveAs=p,dt.exports=p})?u.apply(st,[]):u)&&(dt.exports=h)}}]);