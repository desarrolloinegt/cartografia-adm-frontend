(self.webpackChunkcartografia_app=self.webpackChunkcartografia_app||[]).push([[121],{1121:(rt,tt,u)=>{"use strict";u.r(tt),u.d(tt,{DialogSupervisorAssignUserComponent:()=>M,FieldTeamDialogComponent:()=>k,FieldTeamPageComponent:()=>Y,HomeProjectPageComponent:()=>R,NewFieldTeamPageComponent:()=>G,ProjecHometModule:()=>Q,ProjectRoutingModule:()=>O,SupervisorComponent:()=>J});var C=u(7274),v=u(8739),f=u(6308),s=u(671),t=u(4650),N=u(8443);class b{constructor(e){this.apiService=e}getFieldTeam(e){return this.apiService.store("equipos",e)}createFieldTeam(e){return this.apiService.store("equipo",e)}editFieldTeam(e){return this.apiService.patch("equipo/edit",e)}desactiveFielTeam(e){return this.apiService.desactive("vehiculo",e)}getUsersTeam(e){return this.apiService.store("miembrosEquipo",e)}getVehicles(){return this.apiService.getAll("vehiculos")}addTeam(e){return this.apiService.store("addEquipo",e)}addVehicule(e){return this.apiService.patch("addVehiculo",e)}modifyVehicle(e){return this.apiService.patch("equipoVehicle/edit",e)}}b.\u0275fac=function(e){return new(e||b)(t.LFG(N.s))},b.\u0275prov=t.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"});var d=u(4006),_=u(9549),m=u(4144),p=u(7392);function A(i,e){1&i&&(t.TgZ(0,"th",22),t._uU(1,"Codigo de usuario"),t.qZA())}function g(i,e){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.codigo_usuario," ")}}function Z(i,e){1&i&&(t.TgZ(0,"th",22),t._uU(1,"Nombres"),t.qZA())}function at(i,e){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.nombres," ")}}function et(i,e){1&i&&(t.TgZ(0,"th",22),t._uU(1,"Apellidos"),t.qZA())}function B(i,e){if(1&i&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.apellidos," ")}}function ot(i,e){1&i&&t._UZ(0,"th",22)}function H(i,e){1&i&&t._UZ(0,"td",23)}function F(i,e){1&i&&t._UZ(0,"tr",24)}function ht(i,e){1&i&&t._UZ(0,"tr",25)}function bt(i,e){if(1&i&&(t.TgZ(0,"tr",26)(1,"td",27),t._uU(2),t.qZA()()),2&i){t.oxw();const o=t.MAs(13);t.xp6(2),t.hij(' No hay resultados de "',o.value,'" ')}}const vt=function(){return[5,10,25,100]};class k{constructor(e,o,n,r){this.fieldTeamService=e,this.dialogRef=o,this.data=n,this.formBuilder=r,this.displayedColumns=["codigo_usuario","nombres","apellidos","options"],this.dataSource=new s.by,this.chargetUsers()}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}ngOnInit(){}chargetUsers(){this.fieldTeamService.getUsersTeam({proyecto_id:this.data.proyecto_id,supervisor:this.data.supervisor}).subscribe(e=>{this.dataSource=new s.by(e),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}}k.\u0275fac=function(e){return new(e||k)(t.Y36(b),t.Y36(C.so),t.Y36(C.WI),t.Y36(d.qu))},k.\u0275cmp=t.Xpm({type:k,selectors:[["app-field-team-dialog"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:35,vars:9,consts:[[1,"title"],["mat-dialog-title",""],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevatioin-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","codigo_usuario"],["mat-header-cell","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","nombres"],["matColumnDef","apellidos"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell","",1,"cell-pointer"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2,"Miembros"),t.qZA(),t._UZ(3,"br")(4,"br"),t.qZA(),t.TgZ(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t._uU(11,"Buscar"),t.qZA(),t.TgZ(12,"input",7,8),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA(),t.TgZ(14,"mat-icon",9),t._uU(15,"search"),t.qZA()()()(),t.TgZ(16,"div",10)(17,"table",11),t.ynx(18,12),t.YNc(19,A,2,0,"th",13),t.YNc(20,g,2,1,"td",14),t.BQk(),t.ynx(21,15),t.YNc(22,Z,2,0,"th",13),t.YNc(23,at,2,1,"td",14),t.BQk(),t.ynx(24,16),t.YNc(25,et,2,0,"th",13),t.YNc(26,B,2,1,"td",14),t.BQk(),t.ynx(27,17),t.YNc(28,ot,1,0,"th",13),t.YNc(29,H,1,0,"td",14),t.BQk(),t.YNc(30,F,1,0,"tr",18),t.YNc(31,ht,1,0,"tr",19),t.YNc(32,bt,3,1,"tr",20),t.qZA(),t._UZ(33,"br")(34,"mat-paginator",21),t.qZA()()()),2&e&&(t.xp6(9),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",o.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(8,vt)))},dependencies:[_.KE,_.hX,_.R9,m.Nt,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,f.YE],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}"]});var h=u(5861),Tt=u(5226),l=u.n(Tt),P=u(574),I=u(9155);class w{constructor(e){this.apiService=e}getGroupsProject(e){return this.apiService.getById("obtenerRolesProyecto",e)}guardarJerarquias(e){return this.apiService.patch("jerarquias",e)}getIdProject(e){return this.apiService.getById("proyectoId",e)}assignChiefUpms(e){return this.apiService.store("asignarUpmPersonal",e)}chargeUpmsChief(e){return this.apiService.store("obtenerUpmPersonal",e)}getUpmsAssgined(e){return this.apiService.store("obtenerUpmsAsignados",e)}getChiefEmployee(e){return this.apiService.store("obtenerEncargadoEmpleado",e)}getUsersAssigned(e){return this.apiService.store("obtenerPersonalAsignado",e)}deleteAssingmentUsers(e){return this.apiService.patch("eliminarAsignacionPersonal",e)}assignPersonal(e){return this.apiService.store("asignarPersonal",e)}verDetalleSustitucion(e){return this.apiService.getById("detalleSustitucion",e)}supervisor(e){return this.apiService.store("detalleSupervisor",e)}cartografo(e){return this.apiService.store("detalleCartografo",e)}fieldTeam(e){return this.apiService.store("detalleFieldTeam",e)}initActualization(e){return this.apiService.patch("iniciarActualizacion",e)}finishActualization(e){return this.apiService.patch("finalizarActualizacion",e)}}w.\u0275fac=function(e){return new(e||w)(t.LFG(N.s))},w.\u0275prov=t.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"});var xt=u(4327);class j{constructor(){}exportAsExcelFile(e,o){const r={Sheets:{data:P.P6.json_to_sheet(e)},SheetNames:["data"]},a=P.cW(r,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(a,o)}saveAsExcelFile(e,o){const n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});xt.saveAs(n,o+"_export_"+(new Date).getTime()+".xlsx")}}j.\u0275fac=function(e){return new(e||j)},j.\u0275prov=t.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"});var U=u(6895),x=u(4859),it=u(4385),st=u(3238),D=u(266),y=u(4954);function yt(i,e){if(1&i&&(t.TgZ(0,"mat-option",31),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.id+","+o.nombre),t.xp6(1),t.hij(" ",o.nombre," ")}}function wt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(),a=t.MAs(11);return t.KtG(r.getUsers(a.value))}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_downward"),t.qZA(),t._uU(3," Descargar Plantilla "),t.qZA()}if(2&i){t.oxw();const o=t.MAs(11);t.Q6J("disabled",!o.value)}}function Ut(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo "),t.qZA()}}function At(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.addTeam())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Crear Equipo de Campo "),t.qZA()}}function Pt(i,e){1&i&&(t.TgZ(0,"th",34),t._uU(1,"Supervisor"),t.qZA())}function St(i,e){if(1&i&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.lnq(" ",o.codigo_usuario," ",o.nombres," ",o.apellidos," ")}}function qt(i,e){1&i&&(t.TgZ(0,"th",34),t._uU(1,"Vehiculo"),t.qZA())}function Nt(i,e){if(1&i&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.AsE(" ",o.modelo," ",o.placa," ")}}function jt(i,e){1&i&&(t.TgZ(0,"th",34),t._uU(1,"Descripcion"),t.qZA())}function Dt(i,e){if(1&i&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.descripcion," ")}}function Ft(i,e){1&i&&(t.TgZ(0,"th",34),t._uU(1,"Acciones"),t.qZA())}function Et(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.editTeam(r.id,r.descripcion))}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function Mt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.seeTeam(r.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"people_outline"),t.qZA()()}}function Ot(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.modifyVehicle(r.id,r.placa))}),t.TgZ(1,"mat-icon"),t._uU(2,"cached"),t.qZA()()}}function kt(i,e){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Ot,3,0,"button",41),t.qZA()),2&i){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",o.placa)}}function Yt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",44),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.addVehicle(r.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"directions_car"),t.qZA()()}}function Rt(i,e){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Yt,3,0,"button",43),t.qZA()),2&i){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!o.placa)}}const Jt=function(){return["editar-equipo-campo"]},Qt=function(){return["ver-usuarios-equipo-campo"]},ut=function(){return["agregar-vehiculo-equipo-campo"]};function Bt(i,e){1&i&&(t.TgZ(0,"td",35),t.YNc(1,Et,3,0,"button",36),t.YNc(2,Mt,3,0,"button",37),t.YNc(3,kt,2,1,"div",38),t.YNc(4,Rt,2,1,"div",38),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(4,Jt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(5,Qt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(6,ut)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(7,ut)))}function Ht(i,e){1&i&&t._UZ(0,"tr",45)}function It(i,e){1&i&&t._UZ(0,"tr",46)}function Gt(i,e){if(1&i&&(t.TgZ(0,"tr",47)(1,"td",48),t._uU(2),t.qZA()()),2&i){t.oxw();const o=t.MAs(35);t.xp6(2),t.hij(' No hay resultados de "',o.value,'" ')}}const zt=function(){return["descargar-plantilla"]},mt=function(){return["crear-equipo-campo"]},$t=function(){return[5,10,25,100]};class Y{constructor(e,o,n,r,a,c){this.formBuilder=e,this.dialogService=o,this.fieldService=n,this.rolService=r,this.projectHomeService=a,this.excelService=c,this.data=[[1,2],[3,4]],this.displayedColumns=["supervisor","vehiculo","descripcion","options"],this.roles=[],this.idProject=0,this.fieldTeamData={id:0,equipo:"",supervisor:"",vehiculo:"",placa:"",modelo:""},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:T=>{T.addEventListener("mouseenter",l().stopTimer),T.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by,this.buildForm()}ngOnInit(){let e=localStorage.getItem("id");Number(e)&&this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o,this.getGroupsMinor()}),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o}),this.cargarEquipo()}buildForm(){this.formFieldTeams=this.formBuilder.group({file:[""]})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var e=this;return(0,h.Z)(function*(){e.rolService.getGroupsMinor({proyecto_id:e.idProject}).subscribe(o=>{e.roles=o})})()}addTeam(){var e=this;return(0,h.Z)(function*(){const{value:o}=yield l().fire({title:"A\xf1adir equipo",html:'<span>Ingrese el codigo de usuario</span><input type="text" style="width:80%;"  placeholder="1234" id="user" class="swal2-input"><br><span>Ingrese la placa del vehiculo (opcional)</span><input id="placa" style="width:80%;" value="" placeholder="M123ABC" class="swal2-input">',showCancelButton:!0,cancelButtonText:"Cancelar",preConfirm:()=>[document.getElementById("user"),document.getElementById("placa")]});if(o){let n=o[0].value;n&&e.fieldService.addTeam({codigo_usuario:n,placa:o[1].value,proyecto_id:e.idProject}).subscribe(c=>{c.status&&(e.Toast.fire({icon:"success",title:c.message}),e.cargarEquipo())})}})()}cargarEquipo(){let e=localStorage.getItem("project");this.fieldService.getFieldTeam({proyecto:e}).subscribe(o=>{this.dataSource=new s.by(o),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}seeTeam(e){this.dialogService.open(k,{height:"40rem",width:"50rem",data:{proyecto_id:this.idProject,supervisor:Number(e)}})}seeExample(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploEquipo.PNG",imageWidth:415,imageHeight:260,imageAlt:"Ejemplo del archivo de carga"})}addFile(){var e=this;return(0,h.Z)(function*(){const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const n=new FileReader;n.onload=r=>{const c=P.ij(r.target.result,{type:"binary"});e.data=P.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),e.generateJson()},n.readAsBinaryString(o)}})()}generateJson(){var e=this;return(0,h.Z)(function*(){let o=[],n=[];e.data.forEach(r=>{r[2]&&o.push({placa:r[0],descripcion:r[1],codigo_supervisor:r[2],proyecto_id:e.idProject})}),o.shift(),o=o.filter(Boolean);for(let r=0;r<o.length;r++)for(let a=r+1;a<o.length;a++)null!=o[r]&&o[r].codigo_supervisor==o[a].codigo_supervisor&&o[r].placa==o[a].placa&&n.push(o[r].placa,o[r].codigo_supervisor);for(let r=0;r<o.length;r++)for(let a=r+1;a<o.length;a++)null!=o[r].placa&&o[r].placa==o[a].placa&&n.push(o[r].placa);for(let r=0;r<o.length;r++)o[r].placa||(o[r].placa=""),o[r].descripcion||(o[r].descripcion="");n.length>0?e.Toast.fire({icon:"error",title:"Hay filas repetidas: "+n}):e.fieldService.createFieldTeam(o).subscribe(r=>{1==r.status&&(e.Toast.fire({icon:"success",title:r.message}),e.cargarEquipo())})})()}getUsers(e){let o=Number(localStorage.getItem("id")),n=e.split(","),r=[],a=[];this.projectHomeService.getUsersAssigned({rol_id:Number(n[0]),proyecto_id:this.idProject,usuario_id:o}).subscribe(c=>{a=c,a.forEach(T=>{r.push({encargado:"",codigo_usuario:T.codigo_usuario,nombres:T.nombres,apellidos:T.apellidos})}),this.createFile(n[1],r)})}createFile(e,o){let n=[],r=[];this.fieldService.getVehicles().subscribe(a=>{r=a;for(let c=0;c<r.length;c++)n.push({placa:r[c].placa,descripcion:"",codigo_usuario:"",nombres:"",apellidos:""});for(let c=0;c<o.length;c++)n.push({placa:"",codigo_usuario:o[c].codigo_usuario,descripcion:"",nombres:o[c].nombres,apellidos:o[c].apellidos});this.excelService.exportAsExcelFile(n,"Equipo Campo "+e)})}modifyVehicle(e,o){var n=this;return(0,h.Z)(function*(){const{value:r}=yield l().fire({title:"Sustituir vehiculo",input:"text",inputPlaceholder:"M987ABC",confirmButtonText:"Reemplazar vehiculo",showCancelButton:!0,inputLabel:"Ingrese la placa del nuevo vehiculo"});if(r){let a={proyecto_id:n.idProject,usuario_id:Number(e),placa_nueva:r,placa_anterior:o};n.fieldService.modifyVehicle(a).subscribe(c=>{1==c.status&&(n.Toast.fire({icon:"success",title:c.message}),n.cargarEquipo())})}})()}addVehicle(e){var o=this;return(0,h.Z)(function*(){const{value:n}=yield l().fire({title:"Asignar vehiculo",input:"text",inputPlaceholder:"M987ABC",confirmButtonText:"Asignar vehiculo",showCancelButton:!0,inputLabel:"Ingrese la placa del  vehiculo"});if(n){let r={proyecto_id:o.idProject,usuario_id:Number(e),placa:n};o.fieldService.addVehicule(r).subscribe(a=>{1==a.status&&(o.Toast.fire({icon:"success",title:a.message}),o.cargarEquipo())})}})()}editTeam(e,o){var n=this;return(0,h.Z)(function*(){o||(o="");const{value:r}=yield l().fire({title:"Editar equipo",input:"text",inputValue:o,inputPlaceholder:"Equipo encargado de Zona 1",confirmButtonText:"Modificar descripcion",showCancelButton:!0,cancelButtonText:"Cancelar",inputLabel:"Ingrese la descripcion del equipo"});let a={proyecto_id:n.idProject,usuario_id:Number(e),descripcion:r};r&&n.fieldService.editFieldTeam(a).subscribe(c=>{1==c.status&&(n.Toast.fire({icon:"success",title:c.message}),n.cargarEquipo())})})()}}function Lt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Equipo de Campo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function Kt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Supervisor de Equipo de Campo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function Vt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Nombre del vehiculo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function Xt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Placa del vehiculo es "),t.TgZ(2,"strong"),t._uU(3,"requerida"),t.qZA()())}function Wt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Placa debe tener la siguiente secuencia: "),t.TgZ(2,"strong"),t._uU(3,"A123ABC"),t.qZA()())}function te(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Modelo del vehiculo es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function ee(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.createFieldTeam())}),t._uU(1," Guardar Vehiculo "),t.qZA()}if(2&i){const o=t.oxw();t.Q6J("disabled",!o.fieldTeamForm.valid)}}function oe(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.cancelAdd())}),t._uU(1," Cancelar "),t.qZA()}}Y.\u0275fac=function(e){return new(e||Y)(t.Y36(d.qu),t.Y36(C.uw),t.Y36(b),t.Y36(I.RolService),t.Y36(w),t.Y36(j))},Y.\u0275cmp=t.Xpm({type:Y,selectors:[["app-field-team-page"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:57,vars:18,consts:[[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","accent",3,"disabled","click",4,"ngxPermissionsOnly"],[1,"container_options"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent","style","margin-right: 8px",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevatioin-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","supervisor"],["mat-header-cell","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","vehiculo"],["matColumnDef","descripcion"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell",""],["mat-cell","",1,"cell-pointer"],["mat-icon-button","","matTooltip","Editar descripcion","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver miebros de equipo","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],[4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Editar descripcion","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Ver miebros de equipo","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Cambiar Vehiculo","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Cambiar Vehiculo","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Asignar Vehiculo","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Asignar Vehiculo","color","primary",1,"iconbutton",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Equipos de campo"),t.qZA()(),t._UZ(3,"br")(4,"br"),t.TgZ(5,"div",1)(6,"div",2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Seleccione un Rol"),t.qZA(),t.TgZ(10,"mat-select",null,4),t.YNc(12,yt,2,2,"mat-option",5),t.qZA()(),t.TgZ(13,"div"),t.YNc(14,wt,4,1,"button",6),t.qZA()(),t.TgZ(15,"div",7)(16,"div"),t.YNc(17,Ut,4,0,"button",8),t.qZA(),t.TgZ(18,"div"),t.YNc(19,At,4,0,"button",9),t.qZA(),t.TgZ(20,"div")(21,"button",10),t.NdJ("click",function(){return o.seeExample()}),t.TgZ(22,"mat-icon"),t._uU(23,"remove_red_eye"),t.qZA(),t._uU(24," Ver ejemplo de archivo de carga "),t.qZA()()()(),t._UZ(25,"br")(26,"br"),t.TgZ(27,"div",11)(28,"div",12)(29,"div",13)(30,"div",14)(31,"mat-form-field",15)(32,"mat-label"),t._uU(33,"Buscar"),t.qZA(),t.TgZ(34,"input",16,17),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA(),t.TgZ(36,"mat-icon",18),t._uU(37,"search"),t.qZA()()()(),t.TgZ(38,"div",19)(39,"table",20),t.ynx(40,21),t.YNc(41,Pt,2,0,"th",22),t.YNc(42,St,2,3,"td",23),t.BQk(),t.ynx(43,24),t.YNc(44,qt,2,0,"th",22),t.YNc(45,Nt,2,2,"td",23),t.BQk(),t.ynx(46,25),t.YNc(47,jt,2,0,"th",22),t.YNc(48,Dt,2,1,"td",23),t.BQk(),t.ynx(49,26),t.YNc(50,Ft,2,0,"th",22),t.YNc(51,Bt,5,8,"td",23),t.BQk(),t.YNc(52,Ht,1,0,"tr",27),t.YNc(53,It,1,0,"tr",28),t.YNc(54,Gt,3,1,"tr",29),t.qZA(),t._UZ(55,"br")(56,"mat-paginator",30),t.qZA()()()),2&e&&(t.xp6(8),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngForOf",o.roles),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(14,zt)),t.xp6(3),t.Q6J("ngxPermissionsOnly",t.DdM(15,mt)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(16,mt)),t.xp6(12),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",o.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(17,$t)))},dependencies:[U.sg,U.O5,_.KE,_.hX,_.R9,m.Nt,x.lW,x.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,it.gD,st.ey,D.gM,f.YE,y.gE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;margin:0 3rem;display:flex}"]});const pt=function(){return["crear-equipo"]};class G{constructor(e,o,n){this.fieldTeamService=e,this.formBuilder=o,this.dialogRef=n,this.buildForm()}buildForm(){this.fieldTeamForm=this.formBuilder.group({equipo:["",d.kI.required],supervisor:["",d.kI.required],vehiculo:["",d.kI.required],placa:["",[d.kI.required,d.kI.pattern(/^[A-Z]{1}([0-9]){3}[A-Z]{3}$/)]],modelo:["",d.kI.required]})}get equipo(){return this.fieldTeamForm.get("equipo")}get supervisor(){return this.fieldTeamForm.get("supervisor")}get vehiculo(){return this.fieldTeamForm.get("vehiculo")}get placa(){return this.fieldTeamForm.get("placa")}get modelo(){return this.fieldTeamForm.get("modelo")}submit(){}createFieldTeam(){this.fieldTeamForm.valid&&this.fieldTeamService.createFieldTeam(this.fieldTeamForm.value).subscribe(e=>{1==e.status&&(l().fire("Ok!",e.message,"success"),this.dialogRef.close(1))},e=>{console.log(e)})}cancelAdd(){this.dialogRef.close()}}G.\u0275fac=function(e){return new(e||G)(t.Y36(b),t.Y36(d.qu),t.Y36(C.so))},G.\u0275cmp=t.Xpm({type:G,selectors:[["app-new-field-team-page"]],decls:38,vars:21,consts:[[1,"card"],[1,"card-body"],[3,"formGroup","submit"],[1,"form-group"],["appearance","outline",1,"full-width-input"],["type","text","formControlName","equipo","matInput","","placeholder","...","required","",1,"form-control"],[4,"ngIf"],["type","text","formControlName","supervisor","matInput","","placeholder","Juan P\xe9rez","required","",1,"form-control"],["type","text","formControlName","vehiculo","matInput","","placeholder","Carro, Cami\xf3n, Pickup","required","",1,"form-control"],["type","text","formControlName","placa","matInput","","placeholder","P216FMV","required","",1,"form-control"],["type","text","formControlName","modelo","placeholder","BMW X5","matInput","","required","",1,"form-control"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click",4,"ngxPermissionsOnly"],["type","submit","mat-stroked-button","","color","warn",3,"click",4,"ngxPermissionsOnly"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","submit","mat-stroked-button","","color","warn",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("submit",function(){return o.submit()}),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Ingrese Equipo de Campo"),t.qZA(),t._UZ(7,"input",5),t.YNc(8,Lt,4,0,"mat-error",6),t.qZA()(),t.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),t._uU(12,"Ingrese Supervisor"),t.qZA(),t._UZ(13,"input",7),t.YNc(14,Kt,4,0,"mat-error",6),t.qZA()(),t.TgZ(15,"div",3)(16,"mat-form-field",4)(17,"mat-label"),t._uU(18,"Ingrese el Nombre del Vehiculo"),t.qZA(),t._UZ(19,"input",8),t.YNc(20,Vt,4,0,"mat-error",6),t.qZA()(),t.TgZ(21,"div",3)(22,"mat-form-field",4)(23,"mat-label"),t._uU(24,"Ingrese la Placa del Vehiculo"),t.qZA(),t._UZ(25,"input",9),t.YNc(26,Xt,4,0,"mat-error",6),t.YNc(27,Wt,4,0,"mat-error",6),t.qZA()(),t.TgZ(28,"div",3)(29,"mat-form-field",4)(30,"mat-label"),t._uU(31,"Ingrese el Modelo del Vehiculo"),t.qZA(),t._UZ(32,"input",10),t.YNc(33,te,4,0,"mat-error",6),t.qZA()(),t.TgZ(34,"div",3),t.YNc(35,ee,2,1,"button",11),t._UZ(36,"br"),t.YNc(37,oe,2,0,"button",12),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("formGroup",o.fieldTeamForm),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==o.equipo?null:o.equipo.touched)&&(null==o.equipo?null:o.equipo.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==o.supervisor?null:o.supervisor.touched)&&(null==o.supervisor?null:o.supervisor.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==o.vehiculo?null:o.vehiculo.touched)&&(null==o.vehiculo?null:o.vehiculo.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==o.placa?null:o.placa.touched)&&(null==o.placa?null:o.placa.hasError("required"))),t.xp6(1),t.Q6J("ngIf",(null==o.placa?null:o.placa.touched)&&(null==o.placa?null:o.placa.hasError("pattern"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==o.modelo?null:o.modelo.touched)&&(null==o.modelo?null:o.modelo.hasError("required"))),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(19,pt)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(20,pt)))},dependencies:[U.O5,_.KE,_.hX,_.TO,m.Nt,x.lW,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.sg,d.u,y.gE]});var ct=u(9132),ie=u(1572),dt=u(3848),nt=u(1206),ne=u(3204),re=u(7293),ae=u(7941),z=u(8049);function se(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Nombre de rol es "),t.TgZ(2,"strong"),t._uU(3,"requerido"),t.qZA()())}function ce(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.createGroup())}),t._uU(1," Guardar Rol "),t.qZA()}if(2&i){const o=t.oxw();t.Q6J("disabled",!o.groupForm.valid)}}const le=function(){return["crear-grupo"]};class ${constructor(e,o,n,r,a){this.rolService=e,this.data=o,this.projectService=n,this.formBuilder=r,this.dialogRef=a,this.buildForm()}buildForm(){this.groupForm=this.formBuilder.group({nombre:["",d.kI.required],descripcion:[""],proyecto_id:[this.data,[d.kI.required]]})}get Nombre(){return this.groupForm.get("nombre")}get Descripcion(){return this.groupForm.get("descripcion")}get ProyectoId(){return this.groupForm.get("proyecto_id")}get Jerarquia(){return this.groupForm.get("jerarquia")}submit(){}createGroup(){this.groupForm.valid&&this.rolService.create(this.groupForm.value).subscribe(e=>{1==e.status&&(l().fire("Ok!",e.message,"success"),this.dialogRef.close(1))})}cancelAdd(){this.dialogRef.close()}}$.\u0275fac=function(e){return new(e||$)(t.Y36(I.RolService),t.Y36(C.WI),t.Y36(z.Y),t.Y36(d.qu),t.Y36(C.so))},$.\u0275cmp=t.Xpm({type:$,selectors:[["app-new-group-project"]],decls:19,vars:8,consts:[[1,"card"],[1,"card-body"],[3,"formGroup","submit"],[1,"form-group"],["appearance","outline",1,"full-width-input"],["type","text","formControlName","nombre","matInput","","placeholder","Supervisores ENEI","required","",1,"form-control"],[4,"ngIf"],["type","text","formControlName","descripcion","placeholder","Grupo 2026","matInput","",1,"form-control"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click",4,"ngxPermissionsOnly"],["type","submit","mat-stroked-button","","color","warn",3,"click"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("submit",function(){return o.submit()}),t.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Ingrese el Nombre del Rol"),t.qZA(),t._UZ(7,"input",5),t.YNc(8,se,4,0,"mat-error",6),t.qZA()(),t.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),t._uU(12,"Descripcion(Opcional)"),t.qZA(),t._UZ(13,"input",7),t.qZA()(),t.TgZ(14,"div",3),t.YNc(15,ce,2,1,"button",8),t._UZ(16,"br"),t.TgZ(17,"button",9),t.NdJ("click",function(){return o.cancelAdd()}),t._uU(18," Cancelar "),t.qZA()()()()()),2&e&&(t.xp6(2),t.Q6J("formGroup",o.groupForm),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(3),t.Q6J("ngIf",(null==o.Nombre?null:o.Nombre.touched)&&(null==o.Nombre?null:o.Nombre.hasError("required"))),t.xp6(3),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngxPermissionsOnly",t.DdM(7,le)))},dependencies:[U.O5,_.KE,_.hX,_.TO,m.Nt,x.lW,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.sg,d.u,y.gE],styles:[".full-width-input[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%;max-width:98%;margin:0 auto;display:flex}.example-section[_ngcontent-%COMP%]{max-width:98%;margin:0 auto;display:flex}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.card[_ngcontent-%COMP%]{padding:3rem}"]});const ue=["table"];function me(i,e){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"ID"),t.qZA())}function pe(i,e){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.id)}}function de(i,e){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Nombre"),t.qZA())}function _e(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"mat-cell")(1,"mat-icon",16),t.NdJ("mousedown",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.dragDisabled=!1)}),t._uU(2,"reorder"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&i){const o=e.$implicit;t.xp6(4),t.Oqu(o.nombre)}}function ge(i,e){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Orden"),t.qZA())}function fe(i,e){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.jerarquia)}}function he(i,e){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Descripcion"),t.qZA())}function be(i,e){if(1&i&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.descripcion)}}function ve(i,e){1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Acciones"),t.qZA())}function Te(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.editar(r.id,r.nombre,r.descripcion,r.proyecto_id))}),t.TgZ(1,"mat-icon",24),t._uU(2,"edit"),t.qZA()()}}function xe(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.desactivar(r.id,r.nombre))}),t.TgZ(1,"mat-icon",26),t._uU(2,"delete"),t.qZA()()}}function Ce(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.verUsuarios(r.id,r.nombre))}),t.TgZ(1,"mat-icon"),t._uU(2,"supervised_user_circle"),t.qZA()()}}function Ze(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addUser(r.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function ye(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addFile(r.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA()()}}function we(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.verRoles(r.id,r.nombre))}),t.TgZ(1,"mat-icon"),t._uU(2,"list_alt"),t.qZA()()}}const Ue=function(){return["editar-rol-proyecto"]},Ae=function(){return["desactivar-rol-proyecto"]},Pe=function(){return["ver-usuario-rol-proyecto"]},_t=function(){return["asignar-usuario-rol-proyecto"]},Se=function(){return["asignar-rol-politica-proyecto"]};function qe(i,e){1&i&&(t.TgZ(0,"mat-cell"),t.YNc(1,Te,3,0,"button",17),t.YNc(2,xe,3,0,"button",18),t.YNc(3,Ce,3,0,"button",19),t.YNc(4,Ze,3,0,"button",20),t.YNc(5,ye,3,0,"button",21),t.YNc(6,we,3,0,"button",22),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(6,Ue)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(7,Ae)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(8,Pe)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(9,_t)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(10,_t)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(11,Se)))}function Ne(i,e){1&i&&t._UZ(0,"mat-header-row")}function je(i,e){1&i&&t._UZ(0,"mat-row",31),2&i&&t.Q6J("cdkDragData",e.$implicit)}function De(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.createGroup())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Crear Rol "),t.qZA()}}const Fe=function(){return["crear-rol_proyecto"]};class L{constructor(e,o,n){this.projectHomeService=e,this.rolService=o,this.dialogService=n,this.data=[],this.displayedColumns=["nombre","jerarquia","descripcion","options"],this.dragDisabled=!0,this.project="",this.group={id:0,jerarquia:0,nombre:"",descripcion:"",proyecto_id:0,proyecto:""},this.userData={nombres:"",rol_id:0,apellidos:"",codigo_usuario:0,proyecto:""},this.roleData={id:0,nombre:"",roles:[]},this.userDataFile={rol_id:0,usuarios:[],proyecto:""}}ngOnInit(){this.project=localStorage.getItem("project")||"",this.cargarGrupos()}drop(e){this.dragDisabled=!0,this.dataSource.find(a=>a==e.item.data);const r=this.dataSource.findIndex(a=>a==e.item.data);(0,nt.bA)(this.dataSource,r,e.currentIndex),this.table.renderRows(),this.ordenarJerarquias()}ordenarJerarquias(){for(let e=0;e<this.dataSource.length;e++)for(let o=0;o<this.dataSource.length;o++)(this.dataSource[e].jerarquia>this.dataSource[o].jerarquia||this.dataSource[e].jerarquia==this.dataSource[o].jerarquia)&&(this.dataSource[e].jerarquia=this.dataSource.length-e)}desactivar(e,o){l().fire({title:"Esta accion eliminara todos los usuarios que se encuentren asignados a este rol y todas las asignaciones de upms y personal a dichos usuarios. \xbfEsta seguro que desea Desactivar el rol: "+o+"?",showDenyButton:!0,showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Si",denyButtonText:"No"}).then(n=>{n.isConfirmed?this.rolService.desactiveGroup(Number(e)).subscribe(r=>{1==r.status&&(this.cargarGrupos(),l().fire("Ok!","Rol desactivado","success"))}):n.isDenied&&l().fire("Cambios no guardados","","info")})}editar(e,o,n,r){this.group.id=Number(e),this.group.nombre=o,this.group.descripcion=n,this.group.proyecto_id=Number(r),this.dialogService.open(ne.w,{height:"20rem",width:"50rem",data:this.group}).afterClosed().subscribe(c=>{1===c&&this.cargarGrupos()})}addUser(e){var o=this;return(0,h.Z)(function*(){const{value:n}=yield l().fire({title:"Usuario",input:"number",inputPlaceholder:"juan2022",confirmButtonText:"Agregar Usuario",showCancelButton:!0,cancelButtonText:"Cancelar",inputLabel:"Ingrese el codigo de usuario"});n&&(o.userData.rol_id=Number(e),o.userData.proyecto=o.project,o.userData.codigo_usuario=n,o.rolService.addUserToGroup(o.userData).subscribe(r=>{1==r.status&&l().fire("Ok!",r.message,"success")}))})()}addFile(e){var o=this;return(0,h.Z)(function*(){const{value:n}=yield l().fire({html:"<label>El archivo debe tener una lista con los codigo de usuario</label>",title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(n){o.userDataFile.rol_id=Number(e),o.userDataFile.proyecto=o.project;const r=new FileReader;r.onload=a=>{const T=P.ij(a.target.result,{type:"binary"});o.data=P.P6.sheet_to_json(T.Sheets[T.SheetNames[0]],{header:1}),o.generateJsonUsers()},r.readAsBinaryString(n)}})()}generateJsonUsers(){var e=this;return(0,h.Z)(function*(){e.userDataFile.usuarios=[],e.data.forEach(o=>{e.userDataFile.usuarios.push(o[0])}),e.userDataFile.usuarios=e.userDataFile.usuarios.filter(Boolean),e.rolService.assignGroupUsersFile(e.userDataFile).subscribe(o=>{1==o.status&&l().fire("Ok",o.message,"success")})})()}guardarJerarquias(){l().fire({title:"Guardar orden de los roles",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No"}).then(e=>{e.isConfirmed?this.projectHomeService.guardarJerarquias(this.dataSource).subscribe(o=>{1==o.status&&(this.cargarGrupos(),l().fire("Ok!","Organizacion Actualizada","success"))}):e.isDenied&&l().fire("Cambios no guardados","","info")})}cargarGrupos(){this.projectHomeService.getGroupsProject(this.project).subscribe(e=>{this.dataSource=e})}verUsuarios(e,o){this.userData.rol_id=Number(e),this.dialogService.open(ae.A,{height:"40rem",width:"50rem",data:this.userData})}verRoles(e,o){this.roleData.id=Number(e),this.roleData.nombre=o,this.rolService.getGroupsRoles(this.roleData.id).subscribe(n=>{this.roleData.roles=n,this.dialogService.open(re.a,{height:"30rem",width:"50rem",data:this.roleData})})}createGroup(){this.projectHomeService.getIdProject(this.project).subscribe(e=>{this.dialogService.open($,{height:"22rem",width:"50rem",data:Number(e)}).afterClosed().subscribe(r=>{1===r&&this.cargarGrupos()})})}}L.\u0275fac=function(e){return new(e||L)(t.Y36(w),t.Y36(I.RolService),t.Y36(C.uw))},L.\u0275cmp=t.Xpm({type:L,selectors:[["app-group-project"]],viewQuery:function(e,o){if(1&e&&t.Gf(ue,7),2&e){let n;t.iGM(n=t.CRH())&&(o.table=n.first)}},decls:31,vars:6,consts:[[1,"mat-elevation-z8","table_div"],[1,"orden_label"],["mat-table","","cdkDropList","","cdkDropListData","datasource",1,"table",3,"dataSource","cdkDropListDisabled","cdkDropListDropped"],["table",""],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","jerarquia","sticky",""],["matColumnDef","descripcion"],["matColumnDef","options"],[4,"matHeaderRowDef"],["cdkDrag","",3,"cdkDragData",4,"matRowDef","matRowDefColumns"],[1,"header"],["mat-flat-button","","color","accent","style","margin-right: 8px",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",3,"click"],[1,"dragCursor",3,"mousedown"],["mat-icon-button","","matTooltip","Editar","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Desactivar","color","warn","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver usuarios","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Agregar usuario","color","primary",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Cargar archivo de usuarios","color","primary",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver politicas","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Editar","color","primary",1,"iconbutton",3,"click"],["aria-label","Edit"],["mat-icon-button","","matTooltip","Desactivar","color","warn",1,"iconbutton",3,"click"],["aria-label","Delete"],["mat-icon-button","","matTooltip","Ver usuarios","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Agregar usuario","color","primary",3,"click"],["mat-icon-button","","matTooltip","Cargar archivo de usuarios","color","primary",3,"click"],["mat-icon-button","","matTooltip","Ver politicas","color","primary",1,"iconbutton",3,"click"],["cdkDrag","",3,"cdkDragData"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"br")(2,"br"),t.TgZ(3,"mat-label",1)(4,"strong"),t._uU(5,"Ordene los grupos de mayor a menor"),t.qZA()(),t.TgZ(6,"table",2,3),t.NdJ("cdkDropListDropped",function(r){return o.drop(r)}),t.ynx(8,4),t.YNc(9,me,2,0,"mat-header-cell",5),t.YNc(10,pe,2,1,"mat-cell",6),t.BQk(),t.ynx(11,7),t.YNc(12,de,2,0,"mat-header-cell",5),t.YNc(13,_e,5,1,"mat-cell",6),t.BQk(),t.ynx(14,8),t.YNc(15,ge,2,0,"mat-header-cell",5),t.YNc(16,fe,2,1,"mat-cell",6),t.BQk(),t.ynx(17,9),t.YNc(18,he,2,0,"mat-header-cell",5),t.YNc(19,be,2,1,"mat-cell",6),t.BQk(),t.ynx(20,10),t.YNc(21,ve,2,0,"mat-header-cell",5),t.YNc(22,qe,7,12,"mat-cell",6),t.BQk(),t.YNc(23,Ne,1,0,"mat-header-row",11),t.YNc(24,je,1,1,"mat-row",12),t.qZA()(),t.TgZ(25,"div",13),t.YNc(26,De,4,0,"button",14),t.TgZ(27,"button",15),t.NdJ("click",function(){return o.guardarJerarquias()}),t.TgZ(28,"mat-icon"),t._uU(29,"save"),t.qZA(),t._uU(30," Guardar Orden de Roles "),t.qZA()()),2&e&&(t.xp6(6),t.Q6J("dataSource",o.dataSource)("cdkDropListDisabled",o.dragDisabled),t.xp6(17),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(5,Fe)))},dependencies:[_.hX,x.lW,x.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,p.Hw,D.gM,nt.Wj,nt.Zt,y.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:1.5rem;padding:0 .4rem;font-family:Roboto,Helvetica Neue,sans-serif}.orden_label[_ngcontent-%COMP%]{text-align:center;padding-left:2rem;color:red}.dragCursor[_ngcontent-%COMP%]{cursor:move}"]});var S=u(3031);function Ee(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.addUpm())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," A\xf1adir UPM "),t.qZA()}}function Me(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo de UPM "),t.qZA()}}function Oe(i,e){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Departamento"),t.qZA())}function ke(i,e){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.departamento)}}function Ye(i,e){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Municipio"),t.qZA())}function Re(i,e){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.municipio)}}function Je(i,e){1&i&&(t.TgZ(0,"th",20),t._uU(1,"UPM"),t.qZA())}function Qe(i,e){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.upm)}}function Be(i,e){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Estado"),t.qZA())}function He(i,e){if(1&i&&(t.TgZ(0,"td",21)(1,"button",22),t._uU(2),t.qZA()()),2&i){const o=e.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngStyle",n.getColor(o.cod_estado)),t.xp6(1),t.Oqu(o.estado)}}function Ie(i,e){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Acciones"),t.qZA())}function Ge(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.sustituirUpm(r.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"loop"),t.qZA()()}}function ze(i,e){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Ge,3,0,"button",25),t.qZA()),2&i){const o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","Cargado"==o.estado)}}function $e(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.verDetalles(r.id))}),t.TgZ(1,"mat-icon"),t._uU(2,"receipt"),t.qZA()()}}const Le=function(){return["reemplazar-upm"]};function Ke(i,e){if(1&i&&(t.TgZ(0,"td",21),t.YNc(1,ze,2,1,"div",23),t.TgZ(2,"div"),t.YNc(3,$e,3,0,"button",24),t.qZA()()),2&i){const o=e.$implicit;t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(2,Le)),t.xp6(2),t.Q6J("ngIf","Sustituido"==o.estado)}}function Ve(i,e){1&i&&t._UZ(0,"tr",28)}function Xe(i,e){1&i&&t._UZ(0,"tr",29)}function We(i,e){if(1&i&&(t.TgZ(0,"tr",30)(1,"td",31),t._uU(2),t.qZA()()),2&i){t.oxw();const o=t.MAs(13);t.xp6(2),t.hij(' No hay resultados de "',o.value,'" ')}}const gt=function(){return["asignar-upm-proyecto"]},to=function(){return[10,25,100]};class K{constructor(e,o,n,r){this.formBuilder=e,this.dialog=o,this.homeProjectService=n,this.projectService=r,this.displayedColumns=["departamento","municipio","upm","estado","options"],this.data=[],this.assignment={proyecto_id:0,upms:[]},this.upmDataSust={proyecto_id:0,upm_nuevo:"",upm_anterior:0,descripcion:"",usuario_id:0},this.dataSource=new s.by,this.buildForm()}buildForm(){this.formUpms=this.formBuilder.group({file:[""]})}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.idProject=e,this.cargarUpmsAsignadas()})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}cargarUpmsAsignadas(){0!=this.idProject&&this.projectService.getUpms(this.idProject).subscribe(e=>{this.dataSource=new s.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}getColor(e){for(let o=0;o<S.q.array.length;o++)if(S.q.array[o].id==Number(e))return{color:S.q.array[o].color,border:`1px solid ${S.q.array[o].color}`};return{}}addUpm(){var e=this;return(0,h.Z)(function*(){const{value:o}=yield l().fire({title:"UPM",input:"text",inputPlaceholder:"AEE001122337A2",confirmButtonText:"Agregar UPM",showCancelButton:!0,inputLabel:"Ingrese la UPM"});o&&(e.assignment.proyecto_id=e.idProject,e.assignment.upms=[o],e.projectService.assignUpmToProject(e.assignment).subscribe(n=>{1==n.status&&(e.cargarUpmsAsignadas(),l().fire("Ok!",n.message,"success"))}))})()}sustituirUpm(e){var o=this;return(0,h.Z)(function*(){o.upmDataSust.proyecto_id=o.idProject,o.upmDataSust.upm_anterior=Number(e);const{value:n}=yield l().fire({title:"Sustituir upms",html:'<span>Ingrese el upm</span><input type="text" style="width:80%;"  placeholder="AEE123456789A1" id="upm" class="swal2-input"><br><span>Ingrese el motivo de sustitucion</span><textarea id="descripcion" style="width:80%;" placeholder="No se puede acceder al lugar" class="swal2-input"></textarea>',showCancelButton:!0,cancelButtonText:"Cancelar",preConfirm:()=>[document.getElementById("upm"),document.getElementById("descripcion")]});if(n){let a=n[1].value;o.upmDataSust.upm_nuevo=n[0].value,o.upmDataSust.descripcion=a,o.upmDataSust.usuario_id=Number(localStorage.getItem("id")),o.projectService.sustituirUpm(o.upmDataSust).subscribe(c=>{1==c.status&&(o.cargarUpmsAsignadas(),l().fire("Ok!",c.message,"success"))})}})()}addFile(){var e=this;return(0,h.Z)(function*(){const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const n=new FileReader;n.onload=r=>{const c=P.ij(r.target.result,{type:"binary"});e.data=P.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),e.generateJson()},n.readAsBinaryString(o)}})()}generateJson(){this.idProject&&(this.assignment.proyecto_id=this.idProject,this.data.forEach(e=>{this.assignment.upms.push(e.toString())})),this.assignment.upms=this.assignment.upms.filter(Boolean),console.log(this.assignment),this.projectService.assignUpmToProject(this.assignment).subscribe(e=>{1==e.status&&(this.cargarUpmsAsignadas(),l().fire("Ok!",e.message,"success"))})}verDetalles(e){Number(e)&&this.homeProjectService.verDetalleSustitucion(Number(e)).subscribe(o=>{l().fire({title:"Descripcion",html:`UPM nuevo: <b>${o.nombre}</b>, <br><span>Usuario modificador: ${o.codigo_usuario}</span> <br><span>Fecha: ${o.fecha}</span> <br><p>Motivo: ${o.descripcion}</p>`})})}}function eo(i,e){1&i&&(t.TgZ(0,"mat-tab",7),t._UZ(1,"app-group-project"),t.qZA())}function oo(i,e){1&i&&(t.TgZ(0,"mat-tab",8),t._UZ(1,"app-upms"),t.qZA())}K.\u0275fac=function(e){return new(e||K)(t.Y36(d.qu),t.Y36(C.uw),t.Y36(w),t.Y36(z.Y))},K.\u0275cmp=t.Xpm({type:K,selectors:[["app-upms"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:36,vars:9,consts:[[1,"container"],[1,"header"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["paginator",""],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-stroked-button","",2,"background","white",3,"ngStyle"],[4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver detalles","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Reemplazar","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Reemplazar","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Ver detalles","color","primary",1,"iconbutton",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t._UZ(0,"br")(1,"br"),t.TgZ(2,"div")(3,"div",0)(4,"div",1),t.YNc(5,Ee,4,0,"button",2),t.YNc(6,Me,4,0,"button",2),t.qZA()()(),t._UZ(7,"br")(8,"br"),t.TgZ(9,"mat-form-field")(10,"mat-label"),t._uU(11,"Buscar"),t.qZA(),t.TgZ(12,"input",3,4),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA()(),t.TgZ(14,"div",5)(15,"table",6),t.ynx(16,7),t.YNc(17,Oe,2,0,"th",8),t.YNc(18,ke,2,1,"td",9),t.BQk(),t.ynx(19,10),t.YNc(20,Ye,2,0,"th",8),t.YNc(21,Re,2,1,"td",9),t.BQk(),t.ynx(22,11),t.YNc(23,Je,2,0,"th",8),t.YNc(24,Qe,2,1,"td",9),t.BQk(),t.ynx(25,12),t.YNc(26,Be,2,0,"th",8),t.YNc(27,He,3,2,"td",9),t.BQk(),t.ynx(28,13),t.YNc(29,Ie,2,0,"th",8),t.YNc(30,Ke,4,3,"td",9),t.BQk(),t.YNc(31,Ve,1,0,"tr",14),t.YNc(32,Xe,1,0,"tr",15),t.YNc(33,We,3,1,"tr",16),t.qZA(),t._UZ(34,"mat-paginator",17,18),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngxPermissionsOnly",t.DdM(6,gt)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(7,gt)),t.xp6(9),t.Q6J("dataSource",o.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(8,to)))},dependencies:[U.O5,U.PC,_.KE,_.hX,m.Nt,x.lW,x.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,D.gM,f.YE,y.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;margin:.5rem;padding:0 .4rem;gap:1rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]});const io=function(){return["crear-rol_proyecto"]},no=function(){return["ver-upms"]};class R{constructor(e,o){this.router=e,this.projectHomeService=o,this.projectId=0,this.roles=[]}ngOnInit(){this.project=localStorage.getItem("project")||"",this.project||this.router.navigateByUrl("home")}}R.\u0275fac=function(e){return new(e||R)(t.Y36(ct.F0),t.Y36(w))},R.\u0275cmp=t.Xpm({type:R,selectors:[["app-home-project-page"]],decls:21,vars:5,consts:[[1,"header"],["color","primary","mode","determinate","value","45"],[1,"mat_tab"],["color","accent"],["label","Dashboard"],["label","Roles",4,"ngxPermissionsOnly"],["label","UPM",4,"ngxPermissionsOnly"],["label","Roles"],["label","UPM"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"div")(2,"div")(3,"div",0)(4,"h2"),t._uU(5),t.qZA(),t.TgZ(6,"div")(7,"h3")(8,"mat-label"),t._uU(9,"Progreso Total"),t.qZA()(),t._UZ(10,"mat-progress-spinner",1),t.qZA()()(),t._UZ(11,"br")(12,"br")(13,"br"),t.TgZ(14,"div",2)(15,"mat-tab-group",3)(16,"mat-tab",4)(17,"h1"),t._uU(18,"Progreso"),t.qZA()(),t.YNc(19,eo,2,0,"mat-tab",5),t.YNc(20,oo,2,0,"mat-tab",6),t.qZA()()()()),2&e&&(t.xp6(5),t.Oqu(o.project),t.xp6(14),t.Q6J("ngxPermissionsOnly",t.DdM(3,io)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(4,no)))},dependencies:[_.hX,ie.Ou,dt.uX,dt.SP,y.gE,L,K],styles:[".header[_ngcontent-%COMP%]{padding-top:2rem;display:flex;justify-content:space-around;align-items:center}.progress-upms[_ngcontent-%COMP%]{padding-top:3.5rem;display:flex;justify-content:space-around;flex-wrap:wrap}.upm-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:12rem;width:14rem}.grid-example-square[_ngcontent-%COMP%]{justify-content:end}.mat_tab[_ngcontent-%COMP%]{margin:1.5rem;border:1px groove}"]});var ro=u(6122);class E{constructor(e){this.apiService=e}getDataSupervisor(e){return this.apiService.store("obtenerUpmSupervisor",e)}getUsersAssigned(e){return this.apiService.store("obtenerCartografosSupervisor",e)}editUserSupervisor(e){return this.apiService.patch("asignarUsuarioSupervisor",e)}modifyCartographerUpm(e){return this.apiService.patch("upmCartografoSupervisor/edit",e)}}function ao(i,e){1&i&&(t.TgZ(0,"mat-icon",6),t._uU(1,"beenhere"),t.qZA())}function so(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){const a=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.editUser(a.codigo_usuario,a.nombres))}),t.YNc(1,ao,2,0,"mat-icon",5),t._uU(2),t.qZA()}if(2&i){const o=e.$implicit;t.xp6(1),t.Q6J("ngIf",o.button),t.xp6(1),t.lnq(" ",o.codigo_usuario," - ",o.nombres," ",o.apellidos," ")}}E.\u0275fac=function(e){return new(e||E)(t.LFG(N.s))},E.\u0275prov=t.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"});class M{constructor(e,o,n,r,a){this.userService=e,this.supervisorService=o,this.dialogRef=n,this.data=r,this.formBuilder=a,this.button=!1,this.users=[],this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:c=>{c.addEventListener("mouseenter",l().stopTimer),c.addEventListener("mouseleave",l().resumeTimer)}}),this.getUsers()}submit(){}getUsers(){this.supervisorService.getUsersAssigned({proyecto_id:this.data.proyecto_id}).subscribe(o=>{this.users=o,this.users.forEach(n=>{n.button=!1}),this.defaultUsers()})}defaultUsers(){for(let e=0;e<this.users.length;e++)this.users[e].nombres==this.data.nombre&&this.users[e].codigo_usuario==this.data.codigo_usuario&&(this.users[e].button=!0)}editUser(e,o){e!=this.data.codigo_usuario&&o!=this.data.nombre?this.supervisorService.modifyCartographerUpm({usuario_nuevo:e,proyecto_id:this.data.proyecto_id,upm:this.data.upm}).subscribe(r=>{1==r.status&&(this.Toast.fire({icon:"success",title:r.message}),this.dialogRef.close(1))}):this.Toast.fire({icon:"error",title:"El usuario seleccionado ya es el encargado de el UPM"})}cancelEdit(){this.dialogRef.close()}}function co(i,e){1&i&&(t.TgZ(0,"th",24),t._uU(1,"UPM"),t.qZA())}function lo(i,e){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.upm," ")}}function uo(i,e){1&i&&(t.TgZ(0,"th",24),t._uU(1,"COD Cartografo"),t.qZA())}function mo(i,e){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.codigo_usuario," ")}}function po(i,e){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Nombres"),t.qZA())}function _o(i,e){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.nombres," ")}}function go(i,e){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Apellidos"),t.qZA())}function fo(i,e){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.hij(" ",o.apellidos," ")}}function ho(i,e){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Estado"),t.qZA())}function bo(i,e){if(1&i&&(t.TgZ(0,"td",25)(1,"button",26),t._uU(2),t.qZA()()),2&i){const o=e.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngStyle",n.getColor(o.cod_estado)),t.xp6(1),t.hij(" ",o.estado," ")}}function vo(i,e){1&i&&t._UZ(0,"th",27)}function To(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw();return t.KtG(a.asignar(r.codigo_usuario,r.nombres,r.upm))}),t.TgZ(1,"mat-icon"),t._uU(2,"person"),t.qZA()()}}function xo(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(2);return t.KtG(r.verMapa())}),t.TgZ(1,"mat-icon"),t._uU(2,"my_location"),t.qZA()()}}M.\u0275fac=function(e){return new(e||M)(t.Y36(ro.UserService),t.Y36(E),t.Y36(C.so),t.Y36(C.WI),t.Y36(d.qu))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-dialog-supervisor-assign-user"]],decls:18,vars:1,consts:[[1,"title"],["mat-icon-button","",3,"click"],[1,"container"],["mat-flat-button","","class","button","color","primary",3,"click",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary",1,"button",3,"click"],["color","warn",4,"ngIf"],["color","warn"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Asignar UPM a usuario"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return o.cancelEdit()}),t.TgZ(4,"mat-icon"),t._uU(5,"cancel"),t.qZA()()(),t._UZ(6,"br")(7,"br")(8,"br"),t.TgZ(9,"div")(10,"h3"),t._uU(11,"Usuarios"),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"p"),t._uU(14,"Haga click en el usuario al que le desea asignar el upm"),t.qZA(),t._UZ(15,"br"),t.TgZ(16,"div",2),t.YNc(17,so,3,4,"button",3),t.qZA()()),2&e&&(t.xp6(17),t.Q6J("ngForOf",o.users))},dependencies:[U.sg,U.O5,x.lW,x.RK,p.Hw],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:2rem}h3[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{display:flex;justify-content:center}.container[_ngcontent-%COMP%]{display:flex;margin-left:.2rem;margin-right:.2rem;flex-direction:row;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:1rem}.button[_ngcontent-%COMP%]{display:flex;width:48%;height:50px}@media (max-width: 768px){.button[_ngcontent-%COMP%]{display:flex;width:98%;height:60px}}"]});const Co=function(){return["editar-cartografo-upm"]},Zo=function(){return["ver-mapa"]};function yo(i,e){1&i&&(t.TgZ(0,"td",25),t.YNc(1,To,3,0,"button",28),t.YNc(2,xo,3,0,"button",29),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(2,Co)),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(3,Zo)))}function wo(i,e){1&i&&t._UZ(0,"tr",32)}function Uo(i,e){1&i&&t._UZ(0,"tr",33)}function Ao(i,e){if(1&i&&(t.TgZ(0,"tr",34)(1,"td",35),t._uU(2),t.qZA()()),2&i){t.oxw();const o=t.MAs(11);t.xp6(2),t.hij('No hay resultados de "',o.value,'"')}}const Po=function(){return[5,10,25,100]};class J{constructor(e,o,n,r){this.formBuilder=e,this.supervisorService=o,this.dialogService=n,this.projectHomeService=r,this.displayedColumns=["upm","codigo_usuario","nombres","apellidos","estado","options"],this.data=[],this.idProject=0,this.supervisorData={id:0,upm:"",codigo_usuario:0,nombres:"",apellidos:"",estado:""},this.supervisorUserData={codigo_usuario:0,nombre:"",proyecto_id:0,upm:""},this.dataSource=new s.by,this.buildForm()}ngOnInit(){let e=localStorage.getItem("project")||"";this.projectHomeService.getIdProject(e).subscribe(o=>{this.idProject=o,this.supervisorUserData.proyecto_id=o,this.cargarTabla()})}buildForm(){this.formSupervisor=this.formBuilder.group({file:[""]})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}cargarTabla(){this.supervisorService.getDataSupervisor({proyecto_id:this.idProject}).subscribe(e=>{this.dataSource=new s.by(e),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}asignar(e,o,n){this.supervisorUserData.codigo_usuario=Number(e),this.supervisorUserData.nombre=o,this.supervisorUserData.upm=n,this.dialogService.open(M,{height:"50rem",width:"50rem",data:this.supervisorUserData}).afterClosed().subscribe(a=>{1===a&&this.cargarTabla()})}verMapa(){}getColor(e){for(let o=0;o<S.q.array.length;o++)if(S.q.array[o].id==Number(e))return{color:S.q.array[o].color,border:`1px solid ${S.q.array[o].color}`};return{}}}function So(i,e){if(1&i&&(t.TgZ(0,"mat-option",20),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.id+","+o.nombre),t.xp6(1),t.hij(" ",o.nombre," ")}}function qo(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(),a=t.MAs(11);return t.KtG(r.getUsers(a.value))}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_downward"),t.qZA(),t._uU(3," Descargar Plantilla "),t.qZA()}if(2&i){t.oxw();const o=t.MAs(11);t.Q6J("disabled",!o.value)}}function No(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo "),t.qZA()}}function jo(i,e){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Encargado"),t.qZA())}function Do(i,e){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.encargado)}}function Fo(i,e){1&i&&(t.TgZ(0,"th",35),t._uU(1,"Personal"),t.qZA())}function Eo(i,e){if(1&i&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.empleado)}}function Mo(i,e){1&i&&(t.TgZ(0,"th",37),t._uU(1,"Opciones"),t.qZA())}function Oo(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"td",36)(1,"button",38),t.NdJ("click",function(){const a=t.CHM(o).$implicit,c=t.oxw(2);return t.KtG(c.deleteAsignation(a.encargado_id,a.empleado_id,a.encargado,a.empleado))}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()()}}function ko(i,e){1&i&&t._UZ(0,"tr",39)}function Yo(i,e){1&i&&t._UZ(0,"tr",40)}function Ro(i,e){if(1&i&&(t.TgZ(0,"tr",41)(1,"td",42),t._uU(2),t.qZA()()),2&i){t.oxw(2);const o=t.MAs(32);t.xp6(2),t.hij(' No hay resultados de "',o.value,'" ')}}J.\u0275fac=function(e){return new(e||J)(t.Y36(d.qu),t.Y36(E),t.Y36(C.uw),t.Y36(w))},J.\u0275cmp=t.Xpm({type:J,selectors:[["app-supervisor"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:39,vars:9,consts:[[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6","12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearance","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: Juan P\xe9rez",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevation-z8","table"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","upm"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","codigo_usuario"],["matColumnDef","nombres"],["matColumnDef","apellidos"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Click para modificar encargado","matTooltipPosition","above","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Click para Ver Mapa","matTooltipPosition","above","color","primary","clas","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Click para modificar encargado","matTooltipPosition","above","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Click para Ver Mapa","matTooltipPosition","above","color","primary","clas","iconbutton",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t._uU(5,"Supervisores"),t.qZA()(),t.TgZ(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),t._uU(9,"Buscar"),t.qZA(),t.TgZ(10,"input",6,7),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA(),t.TgZ(12,"mat-icon",8),t._uU(13,"search"),t.qZA()()()(),t.TgZ(14,"div",9)(15,"table",10),t.ynx(16,11),t.YNc(17,co,2,0,"th",12),t.YNc(18,lo,2,1,"td",13),t.BQk(),t.ynx(19,14),t.YNc(20,uo,2,0,"th",12),t.YNc(21,mo,2,1,"td",13),t.BQk(),t.ynx(22,15),t.YNc(23,po,2,0,"th",12),t.YNc(24,_o,2,1,"td",13),t.BQk(),t.ynx(25,16),t.YNc(26,go,2,0,"th",12),t.YNc(27,fo,2,1,"td",13),t.BQk(),t.ynx(28,17),t.YNc(29,ho,2,0,"th",12),t.YNc(30,bo,3,2,"td",13),t.BQk(),t.ynx(31,18),t.YNc(32,vo,1,0,"th",19),t.YNc(33,yo,3,4,"td",13),t.BQk(),t.YNc(34,wo,1,0,"tr",20),t.YNc(35,Uo,1,0,"tr",21),t.YNc(36,Ao,3,1,"tr",22),t.qZA(),t._UZ(37,"br")(38,"mat-paginator",23),t.qZA()()()),2&e&&(t.xp6(7),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(7),t.Q6J("dataSource",o.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(8,Po)))},dependencies:[U.PC,_.KE,_.hX,_.R9,m.Nt,x.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,D.gM,f.YE,f.nU,y.gE],styles:[".table[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-cell[_ngcontent-%COMP%]:nth-child(1), .mat-header-cell[_ngcontent-%COMP%]:nth-child(1){flex:0 0 6%}.mat-cell[_ngcontent-%COMP%]:nth-child(2), .mat-header-cell[_ngcontent-%COMP%]:nth-child(2){flex:0 0 30%}.mat-cell[_ngcontent-%COMP%]:nth-child(3), .mat-header-cell[_ngcontent-%COMP%]:nth-child(3){flex:0 0 6%}.mat-cell[_ngcontent-%COMP%]:nth-child(7), .mat-header-cell[_ngcontent-%COMP%]:nth-child(7){flex:0 0 7%}"]});const Jo=function(){return[5,10,25,100]};function Qo(i,e){if(1&i&&(t.TgZ(0,"div",23)(1,"table",24),t.ynx(2,25),t.YNc(3,jo,2,0,"th",26),t.YNc(4,Do,2,1,"td",27),t.BQk(),t.ynx(5,28),t.YNc(6,Fo,2,0,"th",26),t.YNc(7,Eo,2,1,"td",27),t.BQk(),t.ynx(8,29),t.YNc(9,Mo,2,0,"th",30),t.YNc(10,Oo,4,0,"td",27),t.BQk(),t.YNc(11,ko,1,0,"tr",31),t.YNc(12,Yo,1,0,"tr",32),t.YNc(13,Ro,3,1,"tr",33),t.qZA(),t._UZ(14,"br")(15,"mat-paginator",34),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("dataSource",o.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(4,Jo))}}const Bo=function(){return["descargar-plantilla"]},ft=function(){return["asignar-personal"]};class V{constructor(e,o,n,r){this.rolService=e,this.projectHomeService=o,this.projectService=n,this.excelService=r,this.data=[[1,2],[3,4]],this.users=[],this.usernames=[],this.projectUserAssignment={usuario_id:0,proyecto_id:0},this.displayedColumns=["encargado","empleado","options"],this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by}ngOnInit(){let e=localStorage.getItem("id");Number(e)&&(this.projectUserAssignment.usuario_id=Number(e),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.projectUserAssignment.proyecto_id=o,this.idProject=o,this.getGroupsMinor(),this.getChiefEmployee()})),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var e=this;return(0,h.Z)(function*(){e.rolService.getGroupsMinor(e.projectUserAssignment).subscribe(o=>{e.groups=o})})()}getUsers(e){let o=Number(localStorage.getItem("id")),n=e.split(",");this.users=[],this.usernames=[],this.projectHomeService.getUsersAssigned({rol_id:Number(n[0]),proyecto_id:this.idProject,usuario_id:o}).subscribe(r=>{this.usernames=r,this.usernames.forEach(a=>{this.users.push({encargado:"",codigo_usuario:a.codigo_usuario,nombres:a.nombres,apellidos:a.apellidos})}),this.excelService.exportAsExcelFile(this.users,n[1])})}addFile(){var e=this;return(0,h.Z)(function*(){const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const n=new FileReader;n.onload=r=>{const c=P.ij(r.target.result,{type:"binary"});e.data=P.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),e.generateJson()},n.readAsBinaryString(o)}})()}generateJson(){var e=this;return(0,h.Z)(function*(){let o=Number(localStorage.getItem("id"));if(Number(o)){let n=[],r=[];e.data.forEach(a=>{a[0]&&a[1]&&n.push({codigo_superior:a[0],codigo_inferior:a[1],proyecto_id:e.idProject})}),n.shift(),n=n.filter(Boolean);for(let a=0;a<n.length;a++)for(let c=a+1;c<n.length;c++)null!=n[a]&&n[a].codigo_superior==n[c].codigo_superior&&n[a].codigo_inferior==n[c].codigo_inferior&&r.push(n[a].codigo_superior,n[a].codigo_inferior);for(let a=0;a<n.length;a++)for(let c=a+1;c<n.length;c++)n[a].codigo_inferior==n[c].codigo_inferior&&r.push(n[a].codigo_inferior);r.length>0?e.Toast.fire({icon:"error",title:"Hay filas repetidas: "+r}):e.projectHomeService.assignPersonal(n).subscribe(a=>{1==a.status&&(e.Toast.fire({icon:"success",title:a.message}),e.getChiefEmployee())})}})()}getChiefEmployee(){let e=Number(localStorage.getItem("id"));this.projectHomeService.getChiefEmployee({usuario_id:e,proyecto_id:this.idProject}).subscribe(o=>{this.dataSource=new s.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}verPlantilla(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaPersonal.png",imageWidth:375,imageHeight:250,imageAlt:"Ejemplo del archivo de carga"})}deleteAsignation(e,o,n,r){l().fire({title:"Esta accion eliminara todas las asignaciones de personal y upms en la que se encuentre: "+r+" \xbfEsta seguro que desea eliminar la asignacion:?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"Cancelar",denyButtonText:"No"}).then(a=>{a.isConfirmed?this.projectHomeService.deleteAssingmentUsers({encargado_id:e,empleado_id:o,proyecto_id:this.idProject}).subscribe(c=>{1==c.status&&(l().fire("Ok",c.message,"success"),this.getChiefEmployee())}):a.isDenied&&l().fire("Cambios no guardados","","info")})}}function Ho(i,e){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Departamento"),t.qZA())}function Io(i,e){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.departamento)}}function Go(i,e){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Municipio"),t.qZA())}function zo(i,e){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.municipio)}}function $o(i,e){1&i&&(t.TgZ(0,"th",25),t._uU(1,"UPM"),t.qZA())}function Lo(i,e){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.upm)}}function Ko(i,e){1&i&&(t.TgZ(0,"th",25),t._uU(1,"Estado"),t.qZA())}function Vo(i,e){if(1&i&&(t.TgZ(0,"td",26)(1,"button",27),t._uU(2),t.qZA()()),2&i){const o=e.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",n.getColor(o.cod_estado)),t.xp6(1),t.hij(" ",o.estado," ")}}function Xo(i,e){1&i&&t._UZ(0,"th",28)}function Wo(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.initActualization(r.upm))}),t.TgZ(1,"mat-icon"),t._uU(2,"power_settings_new"),t.qZA()()}if(2&i){const o=t.oxw().$implicit;t.Q6J("disabled",1!=o.cod_estado)}}function ti(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.finishActualization(r.upm))}),t.TgZ(1,"mat-icon",33),t._uU(2,"done"),t.qZA()()}if(2&i){const o=t.oxw().$implicit;t.Q6J("disabled",1==o.cod_estado||3==o.cod_estado||4==o.cod_estado)}}V.\u0275fac=function(e){return new(e||V)(t.Y36(I.RolService),t.Y36(w),t.Y36(z.Y),t.Y36(j))},V.\u0275cmp=t.Xpm({type:V,selectors:[["app-asignar-personal"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:36,vars:13,consts:[[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","accent",3,"disabled","click",4,"ngxPermissionsOnly"],[1,"container_options"],[1,"upms"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","encargado"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","empleado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-icon-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Asignacion de Personal"),t.qZA()(),t._UZ(3,"br")(4,"br"),t.TgZ(5,"div",1)(6,"div",2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Seleccione un Rol"),t.qZA(),t.TgZ(10,"mat-select",null,4),t.YNc(12,So,2,2,"mat-option",5),t.qZA()(),t.TgZ(13,"div"),t.YNc(14,qo,4,1,"button",6),t.qZA()(),t.TgZ(15,"div",7)(16,"div",8),t.YNc(17,No,4,0,"button",9),t.qZA(),t.TgZ(18,"div")(19,"button",10),t.NdJ("click",function(){return o.verPlantilla()}),t.TgZ(20,"mat-icon"),t._uU(21,"remove_red_eye"),t.qZA(),t._uU(22," Ver ejemplo de archivo de carga "),t.qZA()()()(),t.TgZ(23,"div",11)(24,"div",12)(25,"div",13),t._UZ(26,"div",14),t.qZA(),t._UZ(27,"br"),t.TgZ(28,"mat-form-field",15)(29,"mat-label"),t._uU(30,"Buscar"),t.qZA(),t.TgZ(31,"input",16,17),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA(),t.TgZ(33,"mat-icon",18),t._uU(34,"search"),t.qZA()(),t.YNc(35,Qo,16,5,"div",19),t.qZA()()),2&e&&(t.xp6(8),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngForOf",o.groups),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(10,Bo)),t.xp6(3),t.Q6J("ngxPermissionsOnly",t.DdM(11,ft)),t.xp6(11),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(6),t.Q6J("ngxPermissionsOnly",t.DdM(12,ft)))},dependencies:[U.sg,_.KE,_.hX,_.R9,m.Nt,x.lW,x.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,it.gD,st.ey,D.gM,f.YE,f.nU,y.gE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}"]});const ei=function(){return["inicializar-actualizacion"]},oi=function(){return["finalizar-actualizacion"]};function ii(i,e){1&i&&(t.TgZ(0,"td",26)(1,"div"),t.YNc(2,Wo,3,1,"button",29),t.qZA(),t.TgZ(3,"div"),t.YNc(4,ti,3,1,"button",30),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(2,ei)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(3,oi)))}function ni(i,e){1&i&&t._UZ(0,"tr",34)}function ri(i,e){1&i&&t._UZ(0,"tr",35)}function ai(i,e){if(1&i&&(t.TgZ(0,"tr",36)(1,"td",37),t._uU(2),t.qZA()()),2&i){t.oxw(2);const o=t.MAs(11);t.xp6(2),t.hij(' No hay resultados de "',o.value,'" ')}}const si=function(){return[10,25,100]};function ci(i,e){if(1&i&&(t.TgZ(0,"div",10)(1,"table",11),t.ynx(2,12),t.YNc(3,Ho,2,0,"th",13),t.YNc(4,Io,2,1,"td",14),t.BQk(),t.ynx(5,15),t.YNc(6,Go,2,0,"th",13),t.YNc(7,zo,2,1,"td",14),t.BQk(),t.ynx(8,16),t.YNc(9,$o,2,0,"th",13),t.YNc(10,Lo,2,1,"td",14),t.BQk(),t.ynx(11,17),t.YNc(12,Ko,2,0,"th",13),t.YNc(13,Vo,3,2,"td",14),t.BQk(),t.ynx(14,18),t.YNc(15,Xo,1,0,"th",19),t.YNc(16,ii,5,4,"td",14),t.BQk(),t.YNc(17,ni,1,0,"tr",20),t.YNc(18,ri,1,0,"tr",21),t.YNc(19,ai,3,1,"tr",22),t.qZA(),t._UZ(20,"mat-paginator",23,24),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("dataSource",o.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,si))}}const li=function(){return["ver-upms-cartografo"]};class X{constructor(e,o,n,r){this.formBuilder=e,this.dialog=o,this.homeProjectService=n,this.projectService=r,this.displayedColumns=["departamento","municipio","upm","estado","options"],this.data=[],this.assignment={proyecto_id:0,upms:[]},this.upmDataSust={proyecto_id:0,upm_nuevo:"",upm_anterior:0,descripcion:"",usuario_id:0},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by,this.buildForm()}buildForm(){this.formUpms=this.formBuilder.group({file:[""]})}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(e=>{this.idProject=e,this.cargarUpmsAsignadas()})}cargarUpmsAsignadas(){0!=this.idProject&&this.projectService.getUpmCartographer({proyecto_id:this.idProject}).subscribe(e=>{this.dataSource=new s.by(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getColor(e){for(let o=0;o<S.q.array.length;o++)if(S.q.array[o].id==Number(e))return{color:S.q.array[o].color,border:`1px solid ${S.q.array[o].color}`};return{}}initActualization(e){this.homeProjectService.initActualization({upm:e,proyecto_id:this.idProject}).subscribe(n=>{1==n.status&&(this.Toast.fire({icon:"success",title:n.message}),this.cargarUpmsAsignadas())})}finishActualization(e){this.homeProjectService.finishActualization({upm:e,proyecto_id:this.idProject}).subscribe(n=>{1==n.status&&(this.Toast.fire({icon:"success",title:n.message}),this.cargarUpmsAsignadas())})}}function ui(i,e){if(1&i&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.id+","+o.nombre),t.xp6(1),t.hij(" ",o.nombre," ")}}function mi(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div")(1,"button",22),t.NdJ("click",function(){t.CHM(o);const r=t.oxw(),a=t.MAs(11);return t.KtG(r.getUpmsAsignn(a.value))}),t.TgZ(2,"mat-icon"),t._uU(3,"arrow_downward"),t.qZA(),t._uU(4," Descargar Plantilla "),t.qZA()()}if(2&i){t.oxw();const o=t.MAs(11);t.xp6(1),t.Q6J("disabled",!o.value)}}function pi(i,e){1&i&&(t.TgZ(0,"button",23)(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t._uU(3," Agregar "),t.qZA())}function di(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.addFile())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_upward"),t.qZA(),t._uU(3," Cargar Archivo "),t.qZA()}}function _i(i,e){1&i&&(t.TgZ(0,"th",38),t._uU(1,"Rol"),t.qZA())}function gi(i,e){if(1&i&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.rol)}}function fi(i,e){1&i&&(t.TgZ(0,"th",38),t._uU(1,"Encargado"),t.qZA())}function hi(i,e){if(1&i&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.encargado)}}function bi(i,e){1&i&&(t.TgZ(0,"th",38),t._uU(1,"UPM"),t.qZA())}function vi(i,e){if(1&i&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.xp6(1),t.Oqu(o.upm)}}function Ti(i,e){1&i&&(t.TgZ(0,"th",40),t._uU(1,"Opciones"),t.qZA())}function xi(i,e){1&i&&(t.TgZ(0,"td",39)(1,"button",41)(2,"mat-icon"),t._uU(3,"my_location"),t.qZA()()())}function Ci(i,e){1&i&&t._UZ(0,"tr",42)}function Zi(i,e){1&i&&t._UZ(0,"tr",43)}function yi(i,e){if(1&i&&(t.TgZ(0,"tr",44)(1,"td",45),t._uU(2),t.qZA()()),2&i){t.oxw(2);const o=t.MAs(34);t.xp6(2),t.hij(' No hay resultados de "',o.value,'" ')}}X.\u0275fac=function(e){return new(e||X)(t.Y36(d.qu),t.Y36(C.uw),t.Y36(w),t.Y36(z.Y))},X.\u0275cmp=t.Xpm({type:X,selectors:[["app-cartographer"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:15,vars:6,consts:[[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6-12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearance","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["paginator",""],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],[1,"estado",2,"background","white",3,"ngStyle"],["mat-header-cell",""],["mat-flat-button","","color","primary","matTooltip","Iniciar Actualizacion","matTooltipPosition","right",3,"disabled","click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","warn","matTooltip","Finalizar UPM","matTooltipPosition","left",3,"disabled","click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","primary","matTooltip","Iniciar Actualizacion","matTooltipPosition","right",3,"disabled","click"],["mat-flat-button","","color","warn","matTooltip","Finalizar UPM","matTooltipPosition","left",3,"disabled","click"],["aria-label","Home"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t._uU(5,"\xc1rea de Cartografo"),t.qZA()(),t.TgZ(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),t._uU(9,"Buscar"),t.qZA(),t.TgZ(10,"input",6,7),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA(),t.TgZ(12,"mat-icon",8),t._uU(13,"search"),t.qZA()()()(),t.YNc(14,ci,22,5,"div",9),t.qZA()()),2&e&&(t.xp6(7),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(6),t.Q6J("ngxPermissionsOnly",t.DdM(5,li)))},dependencies:[U.PC,_.KE,_.hX,_.R9,m.Nt,x.lW,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,D.gM,f.YE,f.nU,y.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;margin:.5rem;padding:0 .4rem;gap:1rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]});const wi=function(){return[5,10,25,100]};function Ui(i,e){if(1&i&&(t.TgZ(0,"div",25)(1,"table",26),t.ynx(2,27),t.YNc(3,_i,2,0,"th",28),t.YNc(4,gi,2,1,"td",29),t.BQk(),t.ynx(5,30),t.YNc(6,fi,2,0,"th",28),t.YNc(7,hi,2,1,"td",29),t.BQk(),t.ynx(8,31),t.YNc(9,bi,2,0,"th",28),t.YNc(10,vi,2,1,"td",29),t.BQk(),t.ynx(11,32),t.YNc(12,Ti,2,0,"th",33),t.YNc(13,xi,4,0,"td",29),t.BQk(),t.YNc(14,Ci,1,0,"tr",34),t.YNc(15,Zi,1,0,"tr",35),t.YNc(16,yi,3,1,"tr",36),t.qZA(),t._UZ(17,"br")(18,"mat-paginator",37),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("dataSource",o.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(4,wi))}}const Ai=function(){return["descargar-plantilla"]},lt=function(){return["asignar-upms-personal"]};class W{constructor(e,o,n,r){this.rolService=e,this.projectHomeService=o,this.projectService=n,this.excelService=r,this.users=[],this.data=[[1,2],[3,4]],this.displayedColumns=["rol","encargado","upm","options"],this.datos=[],this.dataFile=[],this.nameUpms=[],this.projectUserAssignment={usuario_id:0,proyecto_id:0},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by}ngOnInit(){let e=localStorage.getItem("id");Number(e)&&(this.projectUserAssignment.usuario_id=Number(e),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.projectUserAssignment.proyecto_id=o,this.idProject=o,this.getGroupsMinor(),this.cargarUpmChief()}))}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var e=this;return(0,h.Z)(function*(){e.rolService.getGroupsMinor(e.projectUserAssignment).subscribe(o=>{e.groups=o})})()}verPlantilla(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaUPMUsuario.png",imageWidth:460,imageHeight:200,imageAlt:"Ejemplo del archivo de carga"})}getUpmsAsignn(e){var o=this;return(0,h.Z)(function*(){let n=localStorage.getItem("id");o.nameUpms=[];let r=e.split(",");Number(o.idProject)&&o.projectHomeService.getUpmsAssgined({proyecto_id:o.idProject,usuario_id:n}).subscribe(a=>{a.forEach(c=>{o.nameUpms.push(c.upm)}),o.getUsersAssign(r[0],r[1])})})()}getUsersAssign(e,o){this.users=[];let n=localStorage.getItem("id");this.projectHomeService.getUsersAssigned({proyecto_id:this.idProject,rol_id:e,usuario_id:n}).subscribe(r=>{this.users=r,this.createFile(o)})}createFile(e){this.dataFile=[];for(let o=0;o<this.nameUpms.length;o++)this.dataFile.push({upm:this.nameUpms[o],codigo_usuario:"",nombres:"",apellidos:""});for(let o=0;o<this.users.length;o++)this.dataFile.push({upm:"",codigo_usuario:this.users[o].codigo_usuario,nombres:this.users[o].nombres,apellidos:this.users[o].apellidos});this.excelService.exportAsExcelFile(this.dataFile,"AsignacionUPMS"+e)}addFile(){var e=this;return(0,h.Z)(function*(){e.data=[];const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const n=new FileReader;n.onload=r=>{const c=P.ij(r.target.result,{type:"binary"});e.data=P.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),e.generateJson()},n.readAsBinaryString(o)}})()}generateJson(){var e=this;return(0,h.Z)(function*(){let o=[],n=[];e.data=e.data.filter(Boolean),e.data.forEach(r=>{r[0]&&r[1]&&o.push({upm:r[0],codigo_usuario:r[1],proyecto_id:e.idProject})}),o.shift(),o=o.filter(Boolean);for(let r=0;r<o.length;r++)for(let a=r+1;a<o.length;a++)null!=o[r]&&o[r].upm==o[a].upm&&o[r].codigo_inferior==o[a].codigo_inferior&&n.push(o[r].codigo_usuario,o[r].codigo_usuario);for(let r=0;r<o.length;r++)for(let a=r+1;a<o.length;a++)o[r].upm==o[a].upm&&n.push(o[r].upm);n.length>0?e.Toast.fire({icon:"error",title:"Hay UPMs Repetidos: "+n}):e.projectHomeService.assignChiefUpms(o).subscribe(r=>{1==r.status&&(e.cargarUpmChief(),e.Toast.fire({icon:"success",title:r.message}))})})()}cargarUpmChief(){let e=localStorage.getItem("id");this.projectHomeService.chargeUpmsChief({proyecto_id:this.idProject,usuario_id:e}).subscribe(o=>{this.dataSource=new s.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}}W.\u0275fac=function(e){return new(e||W)(t.Y36(I.RolService),t.Y36(w),t.Y36(z.Y),t.Y36(j))},W.\u0275cmp=t.Xpm({type:W,selectors:[["app-encargado-upms"]],viewQuery:function(e,o){if(1&e&&(t.Gf(v.NW,5),t.Gf(f.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.paginator=n.first),t.iGM(n=t.CRH())&&(o.sort=n.first)}},decls:38,vars:15,consts:[[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngxPermissionsOnly"],[1,"container_options"],["mat-flat-button","","color","accent","style","margin-right: 8px",4,"ngxPermissionsOnly"],[1,"upms"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",2,"margin-right","8px"],["mat-flat-button","","color","accent",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","rol"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","encargado"],["matColumnDef","upm"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-icon-button","","matTooltip","Ver Mapa"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Asignacion de UPMS"),t.qZA()(),t._UZ(3,"br")(4,"br"),t.TgZ(5,"div",1)(6,"div",2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Seleccione un Rol"),t.qZA(),t.TgZ(10,"mat-select",null,4),t.YNc(12,ui,2,2,"mat-option",5),t.qZA()(),t.YNc(13,mi,5,1,"div",6),t.qZA(),t.TgZ(14,"div",7)(15,"div"),t.YNc(16,pi,4,0,"button",8),t.qZA(),t.TgZ(17,"div",9),t.YNc(18,di,4,0,"button",10),t.qZA(),t.TgZ(19,"div")(20,"button",11),t.NdJ("click",function(){return o.verPlantilla()}),t.TgZ(21,"mat-icon"),t._uU(22,"remove_red_eye"),t.qZA(),t._uU(23," Ver ejemplo de archivo de carga "),t.qZA()()()(),t._UZ(24,"br"),t.TgZ(25,"div",12)(26,"div",13)(27,"div",14),t._UZ(28,"div",15),t.qZA(),t._UZ(29,"br"),t.TgZ(30,"mat-form-field",16)(31,"mat-label"),t._uU(32,"Buscar"),t.qZA(),t.TgZ(33,"input",17,18),t.NdJ("keyup",function(r){return o.applyFilter(r)}),t.qZA(),t.TgZ(35,"mat-icon",19),t._uU(36,"search"),t.qZA()(),t.YNc(37,Ui,19,5,"div",20),t.qZA()()),2&e&&(t.xp6(8),t.Udp("font-size",16,"px"),t.xp6(4),t.Q6J("ngForOf",o.groups),t.xp6(1),t.Q6J("ngxPermissionsOnly",t.DdM(11,Ai)),t.xp6(3),t.Q6J("ngxPermissionsOnly",t.DdM(12,lt)),t.xp6(2),t.Q6J("ngxPermissionsOnly",t.DdM(13,lt)),t.xp6(12),t.Udp("font-size",12,"px"),t.xp6(1),t.Udp("font-size",14,"px"),t.xp6(6),t.Q6J("ngxPermissionsOnly",t.DdM(14,lt)))},dependencies:[U.sg,_.KE,_.hX,_.R9,m.Nt,x.lW,x.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,p.Hw,v.NW,it.gD,st.ey,D.gM,f.YE,f.nU,y.gE],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}"]});const Pi=[{path:"",component:R},{path:"assignPersonal",component:V,canActivate:[y.DD],data:{permissions:{only:["asignar-personal"],redirectTo:"projectHome"}}},{path:"assignUpmChief",component:W,canActivate:[y.DD],data:{permissions:{only:["asignar-upms-personal"],redirectTo:"projectHome"}}},{path:"cartografo",component:X,canActivate:[y.DD],data:{permissions:{only:["ver-upms-cartografo"],redirectTo:"projectHome"}}},{path:"equipo-campo",component:Y},{path:"supervisores",component:J},{path:"assignUserSupervisor",component:M,canActivate:[y.DD],data:{permissions:{only:["asignar-usuario-supervisor"],redirectTo:"projectHome"}}}];class O{}O.\u0275fac=function(e){return new(e||O)},O.\u0275mod=t.oAB({type:O}),O.\u0275inj=t.cJS({imports:[ct.Bz.forChild(Pi),ct.Bz]});var Si=u(4657),qi=u(6338);class Q{}Q.\u0275fac=function(e){return new(e||Q)},Q.\u0275mod=t.oAB({type:Q}),Q.\u0275inj=t.cJS({imports:[U.ez,O,Si.M,nt._t,p.Ps,D.AV,it.LD,qi.ie,d.UX,y.VI]})},4327:function(rt,tt){var u,v;void 0!==(v="function"==typeof(u=function(){"use strict";function s(m,p,A){var g=new XMLHttpRequest;g.open("GET",m),g.responseType="blob",g.onload=function(){_(g.response,p,A)},g.onerror=function(){console.error("could not download file")},g.send()}function t(m){var p=new XMLHttpRequest;p.open("HEAD",m,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function N(m){try{m.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),m.dispatchEvent(p)}}var b="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,d=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=b.saveAs||("object"!=typeof window||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(m,p,A){var g=b.URL||b.webkitURL,Z=document.createElement("a");Z.download=p=p||m.name||"download",Z.rel="noopener","string"==typeof m?(Z.href=m,Z.origin===location.origin?N(Z):t(Z.href)?s(m,p,A):N(Z,Z.target="_blank")):(Z.href=g.createObjectURL(m),setTimeout(function(){g.revokeObjectURL(Z.href)},4e4),setTimeout(function(){N(Z)},0))}:"msSaveOrOpenBlob"in navigator?function(m,p,A){if(p=p||m.name||"download","string"!=typeof m)navigator.msSaveOrOpenBlob(function f(m,p){return typeof p>"u"?p={autoBom:!1}:"object"!=typeof p&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(m.type)?new Blob(["\ufeff",m],{type:m.type}):m}(m,A),p);else if(t(m))s(m,p,A);else{var g=document.createElement("a");g.href=m,g.target="_blank",setTimeout(function(){N(g)})}}:function(m,p,A,g){if((g=g||open("","_blank"))&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof m)return s(m,p,A);var Z="application/octet-stream"===m.type,at=/constructor/i.test(b.HTMLElement)||b.safari,et=/CriOS\/[\d]+/.test(navigator.userAgent);if((et||Z&&at||d)&&typeof FileReader<"u"){var B=new FileReader;B.onloadend=function(){var F=B.result;F=et?F:F.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=F:location=F,g=null},B.readAsDataURL(m)}else{var ot=b.URL||b.webkitURL,H=ot.createObjectURL(m);g?g.location=H:location.href=H,g=null,setTimeout(function(){ot.revokeObjectURL(H)},4e4)}});b.saveAs=_.saveAs=_,rt.exports=_})?u.apply(tt,[]):u)&&(rt.exports=v)}}]);