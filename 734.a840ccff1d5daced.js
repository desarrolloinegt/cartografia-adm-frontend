(self.webpackChunkcartografia_app=self.webpackChunkcartografia_app||[]).push([[734],{8734:(X,$,u)=>{"use strict";u.r($),u.d($,{FieldTeamDialogComponent:()=>q,FieldTeamPageComponent:()=>Y,HomeProjectPageComponent:()=>O,NewFieldTeamPageComponent:()=>k,ProjecHometModule:()=>M,ProjectRoutingModule:()=>D});var F=u(9132),T=u(5861),v=u(8739),h=u(6308),s=u(671),E=u(5226),l=u.n(E),C=u(574),e=u(4650),m=u(4839),p=u(8443);class f{constructor(t){this.apiService=t}getGroupsProject(t){return this.apiService.getById("obtenerRolesProyecto",t)}guardarJerarquias(t){return this.apiService.patch("jerarquias",t)}getIdProject(t){return this.apiService.getById("proyectoId",t)}assignChiefUpms(t){return this.apiService.store("asignarUpmPersonal",t)}chargeUpmsChief(t){return this.apiService.store("obtenerUpmPersonal",t)}getUpmsAssgined(t){return this.apiService.store("obtenerUpmsAsignados",t)}getChiefEmployee(t){return this.apiService.store("obtenerEncargadoEmpleado",t)}getUsersAssigned(t){return this.apiService.store("obtenerPersonalAsignado",t)}deleteAssingmentUsers(t){return this.apiService.patch("eliminarAsignacionPersonal",t)}assignPersonal(t){return this.apiService.store("asignarPersonal",t)}verDetalleSustitucion(t){return this.apiService.getById("detalleSustitucion",t)}supervisor(t){return this.apiService.store("detalleSupervisor",t)}cartografo(t){return this.apiService.store("detalleCartografo",t)}fieldTeam(t){return this.apiService.store("detalleFieldTeam",t)}}f.\u0275fac=function(t){return new(t||f)(e.LFG(p.s))},f.\u0275prov=e.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"});var d=u(8049),x=u(4327);class y{constructor(){}exportAsExcelFile(t,o){const n={Sheets:{data:C.P6.json_to_sheet(t)},SheetNames:["data"]},a=C.cW(n,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(a,o)}saveAsExcelFile(t,o){const r=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});x.saveAs(r,o+"_export_"+(new Date).getTime()+".xlsx")}}y.\u0275fac=function(t){return new(t||y)},y.\u0275prov=e.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"});var A=u(6895),_=u(9549),Z=u(4144),w=u(4859),N=u(7392),V=u(4385),ee=u(3238),J=u(266),U=u(4954);function se(i,t){if(1&i&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.Q6J("value",o.id+","+o.nombre),e.xp6(1),e.hij(" ",o.nombre," ")}}function ce(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(o);const n=e.oxw(),a=e.MAs(11);return e.KtG(n.getUsers(a.value))}),e.TgZ(1,"mat-icon"),e._uU(2,"arrow_downward"),e.qZA(),e._uU(3," Descargar Plantilla "),e.qZA()}if(2&i){e.oxw();const o=e.MAs(11);e.Q6J("disabled",!o.value)}}function le(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.addFile())}),e.TgZ(1,"mat-icon"),e._uU(2,"arrow_upward"),e.qZA(),e._uU(3," Cargar Archivo "),e.qZA()}}function ue(i,t){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Encargado"),e.qZA())}function me(i,t){if(1&i&&(e.TgZ(0,"td",34),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.encargado)}}function pe(i,t){1&i&&(e.TgZ(0,"th",33),e._uU(1,"Personal"),e.qZA())}function de(i,t){if(1&i&&(e.TgZ(0,"td",34),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.empleado)}}function _e(i,t){1&i&&(e.TgZ(0,"th",35),e._uU(1,"Opciones"),e.qZA())}function ge(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"td",34)(1,"button",36),e.NdJ("click",function(){const a=e.CHM(o).$implicit,c=e.oxw(2);return e.KtG(c.deleteAsignation(a.encargado_id,a.empleado_id,a.encargado,a.empleado))}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()()}}function fe(i,t){1&i&&e._UZ(0,"tr",37)}function he(i,t){1&i&&e._UZ(0,"tr",38)}function Te(i,t){if(1&i&&(e.TgZ(0,"tr",39)(1,"td",40),e._uU(2),e.qZA()()),2&i){e.oxw(2);const o=e.MAs(33);e.xp6(2),e.hij(' No hay resultados de "',o.value,'" ')}}const be=function(){return[5,10,25,100]};function ve(i,t){if(1&i&&(e.TgZ(0,"div",21)(1,"table",22),e.ynx(2,23),e.YNc(3,ue,2,0,"th",24),e.YNc(4,me,2,1,"td",25),e.BQk(),e.ynx(5,26),e.YNc(6,pe,2,0,"th",24),e.YNc(7,de,2,1,"td",25),e.BQk(),e.ynx(8,27),e.YNc(9,_e,2,0,"th",28),e.YNc(10,ge,4,0,"td",25),e.BQk(),e.YNc(11,fe,1,0,"tr",29),e.YNc(12,he,1,0,"tr",30),e.YNc(13,Te,3,1,"tr",31),e.qZA(),e._UZ(14,"br")(15,"mat-paginator",32),e.qZA()),2&i){const o=e.oxw();e.xp6(1),e.Q6J("dataSource",o.dataSource),e.xp6(10),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(3),e.Q6J("pageSizeOptions",e.DdM(4,be))}}const Ce=function(){return["descargar-plantilla"]},oe=function(){return["asignar-personal"]};class G{constructor(t,o,r,n){this.groupService=t,this.projectHomeService=o,this.projectService=r,this.excelService=n,this.data=[[1,2],[3,4]],this.users=[],this.usernames=[],this.projectUserAssignment={usuario_id:0,proyecto_id:0},this.displayedColumns=["encargado","empleado","options"],this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by}ngOnInit(){let t=localStorage.getItem("id");Number(t)&&(this.projectUserAssignment.usuario_id=Number(t),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.projectUserAssignment.proyecto_id=o,this.idProject=o,this.getGroupsMinor(),this.getChiefEmployee()})),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var t=this;return(0,T.Z)(function*(){t.groupService.getGroupsMinor(t.projectUserAssignment).subscribe(o=>{t.groups=o})})()}getUsers(t){let o=Number(localStorage.getItem("id")),r=t.split(",");this.users=[],this.usernames=[],this.projectHomeService.getUsersAssigned({rol_id:Number(r[0]),proyecto_id:this.idProject,usuario_id:o}).subscribe(n=>{this.usernames=n,this.usernames.forEach(a=>{this.users.push({encargado:"",codigo_usuario:a.codigo_usuario,nombres:a.nombres,apellidos:a.apellidos})}),this.excelService.exportAsExcelFile(this.users,r[1])})}addFile(){var t=this;return(0,T.Z)(function*(){const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const r=new FileReader;r.onload=n=>{const c=C.ij(n.target.result,{type:"binary"});t.data=C.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),t.generateJson()},r.readAsBinaryString(o)}})()}generateJson(){var t=this;return(0,T.Z)(function*(){let o=Number(localStorage.getItem("id"));if(Number(o)){let r=[],n=[];t.data.forEach(a=>{a[0]&&a[1]&&r.push({codigo_superior:a[0],codigo_inferior:a[1],proyecto_id:t.idProject})}),r.shift(),r=r.filter(Boolean);for(let a=0;a<r.length;a++)for(let c=a+1;c<r.length;c++)null!=r[a]&&r[a].codigo_superior==r[c].codigo_superior&&r[a].codigo_inferior==r[c].codigo_inferior&&n.push(r[a].codigo_superior,r[a].codigo_inferior);for(let a=0;a<r.length;a++)for(let c=a+1;c<r.length;c++)r[a].codigo_inferior==r[c].codigo_inferior&&n.push(r[a].codigo_inferior);n.length>0?t.Toast.fire({icon:"error",title:"Hay filas repetidas: "+n}):t.projectHomeService.assignPersonal(r).subscribe(a=>{1==a.status&&(t.Toast.fire({icon:"success",title:a.message}),t.getChiefEmployee())})}})()}getChiefEmployee(){let t=Number(localStorage.getItem("id"));this.projectHomeService.getChiefEmployee({usuario_id:t,proyecto_id:this.idProject}).subscribe(o=>{this.dataSource=new s.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}verPlantilla(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaPersonal.png",imageWidth:375,imageHeight:250,imageAlt:"Ejemplo del archivo de carga"})}deleteAsignation(t,o,r,n){l().fire({title:"Esta accion eliminara todas las asignaciones de personal y upms en la que se encuentre: "+n+" \xbfEsta seguro que desea eliminar la asignacion:?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No"}).then(a=>{a.isConfirmed?this.projectHomeService.deleteAssingmentUsers({encargado_id:t,empleado_id:o,proyecto_id:this.idProject}).subscribe(c=>{1==c.status&&(l().fire("Ok",c.message,"success"),this.getChiefEmployee())}):a.isDenied&&l().fire("Cambios no guardados","","info")})}}G.\u0275fac=function(t){return new(t||G)(e.Y36(m.GroupService),e.Y36(f),e.Y36(d.Y),e.Y36(y))},G.\u0275cmp=e.Xpm({type:G,selectors:[["app-asignar-personal"]],viewQuery:function(t,o){if(1&t&&(e.Gf(v.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},decls:37,vars:13,consts:[[1,"title"],[1,"container"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","accent",3,"disabled","click",4,"ngxPermissionsOnly"],[1,"upms"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","encargado"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","empleado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-icon-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Asignacion de Personal"),e.qZA()(),e._UZ(3,"br")(4,"br"),e.TgZ(5,"div",1)(6,"div")(7,"mat-form-field",2)(8,"mat-label"),e._uU(9,"Seleccione un Rol"),e.qZA(),e.TgZ(10,"mat-select",null,3),e.YNc(12,se,2,2,"mat-option",4),e.qZA()()(),e.TgZ(13,"div")(14,"div"),e.YNc(15,ce,4,1,"button",5),e.qZA(),e._UZ(16,"br"),e.TgZ(17,"div",6),e.YNc(18,le,4,0,"button",7),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"div")(21,"button",8),e.NdJ("click",function(){return o.verPlantilla()}),e.TgZ(22,"mat-icon"),e._uU(23,"remove_red_eye"),e.qZA(),e._uU(24," Ver ejemplo de archivo de carga "),e.qZA()()()(),e.TgZ(25,"div",9)(26,"div",10)(27,"div",11)(28,"div",12)(29,"mat-form-field",13)(30,"mat-label"),e._uU(31,"Buscar"),e.qZA(),e.TgZ(32,"input",14,15),e.NdJ("keyup",function(n){return o.applyFilter(n)}),e.qZA(),e.TgZ(34,"mat-icon",16),e._uU(35,"search"),e.qZA()()()(),e.YNc(36,ve,16,5,"div",17),e.qZA()()),2&t&&(e.xp6(8),e.Udp("font-size",16,"px"),e.xp6(4),e.Q6J("ngForOf",o.groups),e.xp6(3),e.Q6J("ngxPermissionsOnly",e.DdM(10,Ce)),e.xp6(3),e.Q6J("ngxPermissionsOnly",e.DdM(11,oe)),e.xp6(11),e.Udp("font-size",12,"px"),e.xp6(1),e.Udp("font-size",14,"px"),e.xp6(6),e.Q6J("ngxPermissionsOnly",e.DdM(12,oe)))},dependencies:[A.sg,_.KE,_.hX,_.R9,Z.Nt,w.lW,w.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,N.Hw,v.NW,V.gD,ee.ey,J.gM,h.YE,h.nU,U.gE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}"]});var g=u(4006),S=u(7274);function xe(i,t){1&i&&(e.TgZ(0,"th",25),e._uU(1,"Departamento"),e.qZA())}function Ze(i,t){if(1&i&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.departamento)}}function ye(i,t){1&i&&(e.TgZ(0,"th",25),e._uU(1,"Municipio"),e.qZA())}function we(i,t){if(1&i&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.municipio)}}function Ue(i,t){1&i&&(e.TgZ(0,"th",25),e._uU(1,"UPM"),e.qZA())}function Ae(i,t){if(1&i&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.upm)}}function Pe(i,t){1&i&&(e.TgZ(0,"th",25),e._uU(1,"Estado"),e.qZA())}function Se(i,t){if(1&i&&(e.TgZ(0,"button",29),e._uU(1),e.qZA()),2&i){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.estado," ")}}function je(i,t){if(1&i&&(e.TgZ(0,"button",30),e._uU(1),e.qZA()),2&i){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.estado," ")}}function Ne(i,t){if(1&i&&(e.TgZ(0,"td",26),e.YNc(1,Se,2,1,"button",27),e.YNc(2,je,2,1,"button",28),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Q6J("ngIf","Cargado"==o.estado),e.xp6(1),e.Q6J("ngIf","Sustituido"==o.estado)}}function qe(i,t){1&i&&e._UZ(0,"th",31)}function De(i,t){1&i&&(e.TgZ(0,"button",34)(1,"mat-icon"),e._uU(2,"power_settings_new"),e.qZA()())}function Fe(i,t){1&i&&(e.TgZ(0,"button",35)(1,"mat-icon",36),e._uU(2,"done"),e.qZA()())}const Ee=function(){return["inicializar-actualizacion"]},ke=function(){return["finalizar-actualizacion"]};function Ye(i,t){1&i&&(e.TgZ(0,"td",26)(1,"div"),e.YNc(2,De,3,0,"button",32),e.qZA(),e.TgZ(3,"div"),e.YNc(4,Fe,3,0,"button",33),e.qZA()()),2&i&&(e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(2,Ee)),e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(3,ke)))}function Oe(i,t){1&i&&e._UZ(0,"tr",37)}function Me(i,t){1&i&&e._UZ(0,"tr",38)}function Je(i,t){if(1&i&&(e.TgZ(0,"tr",39)(1,"td",40),e._uU(2),e.qZA()()),2&i){e.oxw(2);const o=e.MAs(11);e.xp6(2),e.hij(' No hay resultados de "',o.value,'" ')}}const Ge=function(){return[10,25,100]};function Qe(i,t){if(1&i&&(e.TgZ(0,"div",10)(1,"table",11),e.ynx(2,12),e.YNc(3,xe,2,0,"th",13),e.YNc(4,Ze,2,1,"td",14),e.BQk(),e.ynx(5,15),e.YNc(6,ye,2,0,"th",13),e.YNc(7,we,2,1,"td",14),e.BQk(),e.ynx(8,16),e.YNc(9,Ue,2,0,"th",13),e.YNc(10,Ae,2,1,"td",14),e.BQk(),e.ynx(11,17),e.YNc(12,Pe,2,0,"th",13),e.YNc(13,Ne,3,2,"td",14),e.BQk(),e.ynx(14,18),e.YNc(15,qe,1,0,"th",19),e.YNc(16,Ye,5,4,"td",14),e.BQk(),e.YNc(17,Oe,1,0,"tr",20),e.YNc(18,Me,1,0,"tr",21),e.YNc(19,Je,3,1,"tr",22),e.qZA(),e._UZ(20,"mat-paginator",23,24),e.qZA()),2&i){const o=e.oxw();e.xp6(1),e.Q6J("dataSource",o.dataSource),e.xp6(16),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(2),e.Q6J("pageSizeOptions",e.DdM(4,Ge))}}const Re=function(){return["ver-upms-cartografo"]};class Q{constructor(t,o,r,n){this.formBuilder=t,this.dialog=o,this.homeProjectService=r,this.projectService=n,this.displayedColumns=["departamento","municipio","upm","estado","options"],this.data=[],this.assignment={proyecto_id:0,upms:[]},this.upmDataSust={proyecto_id:0,upm_nuevo:"",upm_anterior:0,descripcion:"",usuario_id:0},this.dataSource=new s.by,this.buildForm()}buildForm(){this.formUpms=this.formBuilder.group({file:[""]})}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(t=>{this.idProject=t,this.cargarUpmsAsignadas()})}cargarUpmsAsignadas(){0!=this.idProject&&this.projectService.getUpmCartographer({proyecto_id:this.idProject}).subscribe(t=>{this.dataSource=new s.by(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}function Be(i,t){if(1&i&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.Q6J("value",o.id+","+o.nombre),e.xp6(1),e.hij(" ",o.nombre," ")}}function He(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"div")(1,"button",20),e.NdJ("click",function(){e.CHM(o);const n=e.oxw(),a=e.MAs(11);return e.KtG(n.getUpmsAsignn(a.value))}),e.TgZ(2,"mat-icon"),e._uU(3,"arrow_downward"),e.qZA(),e._uU(4," Descargar Plantilla "),e.qZA()()}if(2&i){e.oxw();const o=e.MAs(11);e.xp6(1),e.Q6J("disabled",!o.value)}}function Ie(i,t){1&i&&(e.TgZ(0,"button",21)(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," Agregar "),e.qZA())}function ze(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.addFile())}),e.TgZ(1,"mat-icon"),e._uU(2,"arrow_upward"),e.qZA(),e._uU(3," Cargar Archivo "),e.qZA()}}function $e(i,t){1&i&&(e.TgZ(0,"th",36),e._uU(1,"Rol"),e.qZA())}function Le(i,t){if(1&i&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.rol)}}function Ke(i,t){1&i&&(e.TgZ(0,"th",36),e._uU(1,"Encargado"),e.qZA())}function Xe(i,t){if(1&i&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.encargado)}}function We(i,t){1&i&&(e.TgZ(0,"th",36),e._uU(1,"UPM"),e.qZA())}function Ve(i,t){if(1&i&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.upm)}}function et(i,t){1&i&&(e.TgZ(0,"th",38),e._uU(1,"Opciones"),e.qZA())}function tt(i,t){1&i&&e._UZ(0,"td",37)}function ot(i,t){1&i&&e._UZ(0,"tr",39)}function it(i,t){1&i&&e._UZ(0,"tr",40)}function rt(i,t){if(1&i&&(e.TgZ(0,"tr",41)(1,"td",42),e._uU(2),e.qZA()()),2&i){e.oxw(2);const o=e.MAs(36);e.xp6(2),e.hij(' No hay resultados de "',o.value,'" ')}}Q.\u0275fac=function(t){return new(t||Q)(e.Y36(g.qu),e.Y36(S.uw),e.Y36(f),e.Y36(d.Y))},Q.\u0275cmp=e.Xpm({type:Q,selectors:[["app-cartographer"]],viewQuery:function(t,o){if(1&t&&(e.Gf(v.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},decls:15,vars:6,consts:[[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-6-12","col-md-6-12"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearance","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["paginator",""],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-stroked-button","","color","primary","class","estado",4,"ngIf"],["mat-stroked-button","","color","warn","class","estado",4,"ngIf"],["mat-stroked-button","","color","primary",1,"estado"],["mat-stroked-button","","color","warn",1,"estado"],["mat-header-cell",""],["matTooltip","Iniciar Actualizacion","matTooltipPosition","right",4,"ngxPermissionsOnly"],["matTooltip","Finalizar UPM","matTooltipPosition","left",4,"ngxPermissionsOnly"],["matTooltip","Iniciar Actualizacion","matTooltipPosition","right"],["matTooltip","Finalizar UPM","matTooltipPosition","left"],["aria-label","Home"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e._uU(5,"\xc1rea de Cartografo"),e.qZA()(),e.TgZ(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),e._uU(9,"Buscar"),e.qZA(),e.TgZ(10,"input",6,7),e.NdJ("keyup",function(n){return o.applyFilter(n)}),e.qZA(),e.TgZ(12,"mat-icon",8),e._uU(13,"search"),e.qZA()()()(),e.YNc(14,Qe,22,5,"div",9),e.qZA()()),2&t&&(e.xp6(7),e.Udp("font-size",12,"px"),e.xp6(1),e.Udp("font-size",14,"px"),e.xp6(6),e.Q6J("ngxPermissionsOnly",e.DdM(5,Re)))},dependencies:[A.O5,_.KE,_.hX,_.R9,Z.Nt,w.lW,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,N.Hw,v.NW,J.gM,h.YE,h.nU,U.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;margin:.5rem;padding:0 .4rem;gap:1rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]});const nt=function(){return[5,10,25,100]};function at(i,t){if(1&i&&(e.TgZ(0,"div",23)(1,"table",24),e.ynx(2,25),e.YNc(3,$e,2,0,"th",26),e.YNc(4,Le,2,1,"td",27),e.BQk(),e.ynx(5,28),e.YNc(6,Ke,2,0,"th",26),e.YNc(7,Xe,2,1,"td",27),e.BQk(),e.ynx(8,29),e.YNc(9,We,2,0,"th",26),e.YNc(10,Ve,2,1,"td",27),e.BQk(),e.ynx(11,30),e.YNc(12,et,2,0,"th",31),e.YNc(13,tt,1,0,"td",27),e.BQk(),e.YNc(14,ot,1,0,"tr",32),e.YNc(15,it,1,0,"tr",33),e.YNc(16,rt,3,1,"tr",34),e.qZA(),e._UZ(17,"br")(18,"mat-paginator",35),e.qZA()),2&i){const o=e.oxw();e.xp6(1),e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(3),e.Q6J("pageSizeOptions",e.DdM(4,nt))}}const st=function(){return["descargar-plantilla"]},te=function(){return["asignar-upms-personal"]};class R{constructor(t,o,r,n){this.groupService=t,this.projectHomeService=o,this.projectService=r,this.excelService=n,this.users=[],this.data=[[1,2],[3,4]],this.displayedColumns=["rol","encargado","upm","options"],this.datos=[],this.dataFile=[],this.nameUpms=[],this.projectUserAssignment={usuario_id:0,proyecto_id:0},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",l().stopTimer),a.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by}ngOnInit(){let t=localStorage.getItem("id");Number(t)&&(this.projectUserAssignment.usuario_id=Number(t),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.projectUserAssignment.proyecto_id=o,this.idProject=o,this.getGroupsMinor(),this.cargarUpmChief()}))}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var t=this;return(0,T.Z)(function*(){t.groupService.getGroupsMinor(t.projectUserAssignment).subscribe(o=>{t.groups=o})})()}verPlantilla(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaUPMUsuario.png",imageWidth:460,imageHeight:200,imageAlt:"Ejemplo del archivo de carga"})}getUpmsAsignn(t){var o=this;return(0,T.Z)(function*(){let r=localStorage.getItem("id");o.nameUpms=[];let n=t.split(",");Number(o.idProject)&&o.projectHomeService.getUpmsAssgined({proyecto_id:o.idProject,usuario_id:r}).subscribe(a=>{a.forEach(c=>{o.nameUpms.push(c.upm)}),o.getUsersAssign(n[0],n[1])})})()}getUsersAssign(t,o){this.users=[];let r=localStorage.getItem("id");this.projectHomeService.getUsersAssigned({proyecto_id:this.idProject,rol_id:t,usuario_id:r}).subscribe(n=>{this.users=n,this.createFile(o)})}createFile(t){this.dataFile=[];for(let o=0;o<this.nameUpms.length;o++)this.dataFile.push({upm:this.nameUpms[o],codigo_usuario:"",nombres:"",apellidos:""});for(let o=0;o<this.users.length;o++)this.dataFile.push({codigo_usuario:this.users[o].codigo_usuario,nombres:this.users[o].nombres,apellidos:this.users[o].apellidos});this.excelService.exportAsExcelFile(this.dataFile,"AsignacionUPMS"+t)}addFile(){var t=this;return(0,T.Z)(function*(){t.data=[];const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const r=new FileReader;r.onload=n=>{const c=C.ij(n.target.result,{type:"binary"});t.data=C.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),t.generateJson()},r.readAsBinaryString(o)}})()}generateJson(){var t=this;return(0,T.Z)(function*(){let o=[],r=[];t.data=t.data.filter(Boolean),t.data.forEach(n=>{n[0]&&n[1]&&o.push({upm:n[0],codigo_usuario:n[1],proyecto_id:t.idProject})}),o.shift(),o=o.filter(Boolean);for(let n=0;n<o.length;n++)for(let a=n+1;a<o.length;a++)null!=o[n]&&o[n].upm==o[a].upm&&o[n].codigo_inferior==o[a].codigo_inferior&&r.push(o[n].codigo_usuario,o[n].codigo_usuario);for(let n=0;n<o.length;n++)for(let a=n+1;a<o.length;a++)o[n].upm==o[a].upm&&r.push(o[n].upm);r.length>0?t.Toast.fire({icon:"error",title:"Hay UPMs Repetidos: "+r}):t.projectHomeService.assignChiefUpms(o).subscribe(n=>{1==n.status&&(t.cargarUpmChief(),t.Toast.fire({icon:"success",title:n.message}))})})()}cargarUpmChief(){let t=localStorage.getItem("id");this.projectHomeService.chargeUpmsChief({proyecto_id:this.idProject,usuario_id:t}).subscribe(o=>{this.dataSource=new s.by(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}}R.\u0275fac=function(t){return new(t||R)(e.Y36(m.GroupService),e.Y36(f),e.Y36(d.Y),e.Y36(y))},R.\u0275cmp=e.Xpm({type:R,selectors:[["app-encargado-upms"]],viewQuery:function(t,o){if(1&t&&(e.Gf(v.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},decls:40,vars:15,consts:[[1,"title"],[1,"container"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent","style","margin-right: 8px",4,"ngxPermissionsOnly"],[1,"upms"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],["class","mat-elevation-z8",4,"ngxPermissionsOnly"],[3,"value"],["mat-flat-button","","color","accent",3,"disabled","click"],["mat-flat-button","","color","accent",2,"margin-right","8px"],["mat-flat-button","","color","accent",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","rol"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","encargado"],["matColumnDef","upm"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cell-pointer"],["mat-header-cell",""],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Asignacion de UPMS"),e.qZA()(),e._UZ(3,"br")(4,"br"),e.TgZ(5,"div",1)(6,"div")(7,"mat-form-field",2)(8,"mat-label"),e._uU(9,"Seleccione un Rol"),e.qZA(),e.TgZ(10,"mat-select",null,3),e.YNc(12,Be,2,2,"mat-option",4),e.qZA()()(),e.TgZ(13,"div"),e.YNc(14,He,5,1,"div",5),e._UZ(15,"br"),e.TgZ(16,"div"),e.YNc(17,Ie,4,0,"button",6),e.qZA(),e._UZ(18,"br"),e.TgZ(19,"div",7),e.YNc(20,ze,4,0,"button",8),e.qZA(),e._UZ(21,"br"),e.TgZ(22,"div")(23,"button",9),e.NdJ("click",function(){return o.verPlantilla()}),e.TgZ(24,"mat-icon"),e._uU(25,"remove_red_eye"),e.qZA(),e._uU(26," Ver ejemplo de archivo de carga "),e.qZA()()()(),e._UZ(27,"br"),e.TgZ(28,"div",10)(29,"div",11)(30,"div",12)(31,"div",13)(32,"mat-form-field",14)(33,"mat-label"),e._uU(34,"Buscar"),e.qZA(),e.TgZ(35,"input",15,16),e.NdJ("keyup",function(n){return o.applyFilter(n)}),e.qZA(),e.TgZ(37,"mat-icon",17),e._uU(38,"search"),e.qZA()()()(),e.YNc(39,at,19,5,"div",18),e.qZA()()),2&t&&(e.xp6(8),e.Udp("font-size",16,"px"),e.xp6(4),e.Q6J("ngForOf",o.groups),e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(11,st)),e.xp6(3),e.Q6J("ngxPermissionsOnly",e.DdM(12,te)),e.xp6(3),e.Q6J("ngxPermissionsOnly",e.DdM(13,te)),e.xp6(12),e.Udp("font-size",12,"px"),e.xp6(1),e.Udp("font-size",14,"px"),e.xp6(6),e.Q6J("ngxPermissionsOnly",e.DdM(14,te)))},dependencies:[A.sg,_.KE,_.hX,_.R9,Z.Nt,w.lW,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,N.Hw,v.NW,V.gD,ee.ey,h.YE,h.nU,U.gE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}"]});class B{}B.\u0275fac=function(t){return new(t||B)},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-supervisor"]],decls:2,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"p"),e._uU(1,"supervisor works!"),e.qZA())}});class j{constructor(t){this.apiService=t}getFieldTeam(t){return this.apiService.store("equipos",t)}createFieldTeam(t){return this.apiService.store("equipo",t)}editFieldTeam(t){return this.apiService.patch("equipo/edit",t)}desactiveFielTeam(t){return this.apiService.desactive("vehiculo",t)}getUsersTeam(t){return this.apiService.store("miembrosEquipo",t)}}function ct(i,t){1&i&&(e.TgZ(0,"th",22),e._uU(1,"Codigo de usuario"),e.qZA())}function lt(i,t){if(1&i&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.hij(" ",o.codigo_usuario," ")}}function ut(i,t){1&i&&(e.TgZ(0,"th",22),e._uU(1,"Nombres"),e.qZA())}function mt(i,t){if(1&i&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.hij(" ",o.nombres," ")}}function pt(i,t){1&i&&(e.TgZ(0,"th",22),e._uU(1,"Apellidos"),e.qZA())}function dt(i,t){if(1&i&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.hij(" ",o.apellidos," ")}}function _t(i,t){1&i&&e._UZ(0,"th",22)}function gt(i,t){1&i&&e._UZ(0,"td",23)}function ft(i,t){1&i&&e._UZ(0,"tr",24)}function ht(i,t){1&i&&e._UZ(0,"tr",25)}function Tt(i,t){if(1&i&&(e.TgZ(0,"tr",26)(1,"td",27),e._uU(2),e.qZA()()),2&i){e.oxw();const o=e.MAs(13);e.xp6(2),e.hij(' No hay resultados de "',o.value,'" ')}}j.\u0275fac=function(t){return new(t||j)(e.LFG(p.s))},j.\u0275prov=e.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"});const bt=function(){return[5,10,25,100]};class q{constructor(t,o,r,n){this.fieldTeamService=t,this.dialogRef=o,this.data=r,this.formBuilder=n,this.displayedColumns=["codigo_usuario","nombres","apellidos","options"],this.dataSource=new s.by}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}ngOnInit(){this.chargetUsers()}chargetUsers(){this.dataSource=new s.by(this.data),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}}function vt(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Equipo de Campo es "),e.TgZ(2,"strong"),e._uU(3,"requerido"),e.qZA()())}function Ct(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Supervisor de Equipo de Campo es "),e.TgZ(2,"strong"),e._uU(3,"requerido"),e.qZA()())}function xt(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Nombre del vehiculo es "),e.TgZ(2,"strong"),e._uU(3,"requerido"),e.qZA()())}function Zt(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Placa del vehiculo es "),e.TgZ(2,"strong"),e._uU(3,"requerida"),e.qZA()())}function yt(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Placa debe tener la siguiente secuencia: "),e.TgZ(2,"strong"),e._uU(3,"A123ABC"),e.qZA()())}function wt(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Modelo del vehiculo es "),e.TgZ(2,"strong"),e._uU(3,"requerido"),e.qZA()())}function Ut(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.createFieldTeam())}),e._uU(1," Guardar Vehiculo "),e.qZA()}if(2&i){const o=e.oxw();e.Q6J("disabled",!o.fieldTeamForm.valid)}}function At(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.cancelAdd())}),e._uU(1," Cancelar "),e.qZA()}}q.\u0275fac=function(t){return new(t||q)(e.Y36(j),e.Y36(S.so),e.Y36(S.WI),e.Y36(g.qu))},q.\u0275cmp=e.Xpm({type:q,selectors:[["app-field-team-dialog"]],viewQuery:function(t,o){if(1&t&&(e.Gf(v.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},decls:35,vars:10,consts:[[1,"card"],["mat-dialog-title",""],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevatioin-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","codigo_usuario"],["mat-header-cell","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","nombres"],["matColumnDef","apellidos"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell","",1,"cell-pointer"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2),e.qZA(),e._UZ(3,"br")(4,"br"),e.qZA(),e.TgZ(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),e._uU(11,"Buscar"),e.qZA(),e.TgZ(12,"input",7,8),e.NdJ("keyup",function(n){return o.applyFilter(n)}),e.qZA(),e.TgZ(14,"mat-icon",9),e._uU(15,"search"),e.qZA()()()(),e.TgZ(16,"div",10)(17,"table",11),e.ynx(18,12),e.YNc(19,ct,2,0,"th",13),e.YNc(20,lt,2,1,"td",14),e.BQk(),e.ynx(21,15),e.YNc(22,ut,2,0,"th",13),e.YNc(23,mt,2,1,"td",14),e.BQk(),e.ynx(24,16),e.YNc(25,pt,2,0,"th",13),e.YNc(26,dt,2,1,"td",14),e.BQk(),e.ynx(27,17),e.YNc(28,_t,1,0,"th",13),e.YNc(29,gt,1,0,"td",14),e.BQk(),e.YNc(30,ft,1,0,"tr",18),e.YNc(31,ht,1,0,"tr",19),e.YNc(32,Tt,3,1,"tr",20),e.qZA(),e._UZ(33,"br")(34,"mat-paginator",21),e.qZA()()()),2&t&&(e.xp6(2),e.hij("Miembros: ",o.data.modelo,""),e.xp6(7),e.Udp("font-size",12,"px"),e.xp6(1),e.Udp("font-size",14,"px"),e.xp6(7),e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(3),e.Q6J("pageSizeOptions",e.DdM(9,bt)))},dependencies:[_.KE,_.hX,_.R9,Z.Nt,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,N.Hw,v.NW,h.YE]});const ie=function(){return["crear-equipo"]};class k{constructor(t,o,r){this.fieldTeamService=t,this.formBuilder=o,this.dialogRef=r,this.buildForm()}buildForm(){this.fieldTeamForm=this.formBuilder.group({equipo:["",g.kI.required],supervisor:["",g.kI.required],vehiculo:["",g.kI.required],placa:["",[g.kI.required,g.kI.pattern(/^[A-Z]{1}([0-9]){3}[A-Z]{3}$/)]],modelo:["",g.kI.required]})}get equipo(){return this.fieldTeamForm.get("equipo")}get supervisor(){return this.fieldTeamForm.get("supervisor")}get vehiculo(){return this.fieldTeamForm.get("vehiculo")}get placa(){return this.fieldTeamForm.get("placa")}get modelo(){return this.fieldTeamForm.get("modelo")}submit(){}createFieldTeam(){this.fieldTeamForm.valid&&this.fieldTeamService.createFieldTeam(this.fieldTeamForm.value).subscribe(t=>{1==t.status&&(l().fire("Ok!",t.message,"success"),this.dialogRef.close(1))},t=>{console.log(t)})}cancelAdd(){this.dialogRef.close()}}function Pt(i,t){if(1&i&&(e.TgZ(0,"mat-option",30),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.Q6J("value",o.id+","+o.nombre),e.xp6(1),e.hij(" ",o.nombre," ")}}function St(i,t){1&i&&(e.TgZ(0,"th",31),e._uU(1,"Supervisor"),e.qZA())}function jt(i,t){if(1&i&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.AsE(" ",o.nombres," ",o.apellidos," ")}}function Nt(i,t){1&i&&(e.TgZ(0,"th",31),e._uU(1,"Vehiculo"),e.qZA())}function qt(i,t){if(1&i&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.hij(" ",o.modelo," ")}}function Dt(i,t){1&i&&(e.TgZ(0,"th",31),e._uU(1,"Placa"),e.qZA())}function Ft(i,t){if(1&i&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.hij(" ",o.year," ")}}function Et(i,t){1&i&&e._UZ(0,"th",31)}function kt(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"td",32)(1,"button",33),e.NdJ("click",function(){const a=e.CHM(o).$implicit,c=e.oxw();return e.KtG(c.seeTeam(a.id))}),e.TgZ(2,"mat-icon"),e._uU(3,"people_outline"),e.qZA()()()}}function Yt(i,t){1&i&&e._UZ(0,"tr",34)}function Ot(i,t){1&i&&e._UZ(0,"tr",35)}function Mt(i,t){if(1&i&&(e.TgZ(0,"tr",36)(1,"td",37),e._uU(2),e.qZA()()),2&i){e.oxw();const o=e.MAs(42);e.xp6(2),e.hij(' No hay resultados de "',o.value,'" ')}}k.\u0275fac=function(t){return new(t||k)(e.Y36(j),e.Y36(g.qu),e.Y36(S.so))},k.\u0275cmp=e.Xpm({type:k,selectors:[["app-new-field-team-page"]],decls:38,vars:21,consts:[[1,"card"],[1,"card-body"],[3,"formGroup","submit"],[1,"form-group"],["appearance","outline",1,"full-width-input"],["type","text","formControlName","equipo","matInput","","placeholder","...","required","",1,"form-control"],[4,"ngIf"],["type","text","formControlName","supervisor","matInput","","placeholder","Juan P\xe9rez","required","",1,"form-control"],["type","text","formControlName","vehiculo","matInput","","placeholder","Carro, Cami\xf3n, Pickup","required","",1,"form-control"],["type","text","formControlName","placa","matInput","","placeholder","P216FMV","required","",1,"form-control"],["type","text","formControlName","modelo","placeholder","BMW X5","matInput","","required","",1,"form-control"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click",4,"ngxPermissionsOnly"],["type","submit","mat-stroked-button","","color","warn",3,"click",4,"ngxPermissionsOnly"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","submit","mat-stroked-button","","color","warn",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("submit",function(){return o.submit()}),e.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),e._uU(6,"Ingrese Equipo de Campo"),e.qZA(),e._UZ(7,"input",5),e.YNc(8,vt,4,0,"mat-error",6),e.qZA()(),e.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),e._uU(12,"Ingrese Supervisor"),e.qZA(),e._UZ(13,"input",7),e.YNc(14,Ct,4,0,"mat-error",6),e.qZA()(),e.TgZ(15,"div",3)(16,"mat-form-field",4)(17,"mat-label"),e._uU(18,"Ingrese el Nombre del Vehiculo"),e.qZA(),e._UZ(19,"input",8),e.YNc(20,xt,4,0,"mat-error",6),e.qZA()(),e.TgZ(21,"div",3)(22,"mat-form-field",4)(23,"mat-label"),e._uU(24,"Ingrese la Placa del Vehiculo"),e.qZA(),e._UZ(25,"input",9),e.YNc(26,Zt,4,0,"mat-error",6),e.YNc(27,yt,4,0,"mat-error",6),e.qZA()(),e.TgZ(28,"div",3)(29,"mat-form-field",4)(30,"mat-label"),e._uU(31,"Ingrese el Modelo del Vehiculo"),e.qZA(),e._UZ(32,"input",10),e.YNc(33,wt,4,0,"mat-error",6),e.qZA()(),e.TgZ(34,"div",3),e.YNc(35,Ut,2,1,"button",11),e._UZ(36,"br"),e.YNc(37,At,2,0,"button",12),e.qZA()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",o.fieldTeamForm),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(3),e.Q6J("ngIf",(null==o.equipo?null:o.equipo.touched)&&(null==o.equipo?null:o.equipo.hasError("required"))),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(3),e.Q6J("ngIf",(null==o.supervisor?null:o.supervisor.touched)&&(null==o.supervisor?null:o.supervisor.hasError("required"))),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(3),e.Q6J("ngIf",(null==o.vehiculo?null:o.vehiculo.touched)&&(null==o.vehiculo?null:o.vehiculo.hasError("required"))),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(3),e.Q6J("ngIf",(null==o.placa?null:o.placa.touched)&&(null==o.placa?null:o.placa.hasError("required"))),e.xp6(1),e.Q6J("ngIf",(null==o.placa?null:o.placa.touched)&&(null==o.placa?null:o.placa.hasError("pattern"))),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(3),e.Q6J("ngIf",(null==o.modelo?null:o.modelo.touched)&&(null==o.modelo?null:o.modelo.hasError("required"))),e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(19,ie)),e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(20,ie)))},dependencies:[A.O5,_.KE,_.hX,_.TO,Z.Nt,w.lW,g._Y,g.Fj,g.JJ,g.JL,g.Q7,g.sg,g.u,U.gE]});const Jt=function(){return[5,10,25,100]};class Y{constructor(t,o,r,n,a,c){this.formBuilder=t,this.dialogService=o,this.fieldService=r,this.groupService=n,this.projectHomeService=a,this.excelService=c,this.data=[[1,2],[3,4]],this.displayedColumns=["supervisor","vehiculo","placa","options"],this.roles=[],this.idProject=0,this.fieldTeamData={id:0,equipo:"",supervisor:"",vehiculo:"",placa:"",modelo:""},this.Toast=l().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:b=>{b.addEventListener("mouseenter",l().stopTimer),b.addEventListener("mouseleave",l().resumeTimer)}}),this.dataSource=new s.by,this.buildForm()}ngOnInit(){let t=localStorage.getItem("id");Number(t)&&this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o,this.getGroupsMinor()}),this.projectHomeService.getIdProject(localStorage.getItem("project")||"").subscribe(o=>{this.idProject=o}),this.cargarEquipo()}buildForm(){this.formFieldTeams=this.formBuilder.group({file:[""]})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getGroupsMinor(){var t=this;return(0,T.Z)(function*(){t.groupService.getGroupsMinor({proyecto_id:t.idProject}).subscribe(o=>{t.roles=o})})()}open(){this.dialogService.open(k,{height:"50rem",width:"50rem"}).afterClosed().subscribe(o=>{1==o&&this.cargarEquipo()})}cargarEquipo(){let t=localStorage.getItem("project");this.fieldService.getFieldTeam({proyecto:t}).subscribe(o=>{this.dataSource=new s.by(o),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})}editar(t,o,r,n,a,c){this.fieldTeamData.id=t,this.fieldTeamData.equipo=o,this.fieldTeamData.supervisor=r,this.fieldTeamData.vehiculo=n,this.fieldTeamData.placa=a,this.fieldTeamData.modelo=c,this.dialogService.open(q,{height:"50rem",width:"50rem",data:this.fieldTeamData}).afterClosed().subscribe(P=>{1==P&&this.cargarEquipo()})}desactivar(t,o){l().fire({title:"\xbfEsta seguro que desea Desactivar el Equipo: "+o+"?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No"}).then(r=>{r.isConfirmed?this.fieldService.desactiveFielTeam(Number(t)).subscribe(n=>{1==n.status&&(this.cargarEquipo(),l().fire("Ok!",n.message,"success"))},n=>{console.log(n)}):r.isDenied&&l().fire("Cambios no guardados","","info")})}seeTeam(t){this.fieldService.getUsersTeam({proyecto_id:this.idProject,supervisor:Number(t)}).subscribe(o=>{this.dialogService.open(q,{height:"50rem",width:"50rem",data:o})})}seeExample(){l().fire({text:"Ejemplo de plantilla",imageUrl:"assets/EjemploPlantillaPersonal.png",imageWidth:375,imageHeight:250,imageAlt:"Ejemplo del archivo de carga"})}addFile(){var t=this;return(0,T.Z)(function*(){const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const r=new FileReader;r.onload=n=>{const c=C.ij(n.target.result,{type:"binary"});t.data=C.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),t.generateJson()},r.readAsBinaryString(o)}})()}generateJson(){var t=this;return(0,T.Z)(function*(){let o=[],r=[],n=[];t.data.forEach(a=>{a[0]&&a[1]&&(o.push({codigo_superior:a[0],codigo_inferior:a[1],proyecto_id:t.idProject}),n.push(a[0]))}),o.shift(),o=o.filter(Boolean);for(let a=0;a<o.length;a++)for(let c=a+1;c<o.length;c++)null!=o[a]&&o[a].codigo_superior==o[c].codigo_superior&&o[a].codigo_inferior==o[c].codigo_inferior&&r.push(o[a].codigo_superior,o[a].codigo_inferior);for(let a=0;a<o.length;a++)for(let c=a+1;c<o.length;c++)o[a].codigo_inferior==o[c].codigo_inferior&&r.push(o[a].codigo_inferior);n.shift(),n=n.filter((a,c)=>n.indexOf(a)===c),r.length>0?t.Toast.fire({icon:"error",title:"Hay filas repetidas: "+r}):t.projectHomeService.assignPersonal(o).subscribe(a=>{1==a.status&&(t.Toast.fire({icon:"success",title:a.message}),t.createTeams(n))})})()}createTeams(t){this.fieldService.createFieldTeam({proyecto_id:this.idProject,supervisores:t}).subscribe(r=>{1==r.status&&this.cargarEquipo()})}getUsers(t){let o=Number(localStorage.getItem("id")),r=t.split(","),n=[],a=[];this.projectHomeService.getUsersAssigned({rol_id:Number(r[0]),proyecto_id:this.idProject,usuario_id:o}).subscribe(c=>{a=c,a.forEach(b=>{n.push({encargado:"",codigo_usuario:b.codigo_usuario,nombres:b.nombres,apellidos:b.apellidos})}),this.excelService.exportAsExcelFile(n,r[1])})}}Y.\u0275fac=function(t){return new(t||Y)(e.Y36(g.qu),e.Y36(S.uw),e.Y36(j),e.Y36(m.GroupService),e.Y36(f),e.Y36(y))},Y.\u0275cmp=e.Xpm({type:Y,selectors:[["app-field-team-page"]],viewQuery:function(t,o){if(1&t&&(e.Gf(v.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},decls:64,vars:13,consts:[[1,"title"],[1,"container"],[1,"container_download"],["appearance","outline",2,"width","25rem"],["rol",""],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","","color","accent",3,"disabled","click"],[1,"container_options"],["mat-flat-button","","color","accent",3,"click"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"],[1,"grid-container"],[1,"frow-container"],[1,"frow","row-start"],[1,"col-sm-1-1","col-sm-3-12","col-md-3-12"],["appearence","outline",1,"fluid"],["matInput","","placeholder","Ejemplo: AEE123456789A2",3,"keyup"],["input",""],["matSuffix",""],[1,"mat-elevatioin-z8"],["mat-table","","matSort","",1,"fluid",3,"dataSource"],["matColumnDef","supervisor"],["mat-header-cell","",4,"matHeaderCellDef"],["class","cell-pointer","mat-cell","",4,"matCellDef"],["matColumnDef","vehiculo"],["matColumnDef","placa"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["class","selected-row","mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"value"],["mat-header-cell",""],["mat-cell","",1,"cell-pointer"],["mat-icon-button","","matTooltip","Ver miebros de equipo","color","primary",1,"iconbutton",3,"click"],["mat-header-row",""],["mat-row","",1,"selected-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Equipos de campo"),e.qZA()(),e._UZ(3,"br")(4,"br"),e.TgZ(5,"div",1)(6,"div",2)(7,"mat-form-field",3)(8,"mat-label"),e._uU(9,"Seleccione un Rol"),e.qZA(),e.TgZ(10,"mat-select",null,4),e.YNc(12,Pt,2,2,"mat-option",5),e.qZA()(),e.TgZ(13,"div")(14,"button",6),e.NdJ("click",function(){e.CHM(r);const a=e.MAs(11);return e.KtG(o.getUsers(a.value))}),e.TgZ(15,"mat-icon"),e._uU(16,"arrow_downward"),e.qZA(),e._uU(17," Descargar Plantilla "),e.qZA()()(),e.TgZ(18,"div",7)(19,"div")(20,"button",8),e.NdJ("click",function(){return o.addFile()}),e.TgZ(21,"mat-icon"),e._uU(22,"arrow_upward"),e.qZA(),e._uU(23," Cargar Archivo "),e.qZA()(),e.TgZ(24,"div")(25,"button",9),e.NdJ("click",function(){return o.open()}),e.TgZ(26,"mat-icon"),e._uU(27,"add"),e.qZA(),e._uU(28," Crear Equipo de Campo "),e.qZA()(),e.TgZ(29,"div")(30,"button",9),e.NdJ("click",function(){return o.seeExample()}),e.TgZ(31,"mat-icon"),e._uU(32,"remove_red_eye"),e.qZA(),e._uU(33," Ver ejemplo de archivo de carga "),e.qZA()()()(),e.TgZ(34,"div",10)(35,"div",11)(36,"div",12)(37,"div",13)(38,"mat-form-field",14)(39,"mat-label"),e._uU(40,"Buscar"),e.qZA(),e.TgZ(41,"input",15,16),e.NdJ("keyup",function(a){return o.applyFilter(a)}),e.qZA(),e.TgZ(43,"mat-icon",17),e._uU(44,"search"),e.qZA()()()(),e.TgZ(45,"div",18)(46,"table",19),e.ynx(47,20),e.YNc(48,St,2,0,"th",21),e.YNc(49,jt,2,2,"td",22),e.BQk(),e.ynx(50,23),e.YNc(51,Nt,2,0,"th",21),e.YNc(52,qt,2,1,"td",22),e.BQk(),e.ynx(53,24),e.YNc(54,Dt,2,0,"th",21),e.YNc(55,Ft,2,1,"td",22),e.BQk(),e.ynx(56,25),e.YNc(57,Et,1,0,"th",21),e.YNc(58,kt,4,0,"td",22),e.BQk(),e.YNc(59,Yt,1,0,"tr",26),e.YNc(60,Ot,1,0,"tr",27),e.YNc(61,Mt,3,1,"tr",28),e.qZA(),e._UZ(62,"br")(63,"mat-paginator",29),e.qZA()()()}if(2&t){const r=e.MAs(11);e.xp6(8),e.Udp("font-size",16,"px"),e.xp6(4),e.Q6J("ngForOf",o.roles),e.xp6(2),e.Q6J("disabled",!r.value),e.xp6(24),e.Udp("font-size",12,"px"),e.xp6(1),e.Udp("font-size",14,"px"),e.xp6(7),e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(3),e.Q6J("pageSizeOptions",e.DdM(12,Jt))}},dependencies:[A.sg,_.KE,_.hX,_.R9,Z.Nt,w.lW,w.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,N.Hw,v.NW,V.gD,ee.ey,J.gM,h.YE],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-direction:column}.container_download[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:center}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.container_options[_ngcontent-%COMP%]{margin-top:2rem;display:flex;justify-content:space-around}"]});var Gt=u(1572),re=u(3848),K=u(1206),Qt=u(7559),Rt=u(6525),Bt=u(3995);function Ht(i,t){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Nombre de rol es "),e.TgZ(2,"strong"),e._uU(3,"requerido"),e.qZA()())}function It(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.createGroup())}),e._uU(1," Guardar Rol "),e.qZA()}if(2&i){const o=e.oxw();e.Q6J("disabled",!o.groupForm.valid)}}const zt=function(){return["crear-grupo"]};class H{constructor(t,o,r,n,a){this.groupService=t,this.data=o,this.projectService=r,this.formBuilder=n,this.dialogRef=a,this.buildForm()}buildForm(){this.groupForm=this.formBuilder.group({nombre:["",g.kI.required],descripcion:[""],proyecto_id:[this.data,[g.kI.required]]})}get Nombre(){return this.groupForm.get("nombre")}get Descripcion(){return this.groupForm.get("descripcion")}get ProyectoId(){return this.groupForm.get("proyecto_id")}get Jerarquia(){return this.groupForm.get("jerarquia")}submit(){}createGroup(){this.groupForm.valid&&this.groupService.create(this.groupForm.value).subscribe(t=>{1==t.status&&(l().fire("Ok!",t.message,"success"),this.dialogRef.close(1))})}cancelAdd(){this.dialogRef.close()}}H.\u0275fac=function(t){return new(t||H)(e.Y36(m.GroupService),e.Y36(S.WI),e.Y36(d.Y),e.Y36(g.qu),e.Y36(S.so))},H.\u0275cmp=e.Xpm({type:H,selectors:[["app-new-group-project"]],decls:19,vars:8,consts:[[1,"card"],[1,"card-body"],[3,"formGroup","submit"],[1,"form-group"],["appearance","outline",1,"full-width-input"],["type","text","formControlName","nombre","matInput","","placeholder","Supervisores ENEI","required","",1,"form-control"],[4,"ngIf"],["type","text","formControlName","descripcion","placeholder","Grupo 2026","matInput","",1,"form-control"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click",4,"ngxPermissionsOnly"],["type","submit","mat-stroked-button","","color","warn",3,"click"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("submit",function(){return o.submit()}),e.TgZ(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),e._uU(6,"Ingrese el Nombre del Rol"),e.qZA(),e._UZ(7,"input",5),e.YNc(8,Ht,4,0,"mat-error",6),e.qZA()(),e.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),e._uU(12,"Descripcion(Opcional)"),e.qZA(),e._UZ(13,"input",7),e.qZA()(),e.TgZ(14,"div",3),e.YNc(15,It,2,1,"button",8),e._UZ(16,"br"),e.TgZ(17,"button",9),e.NdJ("click",function(){return o.cancelAdd()}),e._uU(18," Cancelar "),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",o.groupForm),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(3),e.Q6J("ngIf",(null==o.Nombre?null:o.Nombre.touched)&&(null==o.Nombre?null:o.Nombre.hasError("required"))),e.xp6(3),e.Udp("font-size",16,"px"),e.xp6(4),e.Q6J("ngxPermissionsOnly",e.DdM(7,zt)))},dependencies:[A.O5,_.KE,_.hX,_.TO,Z.Nt,w.lW,g._Y,g.Fj,g.JJ,g.JL,g.Q7,g.sg,g.u,U.gE],styles:[".full-width-input[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%;max-width:98%;margin:0 auto;display:flex}.example-section[_ngcontent-%COMP%]{max-width:98%;margin:0 auto;display:flex}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.card[_ngcontent-%COMP%]{padding:3rem}"]});const $t=["table"];function Lt(i,t){1&i&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"ID"),e.qZA())}function Kt(i,t){if(1&i&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.id)}}function Xt(i,t){1&i&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Nombre"),e.qZA())}function Wt(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"mat-cell")(1,"mat-icon",16),e.NdJ("mousedown",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.dragDisabled=!1)}),e._uU(2,"reorder"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA()()}if(2&i){const o=t.$implicit;e.xp6(4),e.Oqu(o.nombre)}}function Vt(i,t){1&i&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Orden"),e.qZA())}function eo(i,t){if(1&i&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.jerarquia)}}function to(i,t){1&i&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Descripcion"),e.qZA())}function oo(i,t){if(1&i&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.descripcion)}}function io(i,t){1&i&&(e.TgZ(0,"mat-header-cell"),e._uU(1,"Acciones"),e.qZA())}function ro(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.editar(n.id,n.nombre,n.descripcion,n.proyecto_id))}),e.TgZ(1,"mat-icon",24),e._uU(2,"edit"),e.qZA()()}}function no(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.desactivar(n.id,n.nombre))}),e.TgZ(1,"mat-icon",26),e._uU(2,"delete"),e.qZA()()}}function ao(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.verUsuarios(n.id,n.nombre))}),e.TgZ(1,"mat-icon"),e._uU(2,"supervised_user_circle"),e.qZA()()}}function so(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addUser(n.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA()()}}function co(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.addFile(n.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"arrow_upward"),e.qZA()()}}function lo(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.verRoles(n.id,n.nombre))}),e.TgZ(1,"mat-icon"),e._uU(2,"list_alt"),e.qZA()()}}const uo=function(){return["editar-grupo"]},mo=function(){return["desactivar-grupo"]},po=function(){return["ver-usuario-grupo"]},ne=function(){return["asignar-usuario-grupo"]},_o=function(){return["asignar-rol-grupo"]};function go(i,t){1&i&&(e.TgZ(0,"mat-cell"),e.YNc(1,ro,3,0,"button",17),e.YNc(2,no,3,0,"button",18),e.YNc(3,ao,3,0,"button",19),e.YNc(4,so,3,0,"button",20),e.YNc(5,co,3,0,"button",21),e.YNc(6,lo,3,0,"button",22),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(6,uo)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(7,mo)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(8,po)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(9,ne)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(10,ne)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(11,_o)))}function fo(i,t){1&i&&e._UZ(0,"mat-header-row")}function ho(i,t){1&i&&e._UZ(0,"mat-row",31),2&i&&e.Q6J("cdkDragData",t.$implicit)}function To(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.createGroup())}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," Crear Rol "),e.qZA()}}const bo=function(){return["crear-grupo"]};class I{constructor(t,o,r){this.projectHomeService=t,this.groupService=o,this.dialogService=r,this.data=[],this.displayedColumns=["nombre","jerarquia","descripcion","options"],this.dragDisabled=!0,this.project="",this.group={id:0,jerarquia:0,nombre:"",descripcion:"",proyecto_id:0,proyecto:""},this.userData={nombres:"",rol_id:0,apellidos:"",codigo_usuario:0,proyecto:""},this.roleData={id:0,nombre:"",roles:[]},this.userDataFile={rol_id:0,usuarios:[],proyecto:""}}ngOnInit(){this.project=localStorage.getItem("project")||"",this.cargarGrupos()}drop(t){this.dragDisabled=!0,this.dataSource.find(a=>a==t.item.data);const n=this.dataSource.findIndex(a=>a==t.item.data);(0,K.bA)(this.dataSource,n,t.currentIndex),this.table.renderRows(),this.ordenarJerarquias()}ordenarJerarquias(){for(let t=0;t<this.dataSource.length;t++)for(let o=0;o<this.dataSource.length;o++)(this.dataSource[t].jerarquia>this.dataSource[o].jerarquia||this.dataSource[t].jerarquia==this.dataSource[o].jerarquia)&&(this.dataSource[t].jerarquia=this.dataSource.length-t)}desactivar(t,o){l().fire({title:"Esta accion eliminara todos los usuarios que se encuentren asignados a este rol y todas las asignaciones de upms y personal a dichos usuarios. \xbfEsta seguro que desea Desactivar el rol: "+o+"?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No"}).then(r=>{r.isConfirmed?this.groupService.desactiveGroup(Number(t)).subscribe(n=>{1==n.status&&(this.cargarGrupos(),l().fire("Ok!","Rol desactivado","success"))}):r.isDenied&&l().fire("Cambios no guardados","","info")})}editar(t,o,r,n){this.group.id=Number(t),this.group.nombre=o,this.group.descripcion=r,this.group.proyecto_id=Number(n),this.dialogService.open(Qt.e,{height:"20rem",width:"50rem",data:this.group}).afterClosed().subscribe(c=>{1===c&&this.cargarGrupos()})}addUser(t){var o=this;return(0,T.Z)(function*(){const{value:r}=yield l().fire({title:"Usuario",input:"number",inputPlaceholder:"juan2022",confirmButtonText:"Agregar Usuario",showCancelButton:!0,cancelButtonText:"Cancelar",inputLabel:"Ingrese el codigo de usuario"});r&&(o.userData.rol_id=Number(t),o.userData.proyecto=o.project,o.userData.codigo_usuario=r,o.groupService.addUserToGroup(o.userData).subscribe(n=>{1==n.status&&l().fire("Ok!",n.message,"success")}))})()}addFile(t){var o=this;return(0,T.Z)(function*(){const{value:r}=yield l().fire({html:"<label>El archivo debe tener una lista con los codigo de usuario</label>",title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(r){o.userDataFile.rol_id=Number(t),o.userDataFile.proyecto=o.project;const n=new FileReader;n.onload=a=>{const b=C.ij(a.target.result,{type:"binary"});o.data=C.P6.sheet_to_json(b.Sheets[b.SheetNames[0]],{header:1}),o.generateJsonUsers()},n.readAsBinaryString(r)}})()}generateJsonUsers(){var t=this;return(0,T.Z)(function*(){t.userDataFile.usuarios=[],t.data.forEach(o=>{t.userDataFile.usuarios.push(o[0])}),t.userDataFile.usuarios=t.userDataFile.usuarios.filter(Boolean),t.groupService.assignGroupUsersFile(t.userDataFile).subscribe(o=>{1==o.status&&l().fire("Ok",o.message,"success")})})()}guardarJerarquias(){l().fire({title:"Guardar orden de los roles",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Si",denyButtonText:"No"}).then(t=>{t.isConfirmed?this.projectHomeService.guardarJerarquias(this.dataSource).subscribe(o=>{1==o.status&&(this.cargarGrupos(),l().fire("Ok!","Organizacion Actualizada","success"))}):t.isDenied&&l().fire("Cambios no guardados","","info")})}cargarGrupos(){this.projectHomeService.getGroupsProject(this.project).subscribe(t=>{this.dataSource=t})}verUsuarios(t,o){this.userData.rol_id=Number(t),this.dialogService.open(Bt.Z,{height:"40rem",width:"50rem",data:this.userData})}verRoles(t,o){this.roleData.id=Number(t),this.roleData.nombre=o,this.groupService.getGroupsRoles(this.roleData.id).subscribe(r=>{this.roleData.roles=r,this.dialogService.open(Rt.a,{height:"30rem",width:"50rem",data:this.roleData})})}createGroup(){this.projectHomeService.getIdProject(this.project).subscribe(t=>{this.dialogService.open(H,{height:"22rem",width:"50rem",data:Number(t)}).afterClosed().subscribe(n=>{1===n&&this.cargarGrupos()})})}}function vo(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.addUpm())}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," A\xf1adir UPM "),e.qZA()}}function Co(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.addFile())}),e.TgZ(1,"mat-icon"),e._uU(2,"arrow_upward"),e.qZA(),e._uU(3," Cargar Archivo de UPM "),e.qZA()}}function xo(i,t){1&i&&(e.TgZ(0,"th",20),e._uU(1,"Departamento"),e.qZA())}function Zo(i,t){if(1&i&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.departamento)}}function yo(i,t){1&i&&(e.TgZ(0,"th",20),e._uU(1,"Municipio"),e.qZA())}function wo(i,t){if(1&i&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.municipio)}}function Uo(i,t){1&i&&(e.TgZ(0,"th",20),e._uU(1,"UPM"),e.qZA())}function Ao(i,t){if(1&i&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Oqu(o.upm)}}function Po(i,t){1&i&&(e.TgZ(0,"th",20),e._uU(1,"Estado"),e.qZA())}function So(i,t){if(1&i&&(e.TgZ(0,"button",24),e._uU(1),e.qZA()),2&i){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.estado," ")}}function jo(i,t){if(1&i&&(e.TgZ(0,"button",25),e._uU(1),e.qZA()),2&i){const o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o.estado," ")}}function No(i,t){if(1&i&&(e.TgZ(0,"td",21),e.YNc(1,So,2,1,"button",22),e.YNc(2,jo,2,1,"button",23),e.qZA()),2&i){const o=t.$implicit;e.xp6(1),e.Q6J("ngIf","Cargado"==o.estado),e.xp6(1),e.Q6J("ngIf","Sustituido"==o.estado)}}function qo(i,t){1&i&&(e.TgZ(0,"th",20),e._uU(1,"Acciones"),e.qZA())}function Do(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(o);const n=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.sustituirUpm(n.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"loop"),e.qZA()()}}function Fo(i,t){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Do,3,0,"button",28),e.qZA()),2&i){const o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","Cargado"==o.estado)}}function Eo(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.verDetalles(n.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"receipt"),e.qZA()()}}I.\u0275fac=function(t){return new(t||I)(e.Y36(f),e.Y36(m.GroupService),e.Y36(S.uw))},I.\u0275cmp=e.Xpm({type:I,selectors:[["app-group-project"]],viewQuery:function(t,o){if(1&t&&e.Gf($t,7),2&t){let r;e.iGM(r=e.CRH())&&(o.table=r.first)}},decls:31,vars:6,consts:[[1,"mat-elevation-z8","table_div"],[1,"orden_label"],["mat-table","","cdkDropList","","cdkDropListData","datasource",1,"table",3,"dataSource","cdkDropListDisabled","cdkDropListDropped"],["table",""],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","jerarquia","sticky",""],["matColumnDef","descripcion"],["matColumnDef","options"],[4,"matHeaderRowDef"],["cdkDrag","",3,"cdkDragData",4,"matRowDef","matRowDefColumns"],[1,"header"],["mat-flat-button","","color","accent","style","margin-right: 8px",3,"click",4,"ngxPermissionsOnly"],["mat-flat-button","","color","accent",3,"click"],[1,"dragCursor",3,"mousedown"],["mat-icon-button","","matTooltip","Editar","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Desactivar","color","warn","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver usuarios","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Agregar usuario","color","primary",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Cargar archivo de usuarios","color","primary",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver politicas","color","primary","class","iconbutton",3,"click",4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Editar","color","primary",1,"iconbutton",3,"click"],["aria-label","Edit"],["mat-icon-button","","matTooltip","Desactivar","color","warn",1,"iconbutton",3,"click"],["aria-label","Delete"],["mat-icon-button","","matTooltip","Ver usuarios","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Agregar usuario","color","primary",3,"click"],["mat-icon-button","","matTooltip","Cargar archivo de usuarios","color","primary",3,"click"],["mat-icon-button","","matTooltip","Ver politicas","color","primary",1,"iconbutton",3,"click"],["cdkDrag","",3,"cdkDragData"],["mat-flat-button","","color","accent",2,"margin-right","8px",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"br")(2,"br"),e.TgZ(3,"mat-label",1)(4,"strong"),e._uU(5,"Ordene los grupos de mayor a menor"),e.qZA()(),e.TgZ(6,"table",2,3),e.NdJ("cdkDropListDropped",function(n){return o.drop(n)}),e.ynx(8,4),e.YNc(9,Lt,2,0,"mat-header-cell",5),e.YNc(10,Kt,2,1,"mat-cell",6),e.BQk(),e.ynx(11,7),e.YNc(12,Xt,2,0,"mat-header-cell",5),e.YNc(13,Wt,5,1,"mat-cell",6),e.BQk(),e.ynx(14,8),e.YNc(15,Vt,2,0,"mat-header-cell",5),e.YNc(16,eo,2,1,"mat-cell",6),e.BQk(),e.ynx(17,9),e.YNc(18,to,2,0,"mat-header-cell",5),e.YNc(19,oo,2,1,"mat-cell",6),e.BQk(),e.ynx(20,10),e.YNc(21,io,2,0,"mat-header-cell",5),e.YNc(22,go,7,12,"mat-cell",6),e.BQk(),e.YNc(23,fo,1,0,"mat-header-row",11),e.YNc(24,ho,1,1,"mat-row",12),e.qZA()(),e.TgZ(25,"div",13),e.YNc(26,To,4,0,"button",14),e.TgZ(27,"button",15),e.NdJ("click",function(){return o.guardarJerarquias()}),e.TgZ(28,"mat-icon"),e._uU(29,"save"),e.qZA(),e._uU(30," Guardar Orden de Roles "),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("dataSource",o.dataSource)("cdkDropListDisabled",o.dragDisabled),e.xp6(17),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(5,bo)))},dependencies:[_.hX,w.lW,w.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,N.Hw,J.gM,U.gE,K.Wj,K.Zt],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;margin:1.5rem;padding:0 .4rem;font-family:Roboto,Helvetica Neue,sans-serif}.orden_label[_ngcontent-%COMP%]{text-align:center;padding-left:2rem;color:red}.dragCursor[_ngcontent-%COMP%]{cursor:move}"]});const ko=function(){return["reemplazar-upm"]};function Yo(i,t){if(1&i&&(e.TgZ(0,"td",21),e.YNc(1,Fo,2,1,"div",26),e.TgZ(2,"div"),e.YNc(3,Eo,3,0,"button",27),e.qZA()()),2&i){const o=t.$implicit;e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(2,ko)),e.xp6(2),e.Q6J("ngIf","Sustituido"==o.estado)}}function Oo(i,t){1&i&&e._UZ(0,"tr",31)}function Mo(i,t){1&i&&e._UZ(0,"tr",32)}function Jo(i,t){if(1&i&&(e.TgZ(0,"tr",33)(1,"td",34),e._uU(2),e.qZA()()),2&i){e.oxw();const o=e.MAs(13);e.xp6(2),e.hij(' No hay resultados de "',o.value,'" ')}}const ae=function(){return["asignar-upm-proyecto"]},Go=function(){return[10,25,100]};class z{constructor(t,o,r,n){this.formBuilder=t,this.dialog=o,this.homeProjectService=r,this.projectService=n,this.displayedColumns=["departamento","municipio","upm","estado","options"],this.data=[],this.assignment={proyecto_id:0,upms:[]},this.upmDataSust={proyecto_id:0,upm_nuevo:"",upm_anterior:0,descripcion:"",usuario_id:0},this.dataSource=new s.by,this.buildForm()}buildForm(){this.formUpms=this.formBuilder.group({file:[""]})}ngOnInit(){this.homeProjectService.getIdProject(localStorage.getItem("project")||"").subscribe(t=>{this.idProject=t,this.cargarUpmsAsignadas()})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}cargarUpmsAsignadas(){0!=this.idProject&&this.projectService.getUpms(this.idProject).subscribe(t=>{this.dataSource=new s.by(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}addUpm(){var t=this;return(0,T.Z)(function*(){const{value:o}=yield l().fire({title:"UPM",input:"text",inputPlaceholder:"AEE001122337A2",confirmButtonText:"Agregar UPM",showCancelButton:!0,inputLabel:"Ingrese la UPM"});o&&(t.assignment.proyecto_id=t.idProject,t.assignment.upms=[o],t.projectService.assignUpmToProject(t.assignment).subscribe(r=>{1==r.status&&(t.cargarUpmsAsignadas(),l().fire("Ok!",r.message,"success"))}))})()}sustituirUpm(t){var o=this;return(0,T.Z)(function*(){o.upmDataSust.proyecto_id=o.idProject,o.upmDataSust.upm_anterior=Number(t);const{value:r}=yield l().fire({title:"Sustituir upms",html:'<span>Ingrese el upm</span><input type="text" style="width:80%;"  placeholder="AEE123456789A1" id="upm" class="swal2-input"><br><span>Ingrese el motivo de sustitucion</span><textarea id="descripcion" style="width:80%;" placeholder="No se puede acceder al lugar" class="swal2-input"></textarea>',showCancelButton:!0,cancelButtonText:"Cancelar",preConfirm:()=>[document.getElementById("upm"),document.getElementById("descripcion")]});if(r){let a=r[1].value;o.upmDataSust.upm_nuevo=r[0].value,o.upmDataSust.descripcion=a,o.upmDataSust.usuario_id=Number(localStorage.getItem("id")),o.projectService.sustituirUpm(o.upmDataSust).subscribe(c=>{1==c.status&&(o.cargarUpmsAsignadas(),l().fire("Ok!",c.message,"success"))})}})()}addFile(){var t=this;return(0,T.Z)(function*(){const{value:o}=yield l().fire({title:"Seleccione archivo",input:"file",inputAttributes:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}});if(o){const r=new FileReader;r.onload=n=>{const c=C.ij(n.target.result,{type:"binary"});t.data=C.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{header:1}),t.generateJson()},r.readAsBinaryString(o)}})()}generateJson(){this.idProject&&(this.assignment.proyecto_id=this.idProject,this.data.forEach(t=>{this.assignment.upms.push(t.toString())})),this.assignment.upms=this.assignment.upms.filter(Boolean),console.log(this.assignment),this.projectService.assignUpmToProject(this.assignment).subscribe(t=>{1==t.status&&(this.cargarUpmsAsignadas(),l().fire("Ok!",t.message,"success"))})}verDetalles(t){Number(t)&&this.homeProjectService.verDetalleSustitucion(Number(t)).subscribe(o=>{l().fire({title:"Descripcion",html:`UPM nuevo: <b>${o.nombre}</b>, <br><span>Usuario modificador: ${o.codigo_usuario}</span> <br><span>Fecha: ${o.fecha}</span> <br><p>Motivo: ${o.descripcion}</p>`})})}}function Qo(i,t){1&i&&(e.TgZ(0,"mat-tab",9),e._UZ(1,"app-group-project"),e.qZA())}function Ro(i,t){1&i&&(e.TgZ(0,"mat-tab",10),e._UZ(1,"app-upms"),e.qZA())}z.\u0275fac=function(t){return new(t||z)(e.Y36(g.qu),e.Y36(S.uw),e.Y36(f),e.Y36(d.Y))},z.\u0275cmp=e.Xpm({type:z,selectors:[["app-upms"]],viewQuery:function(t,o){if(1&t&&(e.Gf(v.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first),e.iGM(r=e.CRH())&&(o.sort=r.first)}},decls:36,vars:9,consts:[[1,"container"],[1,"header"],["mat-flat-button","","color","accent",3,"click",4,"ngxPermissionsOnly"],["matInput","","placeholder","Ejemplo: AEE010100005A1",3,"keyup"],["input",""],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","departamento"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","municipio"],["matColumnDef","upm"],["matColumnDef","estado"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],["paginator",""],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-stroked-button","","color","primary","class","estado",4,"ngIf"],["mat-stroked-button","","color","warn","class","estado",4,"ngIf"],["mat-stroked-button","","color","primary",1,"estado"],["mat-stroked-button","","color","warn",1,"estado"],[4,"ngxPermissionsOnly"],["mat-icon-button","","matTooltip","Ver detalles","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Reemplazar","color","primary","class","iconbutton",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Reemplazar","color","primary",1,"iconbutton",3,"click"],["mat-icon-button","","matTooltip","Ver detalles","color","primary",1,"iconbutton",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,o){1&t&&(e._UZ(0,"br")(1,"br"),e.TgZ(2,"div")(3,"div",0)(4,"div",1),e.YNc(5,vo,4,0,"button",2),e.YNc(6,Co,4,0,"button",2),e.qZA()()(),e._UZ(7,"br")(8,"br"),e.TgZ(9,"mat-form-field")(10,"mat-label"),e._uU(11,"Buscar"),e.qZA(),e.TgZ(12,"input",3,4),e.NdJ("keyup",function(n){return o.applyFilter(n)}),e.qZA()(),e.TgZ(14,"div",5)(15,"table",6),e.ynx(16,7),e.YNc(17,xo,2,0,"th",8),e.YNc(18,Zo,2,1,"td",9),e.BQk(),e.ynx(19,10),e.YNc(20,yo,2,0,"th",8),e.YNc(21,wo,2,1,"td",9),e.BQk(),e.ynx(22,11),e.YNc(23,Uo,2,0,"th",8),e.YNc(24,Ao,2,1,"td",9),e.BQk(),e.ynx(25,12),e.YNc(26,Po,2,0,"th",8),e.YNc(27,No,3,2,"td",9),e.BQk(),e.ynx(28,13),e.YNc(29,qo,2,0,"th",8),e.YNc(30,Yo,4,3,"td",9),e.BQk(),e.YNc(31,Oo,1,0,"tr",14),e.YNc(32,Mo,1,0,"tr",15),e.YNc(33,Jo,3,1,"tr",16),e.qZA(),e._UZ(34,"mat-paginator",17,18),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngxPermissionsOnly",e.DdM(6,ae)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(7,ae)),e.xp6(9),e.Q6J("dataSource",o.dataSource),e.xp6(16),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(2),e.Q6J("pageSizeOptions",e.DdM(8,Go)))},dependencies:[A.O5,_.KE,_.hX,Z.Nt,w.lW,w.RK,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,s.Ee,N.Hw,v.NW,J.gM,h.YE,U.gE],styles:[".table[_ngcontent-%COMP%]{width:100%;margin:0 0 3rem}.table_div[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;max-width:98%;margin:0 auto;display:flex}.full-width-input[_ngcontent-%COMP%]{width:100% auto;padding:1em}.example-section[_ngcontent-%COMP%]{margin:12px}.example-margin[_ngcontent-%COMP%]{margin:0 12px}ul[_ngcontent-%COMP%]{list-style-type:none;margin-top:4px}.header[_ngcontent-%COMP%]{display:flex;margin:.5rem;padding:0 .4rem;gap:1rem}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]});const Bo=function(){return["crear-grupo"]},Ho=function(){return["ver-upms"]};class O{constructor(t,o){this.router=t,this.projectHomeService=o,this.projectId=0,this.roles=[]}ngOnInit(){this.project=localStorage.getItem("project")||"",this.project||this.router.navigateByUrl("home")}}O.\u0275fac=function(t){return new(t||O)(e.Y36(F.F0),e.Y36(f))},O.\u0275cmp=e.Xpm({type:O,selectors:[["app-home-project-page"]],decls:21,vars:5,consts:[[1,"grid-container"],[1,"frow-container"],[1,"col-sm-1-1","col-sm-6-12","col-md-6-12"],[1,"header"],["color","primary","mode","determinate","value","45"],[1,"mat-elevation-z8"],["color","accent"],["label","Roles",4,"ngxPermissionsOnly"],["label","UPM",4,"ngxPermissionsOnly"],["label","Roles"],["label","UPM"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e._uU(5),e.qZA(),e.TgZ(6,"div")(7,"h3")(8,"mat-label"),e._uU(9,"Progreso Total"),e.qZA()(),e._UZ(10,"mat-progress-spinner",4),e.qZA()()(),e._UZ(11,"br")(12,"br")(13,"br"),e.TgZ(14,"div",5)(15,"mat-tab-group",6)(16,"mat-tab")(17,"h1"),e._uU(18,"Progreso"),e.qZA()(),e.YNc(19,Qo,2,0,"mat-tab",7),e.YNc(20,Ro,2,0,"mat-tab",8),e.qZA()()()()),2&t&&(e.xp6(5),e.Oqu(o.project),e.xp6(14),e.Q6J("ngxPermissionsOnly",e.DdM(3,Bo)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(4,Ho)))},dependencies:[_.hX,Gt.Ou,re.uX,re.SP,U.gE,I,z],styles:[".header[_ngcontent-%COMP%]{padding-top:2rem;display:flex;justify-content:space-around;align-items:center}.progress-upms[_ngcontent-%COMP%]{padding-top:3.5rem;display:flex;justify-content:space-around;flex-wrap:wrap}.upm-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:12rem;width:14rem}.grid-example-square[_ngcontent-%COMP%]{justify-content:end}"]});const Io=[{path:"",component:O},{path:"assignPersonal",component:G,canActivate:[U.DD],data:{permissions:{only:["asignar-personal"],redirectTo:"projectHome"}}},{path:"assignUpmChief",component:R,canActivate:[U.DD],data:{permissions:{only:["asignar-upms-personal"],redirectTo:"projectHome"}}},{path:"supervisor",component:B},{path:"cartografo",component:Q,canActivate:[U.DD],data:{permissions:{only:["ver-upms-cartografo"],redirectTo:"projectHome"}}},{path:"equipo-campo",component:Y}];class D{}D.\u0275fac=function(t){return new(t||D)},D.\u0275mod=e.oAB({type:D}),D.\u0275inj=e.cJS({imports:[F.Bz.forChild(Io),F.Bz]});var zo=u(4657);class M{}M.\u0275fac=function(t){return new(t||M)},M.\u0275mod=e.oAB({type:M}),M.\u0275inj=e.cJS({imports:[A.ez,D,zo.M,g.UX,U.VI,K._t]})},4327:function(X,$){var u,T;void 0!==(T="function"==typeof(u=function(){"use strict";function h(m,p,f){var d=new XMLHttpRequest;d.open("GET",m),d.responseType="blob",d.onload=function(){e(d.response,p,f)},d.onerror=function(){console.error("could not download file")},d.send()}function s(m){var p=new XMLHttpRequest;p.open("HEAD",m,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function E(m){try{m.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),m.dispatchEvent(p)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,C=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),e=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!C?function(m,p,f){var d=l.URL||l.webkitURL,x=document.createElement("a");x.download=p=p||m.name||"download",x.rel="noopener","string"==typeof m?(x.href=m,x.origin===location.origin?E(x):s(x.href)?h(m,p,f):E(x,x.target="_blank")):(x.href=d.createObjectURL(m),setTimeout(function(){d.revokeObjectURL(x.href)},4e4),setTimeout(function(){E(x)},0))}:"msSaveOrOpenBlob"in navigator?function(m,p,f){if(p=p||m.name||"download","string"!=typeof m)navigator.msSaveOrOpenBlob(function v(m,p){return typeof p>"u"?p={autoBom:!1}:"object"!=typeof p&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(m.type)?new Blob(["\ufeff",m],{type:m.type}):m}(m,f),p);else if(s(m))h(m,p,f);else{var d=document.createElement("a");d.href=m,d.target="_blank",setTimeout(function(){E(d)})}}:function(m,p,f,d){if((d=d||open("","_blank"))&&(d.document.title=d.document.body.innerText="downloading..."),"string"==typeof m)return h(m,p,f);var x="application/octet-stream"===m.type,W=/constructor/i.test(l.HTMLElement)||l.safari,L=/CriOS\/[\d]+/.test(navigator.userAgent);if((L||x&&W||C)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var Z=y.result;Z=L?Z:Z.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=Z:location=Z,d=null},y.readAsDataURL(m)}else{var A=l.URL||l.webkitURL,_=A.createObjectURL(m);d?d.location=_:location.href=_,d=null,setTimeout(function(){A.revokeObjectURL(_)},4e4)}});l.saveAs=e.saveAs=e,X.exports=e})?u.apply($,[]):u)&&(X.exports=T)}}]);